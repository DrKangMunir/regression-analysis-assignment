<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Munir (23202537), Farihah (23202679), Sanggary (23202894), Khairunnisa (23202532)">
<meta name="dcterms.date" content="2026-01-03">

<title>Logistic Regression Analysis of Depression Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Depression_files/libs/clipboard/clipboard.min.js"></script>
<script src="Depression_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Depression_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Depression_files/libs/quarto-html/popper.min.js"></script>
<script src="Depression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Depression_files/libs/quarto-html/anchor.min.js"></script>
<link href="Depression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Depression_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Depression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Depression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Depression_files/libs/bootstrap/bootstrap-7f5740c09e508315c41a07c582dff588.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Depression_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Depression_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="Depression_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="Depression_files/libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="Depression_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="Depression_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="Depression_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="Depression_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="Depression_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="Depression_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#research-question-objective" id="toc-research-question-objective" class="nav-link" data-scroll-target="#research-question-objective"><span class="header-section-number">1.1</span> Research Question / Objective</a></li>
  </ul></li>
  <li><a href="#part-a-dataset-and-variable-creation" id="toc-part-a-dataset-and-variable-creation" class="nav-link" data-scroll-target="#part-a-dataset-and-variable-creation"><span class="header-section-number">2</span> Part A: Dataset and variable creation</a>
  <ul class="collapse">
  <li><a href="#data-preperation" id="toc-data-preperation" class="nav-link" data-scroll-target="#data-preperation"><span class="header-section-number">2.1</span> Data Preperation</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">2.2</span> Load libraries</a></li>
  <li><a href="#data-cleaning-and-coding" id="toc-data-cleaning-and-coding" class="nav-link" data-scroll-target="#data-cleaning-and-coding"><span class="header-section-number">2.3</span> Data cleaning and coding</a></li>
  <li><a href="#label-variables" id="toc-label-variables" class="nav-link" data-scroll-target="#label-variables"><span class="header-section-number">2.4</span> Label variables</a></li>
  </ul></li>
  <li><a href="#part-b-exploratory-data-analysis" id="toc-part-b-exploratory-data-analysis" class="nav-link" data-scroll-target="#part-b-exploratory-data-analysis"><span class="header-section-number">3</span> Part B: Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">3.1</span> Descriptive statistics</a></li>
  <li><a href="#histogram-for-numerical-variables" id="toc-histogram-for-numerical-variables" class="nav-link" data-scroll-target="#histogram-for-numerical-variables"><span class="header-section-number">3.2</span> Histogram for numerical variables</a></li>
  <li><a href="#boxplots-for-numerical-variables-by-obesity-status" id="toc-boxplots-for-numerical-variables-by-obesity-status" class="nav-link" data-scroll-target="#boxplots-for-numerical-variables-by-obesity-status"><span class="header-section-number">3.3</span> Boxplots for numerical variables by obesity status</a></li>
  <li><a href="#bar-plots-for-categorical-variables" id="toc-bar-plots-for-categorical-variables" class="nav-link" data-scroll-target="#bar-plots-for-categorical-variables"><span class="header-section-number">3.4</span> Bar plots for categorical variables</a></li>
  <li><a href="#bar-plots-for-depression-by-obesity-status" id="toc-bar-plots-for-depression-by-obesity-status" class="nav-link" data-scroll-target="#bar-plots-for-depression-by-obesity-status"><span class="header-section-number">3.5</span> Bar plots for depression by obesity status</a></li>
  </ul></li>
  <li><a href="#part-c-regression-analysis" id="toc-part-c-regression-analysis" class="nav-link" data-scroll-target="#part-c-regression-analysis"><span class="header-section-number">4</span> Part C: Regression Analysis</a>
  <ul class="collapse">
  <li><a href="#univariate-analysis" id="toc-univariate-analysis" class="nav-link" data-scroll-target="#univariate-analysis"><span class="header-section-number">4.1</span> Univariate analysis</a>
  <ul class="collapse">
  <li><a href="#years-of-working" id="toc-years-of-working" class="nav-link" data-scroll-target="#years-of-working"><span class="header-section-number">4.1.1</span> Years of working</a></li>
  <li><a href="#physical-activity" id="toc-physical-activity" class="nav-link" data-scroll-target="#physical-activity"><span class="header-section-number">4.1.2</span> Physical activity</a></li>
  <li><a href="#obesity" id="toc-obesity" class="nav-link" data-scroll-target="#obesity"><span class="header-section-number">4.1.3</span> Obesity</a></li>
  </ul></li>
  <li><a href="#multivariable-analysis" id="toc-multivariable-analysis" class="nav-link" data-scroll-target="#multivariable-analysis"><span class="header-section-number">4.2</span> Multivariable analysis</a>
  <ul class="collapse">
  <li><a href="#model-full-physical-activity-obesity-and-years-of-working" id="toc-model-full-physical-activity-obesity-and-years-of-working" class="nav-link" data-scroll-target="#model-full-physical-activity-obesity-and-years-of-working"><span class="header-section-number">4.2.1</span> Model Full: Physical activity, Obesity and Years of working,</a></li>
  <li><a href="#model-interaction-physical-activity-and-obesity-interaction" id="toc-model-interaction-physical-activity-and-obesity-interaction" class="nav-link" data-scroll-target="#model-interaction-physical-activity-and-obesity-interaction"><span class="header-section-number">4.2.2</span> Model Interaction: Physical activity and obesity interaction</a></li>
  </ul></li>
  <li><a href="#model-comparison-and-selection" id="toc-model-comparison-and-selection" class="nav-link" data-scroll-target="#model-comparison-and-selection"><span class="header-section-number">4.3</span> Model comparison and selection</a>
  <ul class="collapse">
  <li><a href="#anova-to-compare-nested-models" id="toc-anova-to-compare-nested-models" class="nav-link" data-scroll-target="#anova-to-compare-nested-models"><span class="header-section-number">4.3.1</span> ANOVA to compare nested models</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-d-model-checking" id="toc-part-d-model-checking" class="nav-link" data-scroll-target="#part-d-model-checking"><span class="header-section-number">5</span> Part D: Model Checking</a>
  <ul class="collapse">
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions"><span class="header-section-number">5.1</span> Check assumptions</a>
  <ul class="collapse">
  <li><a href="#linearity-of-the-logit-for-continuous-variables" id="toc-linearity-of-the-logit-for-continuous-variables" class="nav-link" data-scroll-target="#linearity-of-the-logit-for-continuous-variables"><span class="header-section-number">5.1.1</span> Linearity of the logit for continuous variables</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">5.1.2</span> Independence</a></li>
  <li><a href="#absence-of-multicollinearity" id="toc-absence-of-multicollinearity" class="nav-link" data-scroll-target="#absence-of-multicollinearity"><span class="header-section-number">5.1.3</span> Absence of multicollinearity</a></li>
  </ul></li>
  <li><a href="#assess-goodness-of-fit" id="toc-assess-goodness-of-fit" class="nav-link" data-scroll-target="#assess-goodness-of-fit"><span class="header-section-number">5.2</span> Assess Goodness-of-fit</a>
  <ul class="collapse">
  <li><a href="#hosmer-lemeshow-test" id="toc-hosmer-lemeshow-test" class="nav-link" data-scroll-target="#hosmer-lemeshow-test"><span class="header-section-number">5.2.1</span> Hosmer-Lemeshow test</a></li>
  <li><a href="#classification-table" id="toc-classification-table" class="nav-link" data-scroll-target="#classification-table"><span class="header-section-number">5.2.2</span> Classification table</a></li>
  <li><a href="#roc-curve" id="toc-roc-curve" class="nav-link" data-scroll-target="#roc-curve"><span class="header-section-number">5.2.3</span> ROC Curve</a></li>
  </ul></li>
  <li><a href="#check-for-confounding" id="toc-check-for-confounding" class="nav-link" data-scroll-target="#check-for-confounding"><span class="header-section-number">5.3</span> Check for confounding</a>
  <ul class="collapse">
  <li><a href="#assess-confounding-by-examining-percent-change-in-or" id="toc-assess-confounding-by-examining-percent-change-in-or" class="nav-link" data-scroll-target="#assess-confounding-by-examining-percent-change-in-or"><span class="header-section-number">5.3.1</span> Assess confounding by examining percent change in OR</a></li>
  <li><a href="#check-the-association-of-each-variable-with-the-outcome-depression" id="toc-check-the-association-of-each-variable-with-the-outcome-depression" class="nav-link" data-scroll-target="#check-the-association-of-each-variable-with-the-outcome-depression"><span class="header-section-number">5.3.2</span> Check the association of each variable with the outcome (depression)</a></li>
  </ul></li>
  <li><a href="#diagnostic-plot" id="toc-diagnostic-plot" class="nav-link" data-scroll-target="#diagnostic-plot"><span class="header-section-number">5.4</span> Diagnostic plot</a></li>
  <li><a href="#perform-influential-analysis" id="toc-perform-influential-analysis" class="nav-link" data-scroll-target="#perform-influential-analysis"><span class="header-section-number">5.5</span> Perform influential analysis</a>
  <ul class="collapse">
  <li><a href="#list-of-influential-observations" id="toc-list-of-influential-observations" class="nav-link" data-scroll-target="#list-of-influential-observations"><span class="header-section-number">5.5.1</span> List of influential observations</a></li>
  <li><a href="#cooks-distance" id="toc-cooks-distance" class="nav-link" data-scroll-target="#cooks-distance"><span class="header-section-number">5.5.2</span> Cook’s distance</a></li>
  <li><a href="#dfbetas" id="toc-dfbetas" class="nav-link" data-scroll-target="#dfbetas"><span class="header-section-number">5.5.3</span> DFBETAS</a></li>
  <li><a href="#leverage-points" id="toc-leverage-points" class="nav-link" data-scroll-target="#leverage-points"><span class="header-section-number">5.5.4</span> Leverage points</a></li>
  <li><a href="#standardized-residuals" id="toc-standardized-residuals" class="nav-link" data-scroll-target="#standardized-residuals"><span class="header-section-number">5.5.5</span> Standardized residuals</a></li>
  </ul></li>
  <li><a href="#identify-the-influential-observations" id="toc-identify-the-influential-observations" class="nav-link" data-scroll-target="#identify-the-influential-observations"><span class="header-section-number">5.6</span> Identify the influential observations</a></li>
  <li><a href="#remove-influential-observations-and-refit-the-model" id="toc-remove-influential-observations-and-refit-the-model" class="nav-link" data-scroll-target="#remove-influential-observations-and-refit-the-model"><span class="header-section-number">5.7</span> Remove influential observations and refit the model</a></li>
  <li><a href="#compare-results-before-and-after-removing-influential-observations" id="toc-compare-results-before-and-after-removing-influential-observations" class="nav-link" data-scroll-target="#compare-results-before-and-after-removing-influential-observations"><span class="header-section-number">5.8</span> Compare results before and after removing influential observations</a>
  <ul class="collapse">
  <li><a href="#model-performance-comparison" id="toc-model-performance-comparison" class="nav-link" data-scroll-target="#model-performance-comparison"><span class="header-section-number">5.8.1</span> Model performance comparison</a></li>
  <li><a href="#model-coefficients-comparison" id="toc-model-coefficients-comparison" class="nav-link" data-scroll-target="#model-coefficients-comparison"><span class="header-section-number">5.8.2</span> Model coefficients comparison</a></li>
  <li><a href="#compare-coefficients-before-and-after-removing-influential-observations" id="toc-compare-coefficients-before-and-after-removing-influential-observations" class="nav-link" data-scroll-target="#compare-coefficients-before-and-after-removing-influential-observations"><span class="header-section-number">5.8.3</span> Compare coefficients before and after removing influential observations</a></li>
  <li><a href="#compare-model-diagnostics-before-and-after-removing-influential-observations" id="toc-compare-model-diagnostics-before-and-after-removing-influential-observations" class="nav-link" data-scroll-target="#compare-model-diagnostics-before-and-after-removing-influential-observations"><span class="header-section-number">5.8.4</span> Compare model diagnostics before and after removing influential observations</a></li>
  </ul></li>
  <li><a href="#calibration-plot-after-removing-influential-observations" id="toc-calibration-plot-after-removing-influential-observations" class="nav-link" data-scroll-target="#calibration-plot-after-removing-influential-observations"><span class="header-section-number">5.9</span> Calibration plot after removing influential observations</a></li>
  </ul></li>
  <li><a href="#part-e-results-presentation-and-interpretation" id="toc-part-e-results-presentation-and-interpretation" class="nav-link" data-scroll-target="#part-e-results-presentation-and-interpretation"><span class="header-section-number">6</span> Part E: Results Presentation and Interpretation</a>
  <ul class="collapse">
  <li><a href="#final-regression-table" id="toc-final-regression-table" class="nav-link" data-scroll-target="#final-regression-table"><span class="header-section-number">6.1</span> Final regression table</a></li>
  <li><a href="#final-model-equation" id="toc-final-model-equation" class="nav-link" data-scroll-target="#final-model-equation"><span class="header-section-number">6.2</span> Final model equation</a></li>
  <li><a href="#interpretation-of-final-model-results" id="toc-interpretation-of-final-model-results" class="nav-link" data-scroll-target="#interpretation-of-final-model-results"><span class="header-section-number">6.3</span> Interpretation of Final Model Results</a>
  <ul class="collapse">
  <li><a href="#main-effects-and-interaction-terms" id="toc-main-effects-and-interaction-terms" class="nav-link" data-scroll-target="#main-effects-and-interaction-terms"><span class="header-section-number">6.3.1</span> Main Effects and Interaction Terms</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">6.3.2</span> Model Comparison</a></li>
  <li><a href="#practical-significance" id="toc-practical-significance" class="nav-link" data-scroll-target="#practical-significance"><span class="header-section-number">6.3.3</span> Practical Significance</a></li>
  <li><a href="#model-assumptions-and-diagnostics" id="toc-model-assumptions-and-diagnostics" class="nav-link" data-scroll-target="#model-assumptions-and-diagnostics"><span class="header-section-number">6.3.4</span> Model Assumptions and Diagnostics</a></li>
  </ul></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">6.4</span> Prediction</a>
  <ul class="collapse">
  <li><a href="#fitted-probabilities-for-existing-patients" id="toc-fitted-probabilities-for-existing-patients" class="nav-link" data-scroll-target="#fitted-probabilities-for-existing-patients"><span class="header-section-number">6.4.1</span> Fitted probabilities for existing patients</a></li>
  <li><a href="#predicted-probabilities-for-new-patients" id="toc-predicted-probabilities-for-new-patients" class="nav-link" data-scroll-target="#predicted-probabilities-for-new-patients"><span class="header-section-number">6.4.2</span> Predicted probabilities for new patients</a></li>
  <li><a href="#prediction-plot-with-confidence-intervals-interaction-plot" id="toc-prediction-plot-with-confidence-intervals-interaction-plot" class="nav-link" data-scroll-target="#prediction-plot-with-confidence-intervals-interaction-plot"><span class="header-section-number">6.4.3</span> Prediction plot with confidence intervals (Interaction plot)</a></li>
  <li><a href="#heatmap-of-predicted-probabilities" id="toc-heatmap-of-predicted-probabilities" class="nav-link" data-scroll-target="#heatmap-of-predicted-probabilities"><span class="header-section-number">6.4.4</span> Heatmap of predicted probabilities</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">7</span> Conclusion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Logistic Regression Analysis of Depression Data</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Logistic Regression</div>
    <div class="quarto-category">Medical Statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Munir (23202537), Farihah (23202679), Sanggary (23202894), Khairunnisa (23202532) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 3, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="research-question-objective" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="research-question-objective"><span class="header-section-number">1.1</span> Research Question / Objective</h2>
<p>To study the association between physical activity, obesity, years of working, and the presence of depression among adults.</p>
<p>Specifically, we aim to:</p>
<ol type="1">
<li>Assess the individual effects of physical activity, obesity, and years of working on depression risk.</li>
<li>Investigate potential interaction effects between physical activity and obesity on depression.</li>
<li>Control for confounding factors and evaluate model fit and assumptions.</li>
</ol>
</section>
</section>
<section id="part-a-dataset-and-variable-creation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Part A: Dataset and variable creation</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.helpers)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3030</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>years_working <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">40</span>), <span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>phys_activity <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>phys_c <span class="ot">&lt;-</span> phys_activity <span class="sc">-</span> <span class="fu">mean</span>(phys_activity)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># More balanced obesity prevalence</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>obesity <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.45</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients tuned for moderate ORs</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">0.06</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.30</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># obesity OR ≈ 1.65</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.20</span>  <span class="co"># weaker interaction</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calibrate intercept for ~25% prevalence</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>mean_prev <span class="ot">&lt;-</span> <span class="cf">function</span>(b0){</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  lp <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">plogis</span>(lp))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(x) <span class="fu">mean_prev</span>(x) <span class="sc">-</span> <span class="fl">0.25</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>linpred <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(linpred)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, <span class="fl">0.05</span>), <span class="fl">0.95</span>)   <span class="co"># clamp to avoid separation</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>depression_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  years_working, phys_activity, obesity, <span class="at">depression =</span> y</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depression_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  years_working phys_activity obesity depression
1           8.4           4.6       1          0
2          19.0           7.7       0          0
3           5.4           8.9       1          0
4          19.5           2.5       1          0
5          24.0           1.4       0          0
6          31.4           4.2       0          0</code></pre>
</div>
</div>
<p>Generate a dataset with 200 observations containing the following variables:</p>
<ul>
<li>Outcome variables: depression (binary, 0 = no depression, 1 = depression)</li>
<li>Covariates:
<ul>
<li>years_working (continious, ranging 0-40 years)</li>
<li>phys_activity (Physical activity score, continious, range 0-10)</li>
<li>obesity (binary, 0 = not obese, 1 = obese)</li>
</ul></li>
<li>Include an interaction effect between phys_activity and obesity on depression.</li>
</ul>
<section id="data-preperation" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-preperation"><span class="header-section-number">2.1</span> Data Preperation</h2>
</section>
<section id="load-libraries" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="load-libraries"><span class="header-section-number">2.2</span> Load libraries</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-cleaning-and-coding" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="data-cleaning-and-coding"><span class="header-section-number">2.3</span> Data cleaning and coding</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>depression_data<span class="sc">$</span>obesity <span class="ot">&lt;-</span> <span class="fu">factor</span>(depression_data<span class="sc">$</span>obesity,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>depression_data<span class="sc">$</span>depression <span class="ot">&lt;-</span> <span class="fu">factor</span>(depression_data<span class="sc">$</span>depression,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(depression_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 4
$ years_working &lt;dbl&gt; 8.4, 19.0, 5.4, 19.5, 24.0, 31.4, 37.7, 13.2, 20.7, 29.3…
$ phys_activity &lt;dbl&gt; 4.6, 7.7, 8.9, 2.5, 1.4, 4.2, 7.5, 1.7, 7.6, 6.3, 1.4, 7…
$ obesity       &lt;fct&gt; obese, not obese, obese, obese, not obese, not obese, ob…
$ depression    &lt;fct&gt; no, no, no, no, no, no, no, yes, no, no, no, no, no, no,…</code></pre>
</div>
</div>
<p><em>Interpretation</em> : The structure of the data shows that ‘years_working’ and ‘phys_activity’ are numeric variables, while ‘obesity’ and ‘depression’ are factors with two levels each.</p>
</section>
<section id="label-variables" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="label-variables"><span class="header-section-number">2.4</span> Label variables</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>years_working) <span class="ot">&lt;-</span> <span class="st">"Years of Working"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>phys_activity) <span class="ot">&lt;-</span> <span class="st">"Physical Activity Score"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>obesity) <span class="ot">&lt;-</span> <span class="st">"Obesity Status"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>depression) <span class="ot">&lt;-</span> <span class="st">"Depression Status"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="part-b-exploratory-data-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Part B: Exploratory Data Analysis</h1>
<section id="descriptive-statistics" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">3.1</span> Descriptive statistics</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(depression_data,  </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">style        =</span> <span class="st">"grid"</span>,  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">varnumbers   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">valid.col    =</span> <span class="cn">FALSE</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"render"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="container st-container">
<h3 class="anchored">Data Frame Summary</h3>
<h4 class="anchored">depression_data</h4>
<strong>Dimensions</strong>: 200 x 4
  <br><strong>Duplicates</strong>: 0
<br>

<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline caption-top table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Variable</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Label</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Stats / Values</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Freqs (% of Valid)</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Graph</strong></th>
<th class="st-protect-top-border" style="text-align: center;" data-quarto-table-cell-role="th"><strong>Missing</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">years_working [numeric]</td>
<td style="text-align: left;">Years of Working</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">Mean (sd) : 21.2 (11.8)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">min ≤ med ≤ max:</td>
</tr>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">0.1 ≤ 22 ≤ 39.1</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">IQR (CV) : 21 (0.6)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle;">157 distinct values</td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMMMhs60XDjAAAAi0lEQVRo3u3V3QnAIAxGUVdoN6jdwOy/W6Ft8hJESEN/6P0eEz2CQiyFRDIFUjVWuYCtcqSBgYGBgb0Ym3X0p2CnIU9j7kPzmC0ZYu58j2mhgYUxe5AlAdOGgIGB7Vu6kz6CuS1gt2A2JTMwt+IDWP8CApiMO2BgYGBgYGBgYGBgYGBgv8RqSgqJZAMpiGdVqR1QjQAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">phys_activity [numeric]</td>
<td style="text-align: left;">Physical Activity Score</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">Mean (sd) : 4.9 (2.8)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">min ≤ med ≤ max:</td>
</tr>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">0.1 ≤ 4.8 ≤ 9.9</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">IQR (CV) : 4.5 (0.6)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle;">87 distinct values</td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAJgAAABuBAMAAAApJ8cWAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMMMhs60XDjAAAAjklEQVRo3u3VwQnAIAyFYVdoN6jdwO6/W6GGQiSkEqUH+d8lB/UjBCQpkUi2z+y5xrvTj11PynqYTOmYgp31/UKYGk+DyVk/ppposFoKGBhYBJPfaGLeKjAxpTSY1+B6WFYZxMw+wcDAwMD+xayFGcacAvZu0TmYFDAwMDAwMDAwMDAwMDAwsFEsT0kikdxwLbIZKVEoVQAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">obesity [factor]</td>
<td style="text-align: left;">Obesity Status</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">1. not obese</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">2. obese</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; padding: 0; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: right; padding: 0 5px 0 7px; margin: 0; border: 0;">106</td>
<td style="text-align: left; padding: 0 2px 0 0; border: 0;">(</td>
<td style="text-align: right; padding: 0; border: 0;">53.0%</td>
<td style="text-align: left; padding: 0 4px 0 2px; border: 0;">)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: right; padding: 0 5px 0 7px; margin: 0; border: 0;">94</td>
<td style="text-align: left; padding: 0 2px 0 0; border: 0;">(</td>
<td style="text-align: right; padding: 0; border: 0;">47.0%</td>
<td style="text-align: left; padding: 0 4px 0 2px; border: 0;">)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAFwAAAA3BAMAAABz8jDyAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMMMhs60XDjAAAAPklEQVRIx2NgGNpAiUgAVa5sTBQwGlU+qnxU+cAqJzFrCxIJ6KKcCGcrIiknImRGlY8qH1U+CJSTmLWHKgAAIzZM4mIwX2oAAAAASUVORK5CYII=" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">depression [factor]</td>
<td style="text-align: left;">Depression Status</td>
<td style="text-align: left; padding: 8; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">1. no</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: left; padding: 0; margin: 0; border: 0;">2. yes</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; padding: 0; vertical-align: middle;"><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd" style="background-color:transparent">
<td style="text-align: right; padding: 0 5px 0 7px; margin: 0; border: 0;">146</td>
<td style="text-align: left; padding: 0 2px 0 0; border: 0;">(</td>
<td style="text-align: right; padding: 0; border: 0;">73.0%</td>
<td style="text-align: left; padding: 0 4px 0 2px; border: 0;">)</td>
</tr>
<tr class="even" style="background-color:transparent">
<td style="text-align: right; padding: 0 5px 0 7px; margin: 0; border: 0;">54</td>
<td style="text-align: left; padding: 0 2px 0 0; border: 0;">(</td>
<td style="text-align: right; padding: 0; border: 0;">27.0%</td>
<td style="text-align: left; padding: 0 4px 0 2px; border: 0;">)</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left; vertical-align: middle; padding: 0; background-color: transparent;"><img src="data:image/png;base64,%20iVBORw0KGgoAAAANSUhEUgAAAHoAAAA3BAMAAAAxsUNlAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAPUExURf////3+/aampvDw8P///7GHRIEAAAACdFJOUwAAdpPNOAAAAAFiS0dEAIgFHUgAAAAHdElNRQfqAQMMMhs60XDjAAAAQ0lEQVRIx2NgGLlAiTwA1a1sTA4wGtU9qntU96juQaubslJRkDwwCHRj85Qi0bqxhfmo7lHdo7pHdQ9l3ZSViiMRAADa5HuzeKWgIwAAAABJRU5ErkJggg==" class="img-fluid" style="border:none;background-color:transparent;padding:0;max-width:max-content;"></td>
<td style="text-align: center;">0 (0.0%)</td>
</tr>
</tbody>
</table>

<p>Generated by <a href="https://github.com/dcomtois/summarytools">summarytools</a> 1.1.4 (<a href="https://www.r-project.org/">R</a> version 4.5.2)<br>2026-01-03</p>
</div>
</div>
</div>
<p><em>Interpretation</em> : The mean duration of working experience was 21.2 years (SD = 11.8). The average physical activity score was 4.9 (SD = 2.8), indicating moderate variability across individuals. Nearly half of the participants (47.0%) were classified as obese, while 27.0% reported experiencing depression.</p>
</section>
<section id="histogram-for-numerical-variables" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="histogram-for-numerical-variables"><span class="header-section-number">3.2</span> Histogram for numerical variables</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select continuous variables from depression_data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> depression_data <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span> <span class="fu">select</span>(years_working, phys_activity)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histograms for each continuous variable</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"phys_activity"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"years_working"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Continuous Variables"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/histograms-continuous-vars-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Histograms of Continuous Variables</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The distribution of physical activity scores appears relatively uniform, with modest peaks around values 5 and 7, suggesting a balanced spread of activity levels across the sample.</li>
<li>In contrast, the distribution of years working is more variable and right-skewed, with noticeable peaks around 10, 20, and 35 years. This indicates substantial heterogeneity in work experience, with a considerable portion of participants reporting extended career durations.</li>
</ul>
</section>
<section id="boxplots-for-numerical-variables-by-obesity-status" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="boxplots-for-numerical-variables-by-obesity-status"><span class="header-section-number">3.3</span> Boxplots for numerical variables by obesity status</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plots by obesity status</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>depression_data <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(obesity) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(continuous_vars) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>obesity, <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> value, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"not obese"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"obese"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plots of Continuous Variables by Obesity Status"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/boxplots-continuous-vars-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Boxplots of Continuous Variables by Obesity Status</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>Physical activity scores remain similar across obesity groups, with both showing median values near 5 and interquartile ranges between approximately 2.5 and 7.5. This indicates comparable activity levels regardless of obesity classification.</li>
<li>Interestingly, the median years of working is slightly higher among individuals classified as obese. Both groups exhibit a wide range of work experience (0 to 40 years), suggesting occupational diversity that may intersect with obesity status.</li>
</ul>
</section>
<section id="bar-plots-for-categorical-variables" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="bar-plots-for-categorical-variables"><span class="header-section-number">3.4</span> Bar plots for categorical variables</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(depression_data, <span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Obesity Status"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"not obese"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"obese"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/barplots-categorical-vars-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Bar Plots of Categorical Variables</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : Among the 200 participants, 53.0% were classified as not obese, while 47.0% were classified as obese. This near-equal distribution provides a balanced representation of obesity status within the sample, allowing for meaningful comparisons across health and behavioral variables.</p>
</section>
<section id="bar-plots-for-depression-by-obesity-status" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="bar-plots-for-depression-by-obesity-status"><span class="header-section-number">3.5</span> Bar plots for depression by obesity status</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(depression_data, <span class="fu">aes</span>(<span class="at">x =</span> depression, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Obesity Status by Depression Status"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression Status"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"not obese"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"obese"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/barplots-depression-by-obesity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Bar Plots of Depression Status by Obesity Status</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>Among participants without depression, the majority were classified as not obese, with a smaller proportion falling into the obese category.</li>
<li>In contrast, among those reporting depression, the distribution shifts slightly—fewer individuals were not obese, while the number of obese individuals was marginally higher.</li>
<li>This pattern suggests a potential association between depression and obesity, warranting further investigation into their interrelated behavioral or physiological pathways.</li>
</ul>
</section>
</section>
<section id="part-c-regression-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Part C: Regression Analysis</h1>
<section id="univariate-analysis" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="univariate-analysis"><span class="header-section-number">4.1</span> Univariate analysis</h2>
<section id="years-of-working" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="years-of-working"><span class="header-section-number">4.1.1</span> Years of working</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mlog_yw <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_yw, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 2: Univariate Model - Years of Working"</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ztufahwxue" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ztufahwxue table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ztufahwxue thead, #ztufahwxue tbody, #ztufahwxue tfoot, #ztufahwxue tr, #ztufahwxue td, #ztufahwxue th {
  border-style: none;
}

#ztufahwxue p {
  margin: 0;
  padding: 0;
}

#ztufahwxue .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ztufahwxue .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ztufahwxue .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ztufahwxue .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ztufahwxue .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ztufahwxue .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ztufahwxue .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ztufahwxue .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ztufahwxue .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ztufahwxue .gt_spanner_row {
  border-bottom-style: hidden;
}

#ztufahwxue .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ztufahwxue .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ztufahwxue .gt_from_md > :first-child {
  margin-top: 0;
}

#ztufahwxue .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ztufahwxue .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ztufahwxue .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ztufahwxue .gt_row_group_first td {
  border-top-width: 2px;
}

#ztufahwxue .gt_row_group_first th {
  border-top-width: 2px;
}

#ztufahwxue .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ztufahwxue .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ztufahwxue .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ztufahwxue .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ztufahwxue .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_left {
  text-align: left;
}

#ztufahwxue .gt_center {
  text-align: center;
}

#ztufahwxue .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ztufahwxue .gt_font_normal {
  font-weight: normal;
}

#ztufahwxue .gt_font_bold {
  font-weight: bold;
}

#ztufahwxue .gt_font_italic {
  font-style: italic;
}

#ztufahwxue .gt_super {
  font-size: 65%;
}

#ztufahwxue .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ztufahwxue .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ztufahwxue .gt_indent_1 {
  text-indent: 5px;
}

#ztufahwxue .gt_indent_2 {
  text-indent: 10px;
}

#ztufahwxue .gt_indent_3 {
  text-indent: 15px;
}

#ztufahwxue .gt_indent_4 {
  text-indent: 20px;
}

#ztufahwxue .gt_indent_5 {
  text-indent: 25px;
}

#ztufahwxue .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ztufahwxue div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 2: Univariate Model - Years of Working</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">0.13</td>
<td class="gt_row gt_center" headers="conf.low">0.06, 0.28</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Years of Working</td>
<td class="gt_row gt_center" headers="estimate">1.05</td>
<td class="gt_row gt_center" headers="conf.low">1.02, 1.08</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.002</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="physical-activity" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="physical-activity"><span class="header-section-number">4.1.2</span> Physical activity</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mlog_pa <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> phys_activity, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_pa, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 3: Univariate Model - Physical Activity"</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hdcaorqdoj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hdcaorqdoj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hdcaorqdoj thead, #hdcaorqdoj tbody, #hdcaorqdoj tfoot, #hdcaorqdoj tr, #hdcaorqdoj td, #hdcaorqdoj th {
  border-style: none;
}

#hdcaorqdoj p {
  margin: 0;
  padding: 0;
}

#hdcaorqdoj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hdcaorqdoj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hdcaorqdoj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hdcaorqdoj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hdcaorqdoj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hdcaorqdoj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hdcaorqdoj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hdcaorqdoj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hdcaorqdoj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hdcaorqdoj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hdcaorqdoj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hdcaorqdoj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hdcaorqdoj .gt_spanner_row {
  border-bottom-style: hidden;
}

#hdcaorqdoj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hdcaorqdoj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hdcaorqdoj .gt_from_md > :first-child {
  margin-top: 0;
}

#hdcaorqdoj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hdcaorqdoj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hdcaorqdoj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hdcaorqdoj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hdcaorqdoj .gt_row_group_first td {
  border-top-width: 2px;
}

#hdcaorqdoj .gt_row_group_first th {
  border-top-width: 2px;
}

#hdcaorqdoj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hdcaorqdoj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hdcaorqdoj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hdcaorqdoj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hdcaorqdoj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hdcaorqdoj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hdcaorqdoj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hdcaorqdoj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hdcaorqdoj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hdcaorqdoj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hdcaorqdoj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hdcaorqdoj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hdcaorqdoj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hdcaorqdoj .gt_left {
  text-align: left;
}

#hdcaorqdoj .gt_center {
  text-align: center;
}

#hdcaorqdoj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hdcaorqdoj .gt_font_normal {
  font-weight: normal;
}

#hdcaorqdoj .gt_font_bold {
  font-weight: bold;
}

#hdcaorqdoj .gt_font_italic {
  font-style: italic;
}

#hdcaorqdoj .gt_super {
  font-size: 65%;
}

#hdcaorqdoj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hdcaorqdoj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hdcaorqdoj .gt_indent_1 {
  text-indent: 5px;
}

#hdcaorqdoj .gt_indent_2 {
  text-indent: 10px;
}

#hdcaorqdoj .gt_indent_3 {
  text-indent: 15px;
}

#hdcaorqdoj .gt_indent_4 {
  text-indent: 20px;
}

#hdcaorqdoj .gt_indent_5 {
  text-indent: 25px;
}

#hdcaorqdoj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hdcaorqdoj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 3: Univariate Model - Physical Activity</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">1.44</td>
<td class="gt_row gt_center" headers="conf.low">0.78, 2.68</td>
<td class="gt_row gt_center" headers="p.value">0.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Physical Activity Score</td>
<td class="gt_row gt_center" headers="estimate">0.73</td>
<td class="gt_row gt_center" headers="conf.low">0.64, 0.83</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="obesity" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="obesity"><span class="header-section-number">4.1.3</span> Obesity</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mlog_ob <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> obesity, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_ob, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 4: Univariate Model - Obesity"</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ptaupolzin" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ptaupolzin table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ptaupolzin thead, #ptaupolzin tbody, #ptaupolzin tfoot, #ptaupolzin tr, #ptaupolzin td, #ptaupolzin th {
  border-style: none;
}

#ptaupolzin p {
  margin: 0;
  padding: 0;
}

#ptaupolzin .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ptaupolzin .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ptaupolzin .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ptaupolzin .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ptaupolzin .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ptaupolzin .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ptaupolzin .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ptaupolzin .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ptaupolzin .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ptaupolzin .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ptaupolzin .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ptaupolzin .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ptaupolzin .gt_spanner_row {
  border-bottom-style: hidden;
}

#ptaupolzin .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ptaupolzin .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ptaupolzin .gt_from_md > :first-child {
  margin-top: 0;
}

#ptaupolzin .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ptaupolzin .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ptaupolzin .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ptaupolzin .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ptaupolzin .gt_row_group_first td {
  border-top-width: 2px;
}

#ptaupolzin .gt_row_group_first th {
  border-top-width: 2px;
}

#ptaupolzin .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptaupolzin .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ptaupolzin .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ptaupolzin .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ptaupolzin .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptaupolzin .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ptaupolzin .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ptaupolzin .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ptaupolzin .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ptaupolzin .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ptaupolzin .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptaupolzin .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ptaupolzin .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptaupolzin .gt_left {
  text-align: left;
}

#ptaupolzin .gt_center {
  text-align: center;
}

#ptaupolzin .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ptaupolzin .gt_font_normal {
  font-weight: normal;
}

#ptaupolzin .gt_font_bold {
  font-weight: bold;
}

#ptaupolzin .gt_font_italic {
  font-style: italic;
}

#ptaupolzin .gt_super {
  font-size: 65%;
}

#ptaupolzin .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ptaupolzin .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ptaupolzin .gt_indent_1 {
  text-indent: 5px;
}

#ptaupolzin .gt_indent_2 {
  text-indent: 10px;
}

#ptaupolzin .gt_indent_3 {
  text-indent: 15px;
}

#ptaupolzin .gt_indent_4 {
  text-indent: 20px;
}

#ptaupolzin .gt_indent_5 {
  text-indent: 25px;
}

#ptaupolzin .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ptaupolzin div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 4: Univariate Model - Obesity</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">0.29</td>
<td class="gt_row gt_center" headers="conf.low">0.18, 0.45</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">1.60</td>
<td class="gt_row gt_center" headers="conf.low">0.86, 3.02</td>
<td class="gt_row gt_center" headers="p.value">0.14</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><em>Interpretation</em> : Based on the univariable analysis, years of working and physical activity are significantly associated with depression status (95% CI not include 1). However, obesity status shows a non-significant association (95% CI include 1).</p>
</section>
</section>
<section id="multivariable-analysis" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="multivariable-analysis"><span class="header-section-number">4.2</span> Multivariable analysis</h2>
<section id="model-full-physical-activity-obesity-and-years-of-working" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="model-full-physical-activity-obesity-and-years-of-working"><span class="header-section-number">4.2.1</span> Model Full: Physical activity, Obesity and Years of working,</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mlog_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_full, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 8: Multivariable Full Model Results"</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="vtruvpikvy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vtruvpikvy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vtruvpikvy thead, #vtruvpikvy tbody, #vtruvpikvy tfoot, #vtruvpikvy tr, #vtruvpikvy td, #vtruvpikvy th {
  border-style: none;
}

#vtruvpikvy p {
  margin: 0;
  padding: 0;
}

#vtruvpikvy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vtruvpikvy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vtruvpikvy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vtruvpikvy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vtruvpikvy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtruvpikvy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtruvpikvy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtruvpikvy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vtruvpikvy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vtruvpikvy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vtruvpikvy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vtruvpikvy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vtruvpikvy .gt_spanner_row {
  border-bottom-style: hidden;
}

#vtruvpikvy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vtruvpikvy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vtruvpikvy .gt_from_md > :first-child {
  margin-top: 0;
}

#vtruvpikvy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vtruvpikvy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vtruvpikvy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vtruvpikvy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vtruvpikvy .gt_row_group_first td {
  border-top-width: 2px;
}

#vtruvpikvy .gt_row_group_first th {
  border-top-width: 2px;
}

#vtruvpikvy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtruvpikvy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vtruvpikvy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vtruvpikvy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtruvpikvy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtruvpikvy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vtruvpikvy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vtruvpikvy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vtruvpikvy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtruvpikvy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtruvpikvy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtruvpikvy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtruvpikvy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtruvpikvy .gt_left {
  text-align: left;
}

#vtruvpikvy .gt_center {
  text-align: center;
}

#vtruvpikvy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vtruvpikvy .gt_font_normal {
  font-weight: normal;
}

#vtruvpikvy .gt_font_bold {
  font-weight: bold;
}

#vtruvpikvy .gt_font_italic {
  font-style: italic;
}

#vtruvpikvy .gt_super {
  font-size: 65%;
}

#vtruvpikvy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vtruvpikvy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vtruvpikvy .gt_indent_1 {
  text-indent: 5px;
}

#vtruvpikvy .gt_indent_2 {
  text-indent: 10px;
}

#vtruvpikvy .gt_indent_3 {
  text-indent: 15px;
}

#vtruvpikvy .gt_indent_4 {
  text-indent: 20px;
}

#vtruvpikvy .gt_indent_5 {
  text-indent: 25px;
}

#vtruvpikvy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vtruvpikvy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 8: Multivariable Full Model Results</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">0.39</td>
<td class="gt_row gt_center" headers="conf.low">0.14, 1.01</td>
<td class="gt_row gt_center" headers="p.value">0.059</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Years of Working</td>
<td class="gt_row gt_center" headers="estimate">1.05</td>
<td class="gt_row gt_center" headers="conf.low">1.02, 1.09</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.002</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Physical Activity Score</td>
<td class="gt_row gt_center" headers="estimate">0.71</td>
<td class="gt_row gt_center" headers="conf.low">0.61, 0.81</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">1.81</td>
<td class="gt_row gt_center" headers="conf.low">0.90, 3.70</td>
<td class="gt_row gt_center" headers="p.value">0.10</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="model-interaction-physical-activity-and-obesity-interaction" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="model-interaction-physical-activity-and-obesity-interaction"><span class="header-section-number">4.2.2</span> Model Interaction: Physical activity and obesity interaction</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mloginter_pa.ob <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mloginter_pa.ob, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 10: Interaction Model - Physical Activity and Obesity"</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="aaycrvzasa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aaycrvzasa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aaycrvzasa thead, #aaycrvzasa tbody, #aaycrvzasa tfoot, #aaycrvzasa tr, #aaycrvzasa td, #aaycrvzasa th {
  border-style: none;
}

#aaycrvzasa p {
  margin: 0;
  padding: 0;
}

#aaycrvzasa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aaycrvzasa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aaycrvzasa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aaycrvzasa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aaycrvzasa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aaycrvzasa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aaycrvzasa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aaycrvzasa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aaycrvzasa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aaycrvzasa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aaycrvzasa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aaycrvzasa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aaycrvzasa .gt_spanner_row {
  border-bottom-style: hidden;
}

#aaycrvzasa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aaycrvzasa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aaycrvzasa .gt_from_md > :first-child {
  margin-top: 0;
}

#aaycrvzasa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aaycrvzasa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aaycrvzasa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aaycrvzasa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aaycrvzasa .gt_row_group_first td {
  border-top-width: 2px;
}

#aaycrvzasa .gt_row_group_first th {
  border-top-width: 2px;
}

#aaycrvzasa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaycrvzasa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aaycrvzasa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aaycrvzasa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aaycrvzasa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaycrvzasa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aaycrvzasa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aaycrvzasa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aaycrvzasa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aaycrvzasa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aaycrvzasa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaycrvzasa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aaycrvzasa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaycrvzasa .gt_left {
  text-align: left;
}

#aaycrvzasa .gt_center {
  text-align: center;
}

#aaycrvzasa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aaycrvzasa .gt_font_normal {
  font-weight: normal;
}

#aaycrvzasa .gt_font_bold {
  font-weight: bold;
}

#aaycrvzasa .gt_font_italic {
  font-style: italic;
}

#aaycrvzasa .gt_super {
  font-size: 65%;
}

#aaycrvzasa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aaycrvzasa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aaycrvzasa .gt_indent_1 {
  text-indent: 5px;
}

#aaycrvzasa .gt_indent_2 {
  text-indent: 10px;
}

#aaycrvzasa .gt_indent_3 {
  text-indent: 15px;
}

#aaycrvzasa .gt_indent_4 {
  text-indent: 20px;
}

#aaycrvzasa .gt_indent_5 {
  text-indent: 25px;
}

#aaycrvzasa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aaycrvzasa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 10: Interaction Model - Physical Activity and Obesity</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">0.21</td>
<td class="gt_row gt_center" headers="conf.low">0.06, 0.62</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.007</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Years of Working</td>
<td class="gt_row gt_center" headers="estimate">1.05</td>
<td class="gt_row gt_center" headers="conf.low">1.02, 1.09</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.002</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Physical Activity Score</td>
<td class="gt_row gt_center" headers="estimate">0.83</td>
<td class="gt_row gt_center" headers="conf.low">0.69, 0.99</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.040</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">7.98</td>
<td class="gt_row gt_center" headers="conf.low">2.03, 34.8</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.004</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Physical Activity Score * Obesity Status</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Physical Activity Score * obese</td>
<td class="gt_row gt_center" headers="estimate">0.69</td>
<td class="gt_row gt_center" headers="conf.low">0.50, 0.92</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.016</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><em>Interpretation</em> : Physical activity and obesity interaction term is significant (p &lt; 0.05), indicating that the effect of physical activity on depression varies by obesity status.</p>
</section>
</section>
<section id="model-comparison-and-selection" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="model-comparison-and-selection"><span class="header-section-number">4.3</span> Model comparison and selection</h2>
<p>Model fit:</p>
<ul>
<li>Model 1: depression ~ years_working + phys_activity + obesity</li>
<li>Model 2: depression ~ years_working + phys_activity + obesity + phys_activity:obesity</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> mlog_full</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> mloginter_pa.ob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="anova-to-compare-nested-models" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="anova-to-compare-nested-models"><span class="header-section-number">4.3.1</span> ANOVA to compare nested models</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: depression ~ years_working + phys_activity + obesity
Model 2: depression ~ years_working + phys_activity + obesity + phys_activity:obesity
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  
1       196     194.63                       
2       195     188.40  1   6.2296  0.01256 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The likelihood ratio test comparing nested models showed that adding the interaction between physical activity and obesity significantly improved model fit (p = 0.013).</li>
<li>This suggests that the association between physical activity and depression differs by obesity status, supporting inclusion of the interaction term in the final model.</li>
</ul>
</section>
</section>
</section>
<section id="part-d-model-checking" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Part D: Model Checking</h1>
<section id="check-assumptions" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="check-assumptions"><span class="header-section-number">5.1</span> Check assumptions</h2>
<section id="linearity-of-the-logit-for-continuous-variables" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="linearity-of-the-logit-for-continuous-variables"><span class="header-section-number">5.1.1</span> Linearity of the logit for continuous variables</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mfp)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>lin_pa.yw <span class="ot">&lt;-</span>  <span class="fu">mfp</span>(depression <span class="sc">~</span> <span class="fu">fp</span>(years_working) <span class="sc">+</span> <span class="fu">fp</span>(phys_activity) <span class="sc">+</span> obesity,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> depression_data,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> binomial, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Variable    Deviance    Power(s)
------------------------------------------------
Cycle 1
    phys_activity            
                221.55       
                194.626     1
                193.513     0.5
                192.311     -2 1

    years_working            
                205.034      
                194.626     1
                194.626     1
                193.611     0 0

    obesityobese             
                197.429      
                194.626     1
                                
                                


Tansformation
              shift scale
phys_activity     0    10
years_working     0    10
obesityobese      0     1

Fractional polynomials
              df.initial select alpha df.final power1 power2
phys_activity          4      1  0.05        1      1      .
years_working          4      1  0.05        1      1      .
obesityobese           1      1  0.05        1      1      .


Transformations of covariates:
                              formula
years_working I((years_working/10)^1)
phys_activity I((phys_activity/10)^1)
obesity                       obesity


Deviance table:
         Resid. Dev
Null model   233.3035
Linear model     194.6256
Final model  194.6256</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The fractional polynomial analysis indicated that both years working and physical activity did not require higher‑order transformations, as the linear specification provided the best fit.</li>
<li>Thus, modeling these variables as linear predictors in the logistic regression is appropriate.</li>
</ul>
</section>
<section id="independence" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="independence"><span class="header-section-number">5.1.2</span> Independence</h3>
<p>Based on study design, we assume independence of observations.</p>
<p><em>Each participant in this study contributed only one record, and data were collected at a single time point. There were no repeated measures or clustering, so the observations can be considered independent.</em></p>
</section>
<section id="absence-of-multicollinearity" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="absence-of-multicollinearity"><span class="header-section-number">5.1.3</span> Absence of multicollinearity</h3>
<ul>
<li>Correlation matrix</li>
<li>Estimate standard errors</li>
<li>Variance Inflation Factor (VIF)</li>
</ul>
<section id="check-correlation-between-variables" class="level4">
<h4 class="anchored" data-anchor-id="check-correlation-between-variables">Check correlation between variables</h4>
<section id="correlation-matrix-years-working-and-physical-activity" class="level5">
<h5 class="anchored" data-anchor-id="correlation-matrix-years-working-and-physical-activity">Correlation matrix (years working and physical activity)</h5>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> depression_data <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(years_working, phys_activity) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>cor_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              years_working phys_activity
years_working    1.00000000   -0.01376055
phys_activity   -0.01376055    1.00000000</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The correlation between years of working and physical activity score is very weak and negative (r = –0.014), indicating virtually no linear relationship between the two variables.</li>
<li>This suggests that multicollinearity is unlikely to be a concern when including both predictors in the same regression model.</li>
</ul>
</section>
<section id="visualize-correlation-matrix" class="level5">
<h5 class="anchored" data-anchor-id="visualize-correlation-matrix">Visualize correlation matrix</h5>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"white"</span>, <span class="st">"darkblue"</span>))(<span class="dv">200</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>, <span class="at">number.cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Depression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The correlation matrix and plot confirm that there is no significant correlation between years working and physical activity (r = −0.014).</li>
<li>This suggests that these variables do not correlate each other in the analysis of depression.</li>
</ul>
</section>
</section>
<section id="estimate-standard-errors" class="level4">
<h4 class="anchored" data-anchor-id="estimate-standard-errors">Estimate standard errors</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">##| label: standard-errors</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="do">##| include: true</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show only estimates and standard errors for Model 2</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod2, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span> <span class="fu">select</span>(term, estimate, std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  term                       estimate std.error
  &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)                   0.210    0.577 
2 years_working                 1.05     0.0165
3 phys_activity                 0.829    0.0912
4 obesityobese                  7.98     0.721 
5 phys_activity:obesityobese    0.688    0.156 </code></pre>
</div>
</div>
<p><em>Interpretation</em> : All predictors were statistically significant, with reasonably small standard errors, indicating precise estimates. There were no signs of inflated standard errors that would suggest multicollinearity issues.</p>
</section>
<section id="variance-inflation-factor-vif" class="level4">
<h4 class="anchored" data-anchor-id="variance-inflation-factor-vif">Variance Inflation Factor (VIF)</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(mod2)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame for better display</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(vif_values),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">VIF =</span> <span class="fu">round</span>(vif_values, <span class="dv">2</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>vif_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                   Variable  VIF
years_working                 years_working 1.03
phys_activity                 phys_activity 1.53
obesity                             obesity 3.96
phys_activity:obesity phys_activity:obesity 4.44</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>Variance Inflation Factor (VIF) diagnostics indicated no collinearity concerns for years of working (VIF = 1.03) and physical activity (VIF = 1.53), both well below the conventional threshold of 2.</li>
<li>In contrast, obesity (VIF ≈ 3.96) and the physical activity × obesity interaction (VIF ≈ 4.44) showed elevated values.</li>
<li>This reflects the inherent correlation between interaction terms and their main effects. While such inflation is expected in models including interactions, it suggests caution in interpreting individual coefficients.</li>
<li>Nonetheless, the overall model remains valid and interpretable.</li>
</ul>
</section>
</section>
</section>
<section id="assess-goodness-of-fit" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="assess-goodness-of-fit"><span class="header-section-number">5.2</span> Assess Goodness-of-fit</h2>
<section id="hosmer-lemeshow-test" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="hosmer-lemeshow-test"><span class="header-section-number">5.2.1</span> Hosmer-Lemeshow test</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode outcome as 0/1 numeric</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>depression_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(depression_data<span class="sc">$</span>depression <span class="sc">==</span> <span class="st">"depressed"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Hosmer–Lemeshow test</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(depression_num, <span class="fu">fitted</span>(mod2), <span class="at">g =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  depression_num, fitted(mod2)
X-squared = 113.77, df = 8, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p><em>Interpretation</em> : The Hosmer–Lemeshow test was highly significant (p &lt; 0.001), indicating evidence of poor fit. This suggests that the logistic regression model’s predicted probabilities do not align well with the observed outcomes.</p>
</section>
<section id="classification-table" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="classification-table"><span class="header-section-number">5.2.2</span> Classification table</h3>
<p>Predict classes based on a 0.5 threshold and create confusion matrix to calculate:</p>
<ul>
<li>Accuracy</li>
<li>Sensitivity</li>
<li>Specificity</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted probabilities</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>final.m.prob <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod2, <span class="at">type.predict =</span> <span class="st">"response"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred.class =</span> <span class="fu">ifelse</span>(.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(final.m.prob<span class="sc">$</span>pred.class),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.factor</span>(depression_data<span class="sc">$</span>depression),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  no yes
       no  138  31
       yes   8  23
                                          
               Accuracy : 0.805           
                 95% CI : (0.7432, 0.8575)
    No Information Rate : 0.73            
    P-Value [Acc &gt; NIR] : 0.008841        
                                          
                  Kappa : 0.4287          
                                          
 Mcnemar's Test P-Value : 0.000427        
                                          
            Sensitivity : 0.4259          
            Specificity : 0.9452          
         Pos Pred Value : 0.7419          
         Neg Pred Value : 0.8166          
             Prevalence : 0.2700          
         Detection Rate : 0.1150          
   Detection Prevalence : 0.1550          
      Balanced Accuracy : 0.6856          
                                          
       'Positive' Class : yes             
                                          </code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The logistic regression model achieved an overall accuracy of 80.5% (95% CI: 74, 86).</li>
<li>Specificity was high (94.5%), but sensitivity was modest (42.6%), indicating the model was better at correctly identifying non-depressed individuals than depressed ones.</li>
<li>Positive and negative predictive values were 74% and 82%, respectively.</li>
<li>The Kappa statistic (0.43) indicated moderate agreement beyond chance. However, McNemar’s test was significant (p &lt; 0.001), suggesting some systematic misclassification, mainly due to under-detection of depressed cases.</li>
<li>Overall, the model performs well in distinguishing non-depressed individuals, but sensitivity limitations highlight caution in clinical application.</li>
</ul>
</section>
<section id="roc-curve" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="roc-curve"><span class="header-section-number">5.2.3</span> ROC Curve</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Build ROC object</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(depression_data<span class="sc">$</span>depression, final.m.prob<span class="sc">$</span>.fitted)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curve</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add AUC text to the plot</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_value, <span class="dv">3</span>)), <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Depression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em>: The model can distinguish between patients with and without diabetes complications approximately 77.4% of the time (AUC = 0.774).</p>
</section>
</section>
<section id="check-for-confounding" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="check-for-confounding"><span class="header-section-number">5.3</span> Check for confounding</h2>
<section id="assess-confounding-by-examining-percent-change-in-or" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="assess-confounding-by-examining-percent-change-in-or"><span class="header-section-number">5.3.1</span> Assess confounding by examining percent change in OR</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pa =</span> mlog_pa,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pa_ob =</span> <span class="fu">glm</span>(depression <span class="sc">~</span> phys_activity <span class="sc">+</span> obesity, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> depression_data, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> binomial),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pa_ob_yw =</span> mlog_full</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>confounding <span class="ot">&lt;-</span> <span class="fu">map_df</span>(models, <span class="sc">~</span> <span class="fu">tidy</span>(.x, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>), <span class="at">.id =</span> <span class="st">"model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"phys_activity"</span>)   <span class="co"># fix typo here</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unadjusted OR for phys_activity</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>or_unadj <span class="ot">&lt;-</span> confounding <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"pa"</span>) <span class="sc">%&gt;%</span>         <span class="co"># use "pa", not "phys_activity"</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add percent change column</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>confounding <span class="ot">&lt;-</span> confounding <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_change =</span> <span class="fu">round</span>((estimate <span class="sc">-</span> or_unadj) <span class="sc">/</span> or_unadj <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>confounding</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  model    term          estimate std.error statistic    p.value percent_change
  &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;
1 pa       phys_activity    0.731    0.0683     -4.59 0.00000449            0  
2 pa_ob    phys_activity    0.721    0.0701     -4.67 0.00000298           -1.4
3 pa_ob_yw phys_activity    0.709    0.0731     -4.71 0.00000246           -3.1</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The adjusted odds ratios for physical activity changed by less than 10% after sequentially adjusting for obesity and years of working.</li>
<li>This minimal change suggests that neither variable acts as a significant confounder in the relationship between physical activity and depression.</li>
</ul>
</section>
<section id="check-the-association-of-each-variable-with-the-outcome-depression" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="check-the-association-of-each-variable-with-the-outcome-depression"><span class="header-section-number">5.3.2</span> Check the association of each variable with the outcome (depression)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>slr.pa.ob.yw <span class="ot">&lt;-</span> depression_data <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phys_activity, obesity, years_working) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imap</span>(<span class="sc">~</span> <span class="fu">glm</span>(depression <span class="sc">~</span> .x, <span class="at">data =</span> depression_data, <span class="at">family =</span> binomial) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">tidy</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">model =</span> .y)) <span class="sc">%&gt;%</span>   <span class="co"># .y is the column name</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results without intercepts</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>slr.pa.ob.yw <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(model, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  model         term    estimate std.error statistic    p.value
  &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 phys_activity .x         0.731    0.0683     -4.59 0.00000449
2 obesity       .xobese    1.60     0.321       1.47 0.142     
3 years_working .x         1.05     0.0148      3.05 0.00229   </code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>Physical activity and years of working were statistically significant and clinically relevant predictors of depression, each contributing independently to risk.</li>
<li>Obesity showed a positive association but was not statistically significant in the univariable model.</li>
<li>These results support including physical activity and years of working in the final model, while obesity may warrant further evaluation in multivariable or interaction models.</li>
</ul>
</section>
</section>
<section id="diagnostic-plot" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="diagnostic-plot"><span class="header-section-number">5.4</span> Diagnostic plot</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Depression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The diagnostic plots for Model 2 (interaction) show no major violations of regression assumptions.</li>
<li>Residuals are generally well-behaved, variance appears roughly constant, and only a few observations (e.g., points 140, 18, 200) show moderate influence.</li>
<li>Overall, the model appears statistically sound and well-fitted to the data.</li>
</ul>
</section>
<section id="perform-influential-analysis" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="perform-influential-analysis"><span class="header-section-number">5.5</span> Perform influential analysis</h2>
<section id="list-of-influential-observations" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="list-of-influential-observations"><span class="header-section-number">5.5.1</span> List of influential observations</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(mod2)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>infl.val <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(infl<span class="sc">$</span>infmat)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(infl.val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dfb.1_"   "dfb.yrs_" "dfb.phy_" "dfb.obst" "dfb.ph_." "dffit"    "cov.r"   
[8] "cook.d"   "hat"     </code></pre>
</div>
</div>
</section>
<section id="cooks-distance" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="cooks-distance"><span class="header-section-number">5.5.2</span> Cook’s distance</h3>
<p>Cut off for Cook’s distance: 4/n</p>
<section id="cooks-distance-influential-observations" class="level4">
<h4 class="anchored" data-anchor-id="cooks-distance-influential-observations">Cook’s distance influential observations</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>cutoff.cook.d <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(depression_data)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>infl.val <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cook.d <span class="sc">&gt;</span> cutoff.cook.d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          dfb.1_    dfb.yrs_      dfb.phy_    dfb.obst     dfb.ph_.      dffit
18  -0.249007118  0.15726218  0.3471760801  0.13024221 -0.221336653  0.4356124
37   0.039726136 -0.06155243  0.0042432023 -0.24466645  0.196265127 -0.3182343
63  -0.117992367  0.04999357  0.2529966847  0.07250335 -0.153677298  0.3197185
67   0.093939786 -0.14555208  0.0100338354 -0.04224324  0.128670636  0.2784048
80   0.210068873 -0.24794781  0.0447425105 -0.05916895  0.003095667  0.2962618
102  0.223070446 -0.25649664  0.0334497858 -0.06582087  0.010699951  0.3024887
140  0.007417406 -0.01149267  0.0007922631 -0.19278888  0.280687824  0.3696816
170  0.042355602 -0.16133300  0.2116237764  0.03704477 -0.104596239  0.3011674
200 -0.020213242  0.03131878 -0.0021590037 -0.16772981  0.270520538  0.3803866
        cov.r     cook.d        hat
18  0.9929561 0.04307158 0.05278345
37  0.9881598 0.02004981 0.03443451
63  0.9602281 0.02567776 0.02708503
67  0.9307066 0.02507650 0.01694015
80  0.9134766 0.03536674 0.01652297
102 0.9135705 0.03706807 0.01714471
140 0.8641456 0.11257705 0.01788526
170 0.9082847 0.03912300 0.01638242
200 0.9165242 0.06180229 0.02577770</code></pre>
</div>
</div>
</section>
<section id="cooks-distance-plot" class="level4">
<h4 class="anchored" data-anchor-id="cooks-distance-plot">Cook’s distance plot</h4>
<p>Cutpoint for Cook’s distance: 4/n</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(depression_data)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels=</span>cutoff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Depression_files/figure-html/cooks-distance-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The Cook’s distance plot identified observations 18, 140, and 200 as potentially influential, with elevated Cook’s distances relative to the rest of the dataset.</li>
<li>While these points may affect model estimates, none exceed the conventional threshold for high influence, suggesting that the model is generally robust.</li>
</ul>
</section>
</section>
<section id="dfbetas" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="dfbetas"><span class="header-section-number">5.5.3</span> DFBETAS</h3>
<p>Cut off for DFBETAS: 2/sqrt(n)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute DFBETAS</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(mod2)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Color palette for coefficients</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dodgerblue4"</span>, <span class="st">"firebrick"</span>, <span class="st">"darkorchid"</span>, <span class="st">"seagreen"</span>, <span class="st">"goldenrod"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot DFBETAS</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(dfb, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> colors,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"DFBETAS for Model Coefficients"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"DFBETAS"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Threshold lines based on rule of thumb: 2/sqrt(n)</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(dfb))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span>cutoff, cutoff), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend (placed neatly at top right, vertical layout)</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="dv">0</span>), <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Years Working"</span>, <span class="st">"Physical Activity"</span>, </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Obesity: Obese"</span>, <span class="st">"Interaction: Phys x Obesity"</span>),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> colors, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">horiz =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/dfbetas-plot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>DFBETAS for Model Coefficients</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>Each colored line represents how much a single observation affects a specific regression coefficient.</li>
<li>Most lines are short and stay within the red dashed lines (±0.1), indicating that most observations have minimal influence.</li>
<li>A few spikes exceed ±0.1 — these are potentially influential observations that may meaningfully affect specific model coefficients.</li>
</ul>
</section>
<section id="leverage-points" class="level3" data-number="5.5.4">
<h3 data-number="5.5.4" class="anchored" data-anchor-id="leverage-points"><span class="header-section-number">5.5.4</span> Leverage points</h3>
<p>Cut off for leverage: (2p + 2)/n</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>leverage_values <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(mod2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic leverage plot with enhancements</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leverage_values, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Leverage Values"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Leverage"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add horizontal cutoff line</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(<span class="fu">coef</span>(mod2)) <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(depression_data)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cutoff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate influential points</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>influential <span class="ot">&lt;-</span> <span class="fu">which</span>(leverage_values <span class="sc">&gt;</span> cutoff)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(influential, leverage_values[influential], <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(influential, leverage_values[influential], <span class="at">labels =</span> influential, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Label with observation numbers</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(influential, leverage_values[influential],</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> influential, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/leverage-plot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Leverage Values for Observations</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>Most observations fall below the cutoff line, indicating low leverage and minimal influence on the model.</li>
<li>However, one observation exceeds the threshold, suggesting it may disproportionately affect the regression estimates.</li>
<li>This point should be reviewed further to assess its impact on model stability and validity.</li>
</ul>
</section>
<section id="standardized-residuals" class="level3" data-number="5.5.5">
<h3 data-number="5.5.5" class="anchored" data-anchor-id="standardized-residuals"><span class="header-section-number">5.5.5</span> Standardized residuals</h3>
<p>cut off for standardized residuals: |2|</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized residuals</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>std_resid <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(mod2)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(std_resid,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Standardized Residuals"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Standardized Residuals"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cutoff lines</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify influential observations (outside ±2)</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>infl_obs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_resid) <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels for those points</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> infl_obs, <span class="at">y =</span> std_resid[infl_obs],</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> infl_obs, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/standardized-residuals-plot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Standardized Residuals for Final Model</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The standardized residuals plot shows that most observations fall within ±2, indicating a good model fit.</li>
<li>However, a few points exceed this range, suggesting potential outliers that may warrant further investigation to assess their influence on the model.</li>
</ul>
</section>
</section>
<section id="identify-the-influential-observations" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="identify-the-influential-observations"><span class="header-section-number">5.6</span> Identify the influential observations</h2>
<p>Cutoffs:</p>
<ul>
<li>Cook’s distance: 4/n</li>
<li>Standardized residuals: |2|</li>
<li>Leverage: (2p + 2)/n</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (DT)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create diagnostic datashet (predictions and residuals)</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>depression_pred.res <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod2, depression_data)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define thresholds</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(depression_data)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>p_preds <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mod2))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>cooks_cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> n_obs</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>leverage_cutoff <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> p_preds <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> n_obs</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify influential observations</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>influential_obs <span class="ot">&lt;-</span> depression_pred.res <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&gt;</span> cooks_cutoff <span class="sc">|</span> <span class="fu">abs</span>(.std.resid) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">|</span> .hat <span class="sc">&gt;</span> leverage_cutoff)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print count</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(influential_obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display influential observations summary</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(influential_obs, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Table 14: Influential Observations Summary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5dd8db99418fe7b5e5d4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5dd8db99418fe7b5e5d4">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 14: Influential Observations Summary<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10"],[38.3,25.8,29.6,12.9,1.3,0.4,11.1,28.5,10.1,31.2],[9.1,1.5,7.8,5.6,4.5,4.3,0.1,9.6,7.5,8.1],["not obese","obese","not obese","obese","not obese","not obese","obese","obese","not obese","obese"],["yes","no","yes","yes","yes","yes","yes","yes","yes","yes"],[-1.297648566257119,0.9985160052822889,-1.501164840938269,-1.967512077353584,-2.3371360388824,-2.345917622553704,1.029677466323695,-3.41300443497093,-2.446903199547247,-2.431636858411407],[1.754514793569484,-1.61998581289593,1.845191439045155,2.04859396221938,2.204247758534066,2.20787914609592,0.7814939203701333,2.625039258021002,2.249409290589821,2.243158271473008],[0.05278344821058344,0.03443450579549035,0.02708502542432655,0.016940147996496,0.01652297456267181,0.01714470882255752,0.06365537675695658,0.01788526327773441,0.01638242317381365,0.02577770429618031],[0.976914252769946,0.978316560120609,0.9762553848136267,0.9742216774057677,0.9724441692666369,0.9723926800768687,0.9837434594576238,0.9669264300742029,0.9719039357747373,0.971848821266579],[0.04307158055130906,0.02004981485956685,0.02567775639368037,0.02507649962957415,0.03536674385489166,0.03706807454806607,0.005185736015679472,0.1125770516719436,0.03912299835596737,0.06180229088625231],[1.802737094627675,-1.648619158981779,1.870699314297683,2.06616931945835,2.222686943246133,2.227052768561181,0.8076212607354424,2.648833674207665,2.268064203044145,2.272641249890595]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>years_working<\/th>\n      <th>phys_activity<\/th>\n      <th>obesity<\/th>\n      <th>depression<\/th>\n      <th>.fitted<\/th>\n      <th>.resid<\/th>\n      <th>.hat<\/th>\n      <th>.sigma<\/th>\n      <th>.cooksd<\/th>\n      <th>.std.resid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"years_working","targets":1},{"name":"phys_activity","targets":2},{"name":"obesity","targets":3},{"name":"depression","targets":4},{"name":".fitted","targets":5},{"name":".resid","targets":6},{"name":".hat","targets":7},{"name":".sigma","targets":8},{"name":".cooksd","targets":9},{"name":".std.resid","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="remove-influential-observations-and-refit-the-model" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="remove-influential-observations-and-refit-the-model"><span class="header-section-number">5.7</span> Remove influential observations and refit the model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove influential observations based on Cook's distance, residuals, and leverage</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>clean_data <span class="ot">&lt;-</span> depression_pred.res <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&lt;=</span> cooks_cutoff <span class="sc">&amp;</span> <span class="fu">abs</span>(.std.resid) <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">&amp;</span> .hat <span class="sc">&lt;=</span> leverage_cutoff)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit the logistic regression model on cleaned data</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>final_model_clean <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> clean_data, <span class="at">family =</span> binomial)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression summary table with correct labels</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  final_model_clean,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    years_working <span class="sc">~</span> <span class="st">"Years Working"</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    phys_activity <span class="sc">~</span> <span class="st">"Physical Activity"</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    obesity <span class="sc">~</span> <span class="st">"Obesity"</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">phys_activity:obesity</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Interaction: Physical Activity × Obesity"</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_source_note</span>(<span class="at">include =</span> <span class="fu">c</span>(AIC, BIC, logLik)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(estimate <span class="sc">~</span> <span class="st">"**Adjusted OR**"</span>)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to gt and style</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>tbl <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 15: Final Model Results after Removing Influential Observations"</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="yzbphvfuxu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yzbphvfuxu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yzbphvfuxu thead, #yzbphvfuxu tbody, #yzbphvfuxu tfoot, #yzbphvfuxu tr, #yzbphvfuxu td, #yzbphvfuxu th {
  border-style: none;
}

#yzbphvfuxu p {
  margin: 0;
  padding: 0;
}

#yzbphvfuxu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yzbphvfuxu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yzbphvfuxu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yzbphvfuxu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yzbphvfuxu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzbphvfuxu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzbphvfuxu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzbphvfuxu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yzbphvfuxu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yzbphvfuxu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yzbphvfuxu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yzbphvfuxu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yzbphvfuxu .gt_spanner_row {
  border-bottom-style: hidden;
}

#yzbphvfuxu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yzbphvfuxu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yzbphvfuxu .gt_from_md > :first-child {
  margin-top: 0;
}

#yzbphvfuxu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yzbphvfuxu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yzbphvfuxu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yzbphvfuxu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yzbphvfuxu .gt_row_group_first td {
  border-top-width: 2px;
}

#yzbphvfuxu .gt_row_group_first th {
  border-top-width: 2px;
}

#yzbphvfuxu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzbphvfuxu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yzbphvfuxu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yzbphvfuxu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzbphvfuxu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzbphvfuxu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yzbphvfuxu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yzbphvfuxu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yzbphvfuxu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzbphvfuxu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzbphvfuxu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzbphvfuxu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzbphvfuxu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzbphvfuxu .gt_left {
  text-align: left;
}

#yzbphvfuxu .gt_center {
  text-align: center;
}

#yzbphvfuxu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yzbphvfuxu .gt_font_normal {
  font-weight: normal;
}

#yzbphvfuxu .gt_font_bold {
  font-weight: bold;
}

#yzbphvfuxu .gt_font_italic {
  font-style: italic;
}

#yzbphvfuxu .gt_super {
  font-size: 65%;
}

#yzbphvfuxu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yzbphvfuxu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yzbphvfuxu .gt_indent_1 {
  text-indent: 5px;
}

#yzbphvfuxu .gt_indent_2 {
  text-indent: 10px;
}

#yzbphvfuxu .gt_indent_3 {
  text-indent: 15px;
}

#yzbphvfuxu .gt_indent_4 {
  text-indent: 20px;
}

#yzbphvfuxu .gt_indent_5 {
  text-indent: 25px;
}

#yzbphvfuxu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yzbphvfuxu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 15: Final Model Results after Removing Influential Observations</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Adjusted OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">0.14</td>
<td class="gt_row gt_center" headers="conf.low">0.03, 0.51</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.005</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Years Working</td>
<td class="gt_row gt_center" headers="estimate">1.08</td>
<td class="gt_row gt_center" headers="conf.low">1.04, 1.13</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Physical Activity</td>
<td class="gt_row gt_center" headers="estimate">0.71</td>
<td class="gt_row gt_center" headers="conf.low">0.56, 0.89</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.004</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Obesity</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">19.0</td>
<td class="gt_row gt_center" headers="conf.low">3.48, 131</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Interaction: Physical Activity × Obesity</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Physical Activity * obese</td>
<td class="gt_row gt_center" headers="estimate">0.57</td>
<td class="gt_row gt_center" headers="conf.low">0.35, 0.87</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.013</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
<tr class="gt_sourcenotes even">
<td colspan="4" class="gt_sourcenote">AIC = 150; BIC = 166; Log-likelihood = -70.1</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="compare-results-before-and-after-removing-influential-observations" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="compare-results-before-and-after-removing-influential-observations"><span class="header-section-number">5.8</span> Compare results before and after removing influential observations</h2>
<section id="model-performance-comparison" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="model-performance-comparison"><span class="header-section-number">5.8.1</span> Model performance comparison</h3>
<ul>
<li>Model A (before removing influential observations)</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC   |  AICc |   BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log
------------------------------------------------------------------------
198.4 | 198.7 | 214.9 |     0.229 | 0.388 |     1 |    0.471 |   -19.521

AIC   | Score_spherical |   PCP
-------------------------------
198.4 |           0.021 | 0.696</code></pre>
</div>
</div>
<ul>
<li>Model B (after removing influential observations)</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(final_model_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC   |  AICc |   BIC | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log
------------------------------------------------------------------------
150.1 | 150.4 | 166.3 |     0.352 | 0.343 |     1 |    0.369 |   -16.456

AIC   | Score_spherical |   PCP
-------------------------------
150.1 |           0.035 | 0.766</code></pre>
</div>
</div>
</section>
<section id="model-coefficients-comparison" class="level3" data-number="5.8.2">
<h3 data-number="5.8.2" class="anchored" data-anchor-id="model-coefficients-comparison"><span class="header-section-number">5.8.2</span> Model coefficients comparison</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(mod2, final_model_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name              | Model | AIC (weights) | AICc (weights) | BIC (weights)
--------------------------------------------------------------------------
mod2              |   glm | 198.4 (&lt;.001) |  198.7 (&lt;.001) | 214.9 (&lt;.001)
final_model_clean |   glm | 150.1 (&gt;.999) |  150.4 (&gt;.999) | 166.3 (&gt;.999)

Name              | Tjur's R2 |  RMSE | Sigma | Log_loss | Score_log
--------------------------------------------------------------------
mod2              |     0.229 | 0.388 |     1 |    0.471 |   -19.521
final_model_clean |     0.352 | 0.343 |     1 |    0.369 |   -16.456

Name              | Score_spherical |   PCP
-------------------------------------------
mod2              |           0.021 | 0.696
final_model_clean |           0.035 | 0.766</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>The cleaned model outperformed the original model across multiple evaluation metrics.</li>
<li>It had lower AIC, BIC, and log-loss values, indicating improved model fit.</li>
<li>It also showed higher Tjur’s R² (0.352 vs.&nbsp;0.229) and prediction accuracy (PCP = 0.766 vs.&nbsp;0.696), reflecting stronger explanatory power and better classification performance.</li>
<li>These improvements suggest that removing influential observations enhanced the model’s overall robustness and predictive accuracy.</li>
</ul>
</section>
<section id="compare-coefficients-before-and-after-removing-influential-observations" class="level3" data-number="5.8.3">
<h3 data-number="5.8.3" class="anchored" data-anchor-id="compare-coefficients-before-and-after-removing-influential-observations"><span class="header-section-number">5.8.3</span> Compare coefficients before and after removing influential observations</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>coef_comparison <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod2) <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span> <span class="fu">select</span>(term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">estimate_prelim =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(final_model_clean) <span class="sc">%&gt;%</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>      dplyr <span class="sc">::</span> <span class="fu">select</span>(term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">estimate_refit =</span> estimate),</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"term"</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">change_in_estimate =</span> estimate_refit <span class="sc">-</span> estimate_prelim,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_change =</span> (change_in_estimate <span class="sc">/</span> estimate_prelim) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>coef_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term          estimate_prelim estimate_refit change_in_estimate percent_change
  &lt;chr&gt;                   &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;          &lt;dbl&gt;
1 (Intercept)           -1.56          -1.95              -0.392            25.1
2 years_working          0.0514         0.0764             0.0250           48.7
3 phys_activity         -0.187         -0.336             -0.149            79.4
4 obesityobese           2.08           2.95               0.870            41.9
5 phys_activit…         -0.374         -0.561             -0.187            49.9</code></pre>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>After removing influential observations, most model estimates changed substantially.</li>
<li>The effect of years working became stronger, and the impact of physical activity and obesity increased.</li>
<li>The interaction between physical activity and obesity also showed a larger effect.</li>
<li>These shifts suggest that the original model was sensitive to specific data points, and the cleaned model yields more stable and interpretable estimates.</li>
</ul>
</section>
<section id="compare-model-diagnostics-before-and-after-removing-influential-observations" class="level3" data-number="5.8.4">
<h3 data-number="5.8.4" class="anchored" data-anchor-id="compare-model-diagnostics-before-and-after-removing-influential-observations"><span class="header-section-number">5.8.4</span> Compare model diagnostics before and after removing influential observations</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up 2 columns × 4 rows layout</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Prelim Model"</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q Plot</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"Prelim Mode"</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale-Location</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">main =</span> <span class="st">"Prelim Mode"</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's Distance</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Prelim Mode"</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/compare-model-diagnostics-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Diagnostic Plots Before and After Removing Influential Observations</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Leverage</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's distance vs Leverage</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/compare-model-diagnostics-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Diagnostic Plots Before and After Removing Influential Observations</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : The “Refit Model” is a significant improvement over the “Prelim Model.”</p>
<ul>
<li><p><strong>Linearity (Residuals vs Fitted)</strong>: The original model displayed widely scattered residuals (–6 to +4) with distinct striations, though the smoothing line was relatively stable. In the refit model, the striation pattern remains (typical for discrete outcomes), but residuals are more contained (–3 to +3) and the smoothing line remains centered at zero, suggesting tighter model fit.</p></li>
<li><p><strong>Normality (Q-Q Residuals)</strong>: The initial Q-Q plot showed a generally good fit but flagged extreme outliers (e.g., Obs 21, 188, 140). Post-refit, residuals align more closely with the theoretical line, and tail deviations are mitigated, supporting the error distribution assumption.</p></li>
<li><p><strong>Homoscedasticity (Scale-Location)</strong>: The original plot showed a V-shaped pattern with residuals reaching 2.5, indicating non-constant variance. In the refit model, the V-shape persists but residual spread is reduced (max ≈ 1.5), suggesting improved error stability.</p></li>
<li><p><strong>Influential Observations (Cook’s Distance)</strong>: The prelim model flagged Obs 143 and 228 with Cook’s distances near 0.12. In the refit model, the maximum Cook’s distance drops to ≈ 0.06, indicating more stable coefficients and reduced undue influence from outliers.</p></li>
<li><p><strong>Residuals vs Leverage</strong>: The plot shows that most observations have low leverage and standardized residuals close to zero, indicating minimal influence on the model. A few points (e.g., Obs 233, 243) stand out with higher leverage and moderate residuals, suggesting they may exert disproportionate influence on the fitted values. However, the overall pattern remains stable, and the smoothing line does not show concerning curvature, supporting model robustness.</p></li>
<li><p><strong>Cook’s Distance vs Leverage</strong>: This plot confirms that influential observations tend to have both high leverage and large residuals. Points such as 233 and 243 approach the conventional Cook’s distance thresholds (e.g., 0.5–1), but none exceed critical influence levels. The distribution is well-contained, and the model appears resilient to individual data points.</p></li>
</ul>
<section id="residuals-analysis-pearson-residuals-after-removing-influential-observations" class="level4">
<h4 class="anchored" data-anchor-id="residuals-analysis-pearson-residuals-after-removing-influential-observations">Residuals analysis (pearson residuals) after removing influential observations</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Pearson residuals</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(final_model_clean, <span class="at">type =</span> <span class="st">"pearson"</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Depression_files/figure-html/residuals-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : The plot showed a random scatter around zero, suggesting no major issues with model fit or specification.</p>
</section>
</section>
</section>
<section id="calibration-plot-after-removing-influential-observations" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="calibration-plot-after-removing-influential-observations"><span class="header-section-number">5.9</span> Calibration plot after removing influential observations</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted probabilities</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>car.m.prob <span class="ot">&lt;-</span> <span class="fu">augment</span>(final_model_clean, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create calibration plot</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(car.m.prob, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid <span class="sc">+</span> .fitted)) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"dodgerblue4"</span>) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Calibration Plot for Final Model"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Probability"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed Proportion"</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/calibration-plot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Calibration Plot for Final Model</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : This plot checks how well the model’s predictions match real outcomes. The dashed line shows perfect prediction. The red line shows what actually happened. Since the red line is close to the dashed line, the model’s predictions are mostly accurate. But at higher risk levels, the model slightly overestimates the chance of depression.</p>
</section>
</section>
<section id="part-e-results-presentation-and-interpretation" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Part E: Results Presentation and Interpretation</h1>
<section id="final-regression-table" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="final-regression-table"><span class="header-section-number">6.1</span> Final regression table</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Tjur's R²</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>r2_tjur <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">r2_tjur</span>(final_model_clean)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>r2_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Tjur's R² = "</span>, <span class="fu">round</span>(r2_tjur, <span class="dv">3</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the table</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>tbl_final <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  final_model_clean,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    years_working <span class="sc">~</span> <span class="st">"Years Working (years)"</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    phys_activity <span class="sc">~</span> <span class="st">"Physical Activity (score)"</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    obesity <span class="sc">~</span> <span class="st">"Obesity"</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">phys_activity:obesity</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Interaction: Physical Activity × Obesity"</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_source_note</span>(<span class="at">include =</span> <span class="fu">c</span>(AIC, BIC, logLik)) <span class="sc">%&gt;%</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(estimate <span class="sc">~</span> <span class="st">"**Adjusted OR**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_source_note</span>(</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="fu">paste0</span>(<span class="st">"Model fit statistics: AIC, BIC, log-likelihood. "</span>, r2_text)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Render as gt table</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>tbl_final <span class="sc">%&gt;%</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 16: Final Regression Model Results after Removing Influential Observations"</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xyzyiketxj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xyzyiketxj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xyzyiketxj thead, #xyzyiketxj tbody, #xyzyiketxj tfoot, #xyzyiketxj tr, #xyzyiketxj td, #xyzyiketxj th {
  border-style: none;
}

#xyzyiketxj p {
  margin: 0;
  padding: 0;
}

#xyzyiketxj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xyzyiketxj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xyzyiketxj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xyzyiketxj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xyzyiketxj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xyzyiketxj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xyzyiketxj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xyzyiketxj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xyzyiketxj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xyzyiketxj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xyzyiketxj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xyzyiketxj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xyzyiketxj .gt_spanner_row {
  border-bottom-style: hidden;
}

#xyzyiketxj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xyzyiketxj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xyzyiketxj .gt_from_md > :first-child {
  margin-top: 0;
}

#xyzyiketxj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xyzyiketxj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xyzyiketxj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xyzyiketxj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xyzyiketxj .gt_row_group_first td {
  border-top-width: 2px;
}

#xyzyiketxj .gt_row_group_first th {
  border-top-width: 2px;
}

#xyzyiketxj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xyzyiketxj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xyzyiketxj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xyzyiketxj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xyzyiketxj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xyzyiketxj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xyzyiketxj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xyzyiketxj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xyzyiketxj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xyzyiketxj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xyzyiketxj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xyzyiketxj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xyzyiketxj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xyzyiketxj .gt_left {
  text-align: left;
}

#xyzyiketxj .gt_center {
  text-align: center;
}

#xyzyiketxj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xyzyiketxj .gt_font_normal {
  font-weight: normal;
}

#xyzyiketxj .gt_font_bold {
  font-weight: bold;
}

#xyzyiketxj .gt_font_italic {
  font-style: italic;
}

#xyzyiketxj .gt_super {
  font-size: 65%;
}

#xyzyiketxj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xyzyiketxj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xyzyiketxj .gt_indent_1 {
  text-indent: 5px;
}

#xyzyiketxj .gt_indent_2 {
  text-indent: 10px;
}

#xyzyiketxj .gt_indent_3 {
  text-indent: 15px;
}

#xyzyiketxj .gt_indent_4 {
  text-indent: 20px;
}

#xyzyiketxj .gt_indent_5 {
  text-indent: 25px;
}

#xyzyiketxj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xyzyiketxj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 16: Final Regression Model Results after Removing Influential Observations</th>
</tr>
<tr class="gt_col_headings even">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Adjusted OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">(Intercept)</td>
<td class="gt_row gt_center" headers="estimate">0.14</td>
<td class="gt_row gt_center" headers="conf.low">0.03, 0.51</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.005</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Years Working (years)</td>
<td class="gt_row gt_center" headers="estimate">1.08</td>
<td class="gt_row gt_center" headers="conf.low">1.04, 1.13</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Physical Activity (score)</td>
<td class="gt_row gt_center" headers="estimate">0.71</td>
<td class="gt_row gt_center" headers="conf.low">0.56, 0.89</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.004</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Obesity</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="estimate">19.0</td>
<td class="gt_row gt_center" headers="conf.low">3.48, 131</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Interaction: Physical Activity × Obesity</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Physical Activity (score) * obese</td>
<td class="gt_row gt_center" headers="estimate">0.57</td>
<td class="gt_row gt_center" headers="conf.low">0.35, 0.87</td>
<td class="gt_row gt_center" headers="p.value" style="font-weight: bold">0.013</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
<tr class="gt_sourcenotes even">
<td colspan="4" class="gt_sourcenote">AIC = 150; BIC = 166; Log-likelihood = -70.1</td>
</tr>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Model fit statistics: AIC, BIC, log-likelihood. Tjur’s R² = 0.352</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="final-model-equation" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="final-model-equation"><span class="header-section-number">6.2</span> Final model equation</h2>
<p>The final logistic regression model predicting depression status is given by the equation:</p>
<p><span class="math display">\[\text{Odds of Depression} = 0.14 \times 1.08^{(\text{Years})} \times 0.71^{(\text{Activity})} \times 19^{(\text{Obese})} \times 0.57^{(\text{Interaction})}\]</span></p>
<p>Where:</p>
<ul>
<li>Years = Number of years working</li>
<li>Activity = Physical activity score</li>
<li>Obese = 1 if obese, 0 if not obese</li>
<li>Interaction = Physical activity × Obesity interaction term</li>
</ul>
</section>
<section id="interpretation-of-final-model-results" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="interpretation-of-final-model-results"><span class="header-section-number">6.3</span> Interpretation of Final Model Results</h2>
<section id="main-effects-and-interaction-terms" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="main-effects-and-interaction-terms"><span class="header-section-number">6.3.1</span> Main Effects and Interaction Terms</h3>
<p>The final model identifies several statistically significant predictors of depression status:</p>
<ul>
<li><p>Years Working: Each additional year of employment was associated with an 8% increase in the odds of depression (Adjusted OR = 1.08, 95% CI: [1.04, 1.13], p &lt; .001), suggesting that longer work duration may be linked to cumulative stress or burnout.</p></li>
<li><p>Physical Activity: Higher physical activity was protective, reducing the odds of depression by 29% among non‑obese individuals (Adjusted OR = 0.71, 95% CI: [0.56, 0.89], p = .004).</p></li>
<li><p>Obesity: Obese individuals had dramatically higher odds of depression compared to non‑obese peers (Adjusted OR = 19.0, 95% CI: [3.48, 131], p = .001), indicating a strong association between obesity and mental health burden.</p></li>
<li><p>Interaction (Physical Activity × Obesity): The interaction term (OR = 0.57, 95% CI: [0.35, 0.87], p = .013) indicates that physical activity is even more protective among obese individuals. The combined effect yields an OR of approximately 0.40, corresponding to a 60% reduction in odds of depression per unit increase in physical activity among obese individuals. This suggests that physical activity may buffer the elevated risk of depression associated with obesity.</p></li>
</ul>
</section>
<section id="model-comparison" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">6.3.2</span> Model Comparison</h3>
<p>Compared to the preliminary model without interaction terms, the final model shows substantial improvement:</p>
<ul>
<li><strong>Fit Statistics</strong>: AIC dropped from 198.4 to 150.1, and BIC from 214.9 to 166.3, indicating better model parsimony and explanatory power.</li>
<li><strong>Predictive Accuracy</strong>: PCP increased from 0.696 to 0.766, and Tjur’s R² rose from 0.229 to 0.352, reflecting stronger discrimination between depressed and non-depressed cases.</li>
<li><strong>Conclusion</strong>: Including the interaction term significantly improved model fit and interpretability, capturing nuanced relationships between physical activity and obesity.</li>
</ul>
</section>
<section id="practical-significance" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="practical-significance"><span class="header-section-number">6.3.3</span> Practical Significance</h3>
<p>The findings have clear implications:</p>
<ul>
<li><strong>Workplace Mental Health</strong>: The positive association between years working and depression highlights the need for mental health support in long-term employment settings.</li>
<li><strong>Targeted Interventions</strong>: Physical activity emerges as a modifiable protective factor, especially for obese individuals. Tailored exercise programs could be a strategic intervention to reduce depression risk in this subgroup.</li>
<li><strong>Clinical Screening</strong>: The strong effect of obesity on depression odds suggests that clinicians should routinely screen for depressive symptoms in obese patients.</li>
</ul>
</section>
<section id="model-assumptions-and-diagnostics" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="model-assumptions-and-diagnostics"><span class="header-section-number">6.3.4</span> Model Assumptions and Diagnostics</h3>
<p>Model checking revealed:</p>
<ul>
<li><strong>Linearity</strong>: Residuals vs Fitted plots showed improved containment and centering in the refit model, suggesting a better-specified relationship between predictors and log-odds.</li>
<li><strong>Normality</strong>: Q-Q plots indicated that extreme residuals were mitigated post-refit, improving alignment with theoretical quantiles.</li>
<li><strong>Homoscedasticity</strong>: Scale-Location plots showed reduced residual spread (from 2.5 to 1.5), indicating more stable variance across fitted values.</li>
<li><strong>Influential Observations</strong>: Cook’s distance dropped from ~0.12 to ~0.06 after removing influential points, confirming that the final model is more robust and less sensitive to outliers.</li>
</ul>
</section>
</section>
<section id="prediction" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="prediction"><span class="header-section-number">6.4</span> Prediction</h2>
<section id="fitted-probabilities-for-existing-patients" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="fitted-probabilities-for-existing-patients"><span class="header-section-number">6.4.1</span> Fitted probabilities for existing patients</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted value</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>prob_depression <span class="ot">&lt;-</span> <span class="fu">augment</span>(final_model_clean,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">type.predict =</span> <span class="st">'response'</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">type.residuals =</span> <span class="st">'pearson'</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>prob_depression <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d7b46f54f93fa4b97f05" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d7b46f54f93fa4b97f05">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190"],["no","no","no","no","no","no","no","yes","no","no","no","no","no","no","no","no","no","yes","no","yes","yes","no","no","no","yes","no","yes","yes","no","yes","no","yes","no","no","no","no","no","no","yes","yes","no","yes","no","yes","no","yes","no","no","no","yes","no","yes","no","no","no","no","no","no","no","yes","no","no","yes","yes","no","yes","no","no","no","no","no","no","yes","no","no","no","no","no","yes","no","no","yes","no","no","no","no","no","yes","yes","no","no","yes","no","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","no","no","no","no","no","no","no","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","no","yes","no","no","yes","no","no","no","no","yes","no","no","yes","yes","yes","no","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","no","no","no","no","yes","yes","no","yes","no","no","yes","no","no","no","yes","no","no","yes","no"],[8.4,19,5.4,19.5,24,31.4,37.7,13.2,20.7,29.3,31.4,27.2,21.8,35.9,25.7,17.2,30,27.2,0.7,16.3,16,35.2,16.4,8.6,35.4,16.1,38.5,27.3,30.2,5.9,33.4,27.4,1.9,13.7,25.5,3.6,27.9,11.2,34.7,33.4,18.8,11.5,27.8,17.9,15.7,34.6,3.6,30.5,25.2,14,2.3,29.7,9.800000000000001,16.6,23.9,27.1,3.4,19.9,4.5,15.9,5.1,10.6,32,32.5,38.3,36.7,38,12.8,27.9,13.8,25.6,6.7,38.1,3.2,7.9,6.6,8.699999999999999,14.6,12.7,23,37.8,15.8,26.2,36.8,23.1,23.7,17.7,22.9,8.1,22.7,5.3,26.9,4.7,33.2,22.2,19,1.9,30.3,34.3,37.8,11.1,0.5,36.2,0.3,6.6,32.3,4.3,21,36.3,11.2,36,4.3,22.3,3.9,35.7,34.4,25.4,37,1,9.1,15.5,4.4,15.7,39,32.2,21.2,34.2,9.199999999999999,17.6,5.5,34.6,21.1,30.6,32.2,31.7,14,38.3,37.4,19.5,18.4,26.8,12.3,15.8,33.4,38,25.1,16.5,17.9,35.9,31.7,21.1,29,3.2,6.3,26,32.9,33.4,32.3,4.6,10.5,32.9,14.5,36.7,17.2,2.3,38.6,0.1,21.2,1.3,29.6,38.1,20.9,11.4,33.8,33,19,29.2,14.4,39.1,32.1,0.5,32.9,8,23.7,26.8,33.9,6.9,16.3,34.5,32.8],[4.6,7.7,8.9,2.5,1.4,4.2,7.5,1.7,7.6,6.3,1.4,7.5,6.3,8.199999999999999,7.8,7.5,3.2,0.3,4.5,0.6,3.7,7,9.199999999999999,7.6,0.4,1.5,0.6,0.7,7.9,1.6,2.8,5.9,8.5,5.8,5.9,3.6,6.5,5.5,5.6,5.4,4.3,0.9,0.7,5.4,8.9,2.1,8,2.8,9.9,0.7,2.3,2.8,2.2,3.8,5.3,8.699999999999999,8.300000000000001,5.7,4.1,4.9,7.1,2.1,4.6,0.7,9.800000000000001,5.9,7.3,5.5,5.4,7.4,8.4,5.4,1.6,0.3,3.9,0.2,3.4,2.2,4.3,7,6.3,0.2,4.7,7.5,3.4,7.2,9.6,4,2.8,8.199999999999999,8.9,2.6,6.6,4.1,7.4,5.6,2.7,7.6,9.199999999999999,8.300000000000001,8.699999999999999,6.9,3.8,6.5,8.699999999999999,1.1,3.5,5.5,6.9,5.6,8.800000000000001,0.7,5.7,4.6,3.6,2.4,3.6,2.5,0.9,1,6.6,1.3,4.5,6.5,4,5.9,4.4,6.1,3.3,3.2,5,2.4,4.9,0.1,2.6,3.9,2.1,5.2,4.8,6.2,3.3,1.3,5.8,6.7,2.2,9.699999999999999,5.4,4.7,3.4,1.3,7,2.6,2.4,3.3,8.5,6.5,6.3,1.7,8.699999999999999,5.1,5.8,4.2,6.2,6.9,8.699999999999999,5.5,7.3,9.199999999999999,3.3,9.5,4.5,9.300000000000001,8.9,4,3.7,0.3,1.9,1,0.1,0.9,8.699999999999999,0.5,0.2,4.2,1.6,4.2,9.199999999999999,9.6,3.1,3.1],["obese","not obese","obese","obese","not obese","not obese","obese","obese","not obese","not obese","not obese","obese","not obese","not obese","obese","not obese","not obese","obese","not obese","not obese","obese","obese","obese","obese","obese","not obese","not obese","obese","obese","obese","obese","obese","obese","not obese","not obese","obese","not obese","obese","not obese","not obese","obese","obese","not obese","obese","not obese","obese","not obese","not obese","obese","obese","not obese","obese","obese","obese","obese","obese","obese","not obese","obese","not obese","obese","not obese","not obese","obese","obese","obese","obese","not obese","not obese","obese","not obese","not obese","not obese","not obese","obese","not obese","not obese","not obese","not obese","not obese","obese","obese","obese","not obese","not obese","not obese","not obese","obese","obese","not obese","not obese","obese","not obese","not obese","obese","obese","not obese","obese","not obese","not obese","obese","not obese","not obese","not obese","not obese","not obese","not obese","obese","obese","obese","not obese","not obese","not obese","not obese","obese","obese","not obese","not obese","not obese","not obese","obese","not obese","not obese","not obese","obese","obese","obese","not obese","not obese","not obese","obese","obese","obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","obese","obese","obese","obese","obese","obese","not obese","obese","not obese","obese","obese","obese","obese","obese","not obese","not obese","not obese","not obese","obese","obese","obese","not obese","obese","not obese","obese","not obese","obese","not obese","not obese","obese","not obese","not obese","not obese","obese","not obese","not obese","not obese","obese","not obese","obese","not obese","not obese","obese","not obese","not obese","obese","not obese","obese","obese"],[0.07635668494292948,0.04358226939299923,0.001385166291828286,0.5596109663965355,0.3566869134775394,0.2758581600311429,0.05435821867172328,0.6168126233781895,0.05092914980234439,0.138103072618919,0.4939162237484529,0.02512178886632554,0.08285198040820416,0.1229051141889989,0.01725269285956375,0.04074258434658039,0.3238602266293086,0.9427844614684837,0.03193195069904517,0.2871342407308566,0.2488756475669005,0.06922587427928462,0.002449971301430909,0.00565502051818883,0.9657377080838653,0.2267045012410072,0.6871797482917233,0.9206149343147686,0.02213378956875996,0.5019939435756207,0.7373995888048207,0.09906932629115626,0.001517664741222848,0.05441604070886404,0.1205640123575307,0.1232101224032356,0.1186468093306933,0.0436661037239721,0.2344542887246034,0.2287356266731434,0.1932465576012685,0.7434516867483566,0.4839498577344598,0.07692674281078249,0.02311508841981548,0.8522428775780684,0.01254188321741339,0.3627408516929773,0.002560656967482109,0.807597388354047,0.07240856088588854,0.6791303234576738,0.4421585798116981,0.2407627991105913,0.126014991957614,0.008637364453217391,0.002035477519861388,0.08724074879955067,0.08768305071325777,0.08435054026531251,0.006770917222996919,0.1360064201055769,0.2585249863194098,0.9452186033538618,0.007583100685784079,0.182874598786959,0.06575001908338798,0.05608769118132256,0.1630480890326263,0.01002353160231628,0.05628336612395247,0.03712541171783532,0.6035827426827162,0.1406957733972532,0.1297690003776785,0.1800322383489681,0.08085203741515606,0.1712462556784326,0.08109411690676134,0.07258035827766558,0.1453109101346566,0.8829496765482444,0.227490463717079,0.1595953208054802,0.2090738837669736,0.07166288365138028,0.02132637702424923,0.3001513078273821,0.2889095013766385,0.04862273043751395,0.01057583735900059,0.6715689440224649,0.02163380521214359,0.3113183575796745,0.01887431636597662,0.07041942014495428,0.06208086817947388,0.02898860935038691,0.08140217893928541,0.1354482460134094,0.002559070101264279,0.01429641836849671,0.3860525682712116,0.01607579983551998,0.01246828636572672,0.5362436185399568,0.05729010254758399,0.08804735652787056,0.08129652690470481,0.04006873307704209,0.1034789248744189,0.1347186061142966,0.1029917917200908,0.03913635085130727,0.6201999585822836,0.81272708928919,0.2275898785044476,0.5084931584997548,0.1016322815168235,0.1688368982580297,0.02308977687979571,0.1136671775928674,0.09401745461991497,0.2391851420503343,0.4660620340766581,0.06408269314386239,0.415308733384917,0.03557851170297113,0.1522353701798123,0.06861624316334004,0.2994580186298814,0.6110125335360572,0.2562043104149339,0.6162296455645169,0.4002081644895613,0.1003045811635592,0.5665292213832727,0.3009821360241617,0.1114538182864508,0.06720675560634318,0.2661587611708265,0.6826968887853537,0.04723476142363759,0.07820499057103474,0.8724021056459668,0.003039228531309455,0.0696661110092979,0.1029716100361626,0.6648849068594729,0.5080456874238003,0.02469791827298169,0.705941062758757,0.2857378130560705,0.1843909474263949,0.009493834455311646,0.1647563926822002,0.1797779197976213,0.4859129481289491,0.01072026734463364,0.058354048418194,0.1547762387209703,0.1587063066502961,0.2258141143124584,0.02014796337661561,0.009008075656994675,0.2703415151751379,0.01214875208974573,0.003531636017336671,0.04914135749903698,0.05298172720369081,0.4666018789299636,0.02985931721643495,0.01675028418114326,0.3286012722000617,0.5484372687523094,0.3538315908542855,0.4108548154883268,0.2334525272008875,0.9799791390320326,0.5491271283631134,0.00114009948304687,0.5969247388497493,0.1963674393546103,0.2758962173848583,0.3910212438562644,0.315598366775894,0.001187016430930946,0.01920433564489246,0.7000123357336867,0.6720472168226801],[-0.2875222026746796,-0.2134671791031853,-0.03724362547966376,-1.127261982315588,-0.7446160530097805,-0.6172073610542401,-0.239755888262258,0.7881864604281368,-0.2316508487643267,-0.4002893212705847,-0.9879055795853098,-0.1605277426702673,-0.3005603796236676,-0.3743360798245929,-0.1324974482093824,-0.2060898978745279,-0.6920867995911761,0.2463489905166103,-0.1816183733838037,1.575655917772978,1.737259598108928,-0.2727169138722633,-0.04955792976440566,-0.07541340495623979,0.1883556321685914,-0.5414487188905485,0.6747023993183717,0.2936502644848001,-0.1504486061574279,0.9960200328550186,-1.675728842056136,3.015616298740121,-0.03898681249409334,-0.2398907054535365,-0.3702599427482571,-0.3748654637696528,-0.366904502487967,-0.2136817572082678,1.806993012610172,1.836262345584232,-0.489424233766743,0.5874328189881185,-0.9683987768004412,3.464012196067047,-0.1538247006585474,0.4163825514823594,-0.1126995116797522,-0.7544669063223713,-0.05066784744615858,0.4880991242916702,-0.2793936890863291,0.6873655738779986,-0.8902944158832024,-0.5631264832120227,-0.3797161916861435,-0.09334140836022589,-0.04516225347702357,-0.3091587698529052,-0.3100166036582697,3.294736502185824,-0.08256558044382722,-0.3967568623134138,1.693546003971374,0.2407411993789414,-0.08741306245577522,2.113818343988948,-0.2652872591457289,-0.2437630957596848,-0.4413748712741418,-0.1006231586707081,-0.2442132519053447,-0.1963589841938413,0.8104157433396173,-0.4046383597960128,-0.3861608170644147,-0.4685724513901459,-0.2965874497708222,-0.4545668808357541,3.366207176950603,-0.2797508463277235,-0.412330092407789,0.3640980333865745,-0.5426623276739212,-0.4357785466375262,-0.5141406418021818,-0.2778396880070843,-0.1476180960702461,1.526975108753238,1.568850373747889,-0.2260701831400758,-0.1033870457476277,0.6993213803147913,-0.148701633193334,1.487328459120451,-0.1386989881558563,-0.2752343925558316,-0.2572741745689911,-0.1727832062082416,-0.2976838744742895,-0.3958140395938982,-0.0506521050202742,-0.1204316002432804,-0.7929715927559875,-0.1278219603367137,-0.1123641726704374,-1.075316027894154,-0.2465192095070015,3.218310798948438,-0.2974735231455949,-0.2043067599676587,-0.3397392332340825,-0.3945800356803014,-0.3388465733942412,-0.2018177139693487,-1.277874966944871,0.480026388486917,-0.5428158169716247,-1.017133066812909,-0.3363479372755668,-0.4507031101052013,-0.1537384651376837,-0.3581122045043533,-0.3221397588533079,-0.5606961918117219,-0.9342787301735508,-0.2616686166468862,-0.8427955395230766,-0.1920704037622548,-0.4237601730214161,-0.2714245573545853,-0.6538089934193245,-1.253306394121357,-0.5869030783640637,0.7891588256432946,1.224213890077088,-0.3338970867469899,0.8747193930006337,-0.656184885512306,-0.3541664948288435,3.725514266691714,-0.6022396241875281,-1.46681991117074,-0.2226577987717903,-0.2912728852027223,0.3824400807766272,-0.05521316509706901,-0.2736474233197931,2.951510567193256,0.7099434504124048,0.9840360327789353,-0.1591331277891755,0.6454059568392503,-0.6324919881775979,-0.4754761956258944,-0.09790215143980936,-0.4441345480438579,-0.4681687779538676,-0.9722118340745151,-0.1040982076919279,-0.2489382739089929,-0.4279236561016176,-0.434333448220562,-0.5400735609733431,-0.1433954352612311,-0.09534127486360104,-0.6086905414955166,-0.1108970665942245,-0.05953278655138808,-0.2273346292352491,-0.2365287173378987,1.069184118322787,-0.175437559704043,-0.1305206340931504,-0.6995912407655634,-1.102057955780088,1.351370886373842,1.197476433909163,-0.5518610739285291,0.142933148192379,-1.103594169027963,-0.03378462362527501,0.8217378339797354,-0.4943174890192704,-0.6172661549654527,-0.8013073107326883,1.472611355624817,-0.03447357123132974,-0.1399298521329169,0.6546344430660201,-1.431509495011811],[0.01920601571135778,0.01581171736699399,0.002071439035766747,0.03731464737008004,0.0305897881701338,0.01990196420965716,0.03356689067600098,0.06064157868706932,0.01709561322206326,0.0235494539451158,0.03832110898738074,0.01602987171324271,0.01626785731831085,0.04485189441075389,0.01277555550820736,0.01452979166833672,0.01927598937808892,0.02979627244579713,0.01203643772576944,0.04301905738909968,0.02468160477444821,0.03333836330400908,0.003401064643435787,0.005185833817520569,0.02079223712806341,0.02789177807903782,0.0592009976961379,0.03325479725421246,0.0165339837741767,0.08301025102779827,0.03531966262189287,0.02583010021602527,0.002155229344959757,0.01260270654706896,0.01799039547975247,0.03035225232629435,0.02235301844557877,0.01470950176732657,0.03047185439180257,0.02675588913041734,0.02158564345496948,0.0745550700969847,0.04583317537771619,0.01838387797802533,0.01318850180408653,0.0342548381621472,0.008119818779003566,0.02199424553019361,0.004057198715801655,0.0651376677108761,0.02154469612219448,0.03326249666117258,0.05668195423884222,0.02381311608845675,0.0230697212052654,0.00905210137339278,0.002641111039006611,0.01432556918071029,0.02339157195799067,0.01279027650846142,0.005651758359358165,0.022545425558056,0.02150600502376783,0.02642354992414243,0.01109324215229785,0.04680548755386287,0.03698994463400908,0.01242606295087746,0.01862118317399733,0.007569000893380034,0.02293850134143648,0.01146229048346411,0.04787104658135003,0.04716497015905905,0.02548385565464861,0.05056806873015168,0.01549135832486739,0.02078308052700958,0.01306334759916148,0.01838529649843386,0.04790796818505343,0.0546666170738544,0.02532712368531011,0.04549457847157684,0.0138598752793284,0.01935556812709229,0.0141706682092364,0.02302784390509916,0.04383245762697118,0.01932034223060213,0.007926993773671056,0.03381413535218856,0.009759627560209285,0.02289234250627198,0.01220371235179216,0.01835041595875492,0.01892274976631297,0.01894215446028744,0.04118911263780404,0.05163456562743222,0.003265492480969628,0.008264695746695892,0.02962212903828308,0.008668971127160374,0.008598164001346786,0.04420323883179494,0.01531560508787329,0.0201313837562586,0.03722667820003719,0.01420499538265761,0.04621786853983339,0.04018803180884516,0.01537556849403081,0.01228904402184013,0.03826215113089381,0.03530796788842401,0.01426912740936316,0.03720679416389749,0.03598881625096518,0.03585230830598988,0.0116911215013111,0.03139584818113373,0.01279951881047783,0.04796636692131234,0.03265574132251673,0.0188767837820519,0.03765524782857723,0.01140092279018364,0.0141919615295041,0.0164997803591071,0.0408553727782382,0.03761029797613877,0.03181729292416973,0.06094278985846018,0.02527137524474947,0.01348700360226763,0.04359218357532912,0.03571287491046999,0.01308912610740024,0.01434983177253894,0.01574797101008455,0.06893746186062678,0.01553509690493214,0.03206500856557144,0.03381322415803227,0.004532412585179188,0.01761679515202567,0.01286126222377454,0.03811380769362451,0.04025516913959389,0.01344169899278848,0.03415042232790507,0.06093579644250419,0.03474679739734584,0.009312579866412807,0.03070418227069536,0.03087272980256453,0.03563020757818129,0.007846195490392347,0.01656569741207238,0.03653804770945604,0.02198066113033258,0.03877558717944421,0.01130741012675119,0.007068613000635207,0.0542953978319294,0.007727294329176022,0.004642315827627865,0.01589841540851484,0.02973598322080187,0.04815227762571366,0.01728986408236648,0.01061536666275645,0.02404411241342174,0.03386860934811356,0.04995881084445196,0.02846894850893797,0.03553760808904259,0.01529053087475014,0.04711418105797707,0.001762250955879311,0.05469267125470724,0.05095136367000457,0.02313277001371204,0.02973705247392987,0.02433902399079352,0.001889035666157606,0.0130925410016237,0.03608250615896067,0.03439631161796269],[0.8721275722538059,0.8723500650156454,0.872623442771251,0.8673102997777907,0.8697934504170808,0.8705786478734773,0.8722718350944005,0.8694225965042984,0.8723008176852491,0.8716836469926372,0.8682102477611288,0.872471039091254,0.8720843739759667,0.8717765764190321,0.8725222959645051,0.8723691741919913,0.8701432629041642,0.872253801565376,0.8724274894291741,0.8644732312539526,0.8637052705256034,0.8721697713783032,0.8726167640790435,0.8725965891156739,0.8724103269666367,0.8709834042567757,0.8701450162681493,0.8720990685077219,0.87249034003978,0.8679387689166105,0.8639564285872277,0.8577241535350894,0.8726226138469417,0.8722790997160715,0.8718169106120173,0.8717871394577823,0.8718271568375399,0.872349826294935,0.8632641532471464,0.8631403699180416,0.8712641254848712,0.8706347564870994,0.8683032811692042,0.8562039913350125,0.8724844829964309,0.8716004028750615,0.8725528412483748,0.8697580311801175,0.8726160600664955,0.8712073210701683,0.8721535313375119,0.8701357163477135,0.8687699340721458,0.8708730175188687,0.871772994520285,0.8725775708774094,0.8726193699368745,0.8720551257563641,0.8720466748242159,0.8568900518872142,0.8725895391224237,0.8717001194013165,0.8639789653466764,0.8722716144013338,0.8725841526665427,0.8614598525844865,0.8721921365051563,0.8722679996500837,0.8715018084499876,0.8725688708975825,0.8722627593594977,0.8723937093067878,0.8693233678924791,0.8716404132025558,0.8717433278307696,0.8713290746714273,0.8720985942444793,0.8714366206033546,0.8566326050953976,0.8721538962080271,0.8716043708111424,0.8718115635446677,0.8709812364089741,0.8714968627219808,0.8711495132855412,0.8721597061145899,0.8724958949014333,0.8649261581338339,0.8645067832900912,0.8723154864978578,0.872565344474033,0.8700619070754669,0.8724945253499132,0.8651621099029757,0.8725119457717552,0.8721686869101085,0.8722251353567223,0.8724453255983762,0.872080399625247,0.8716757631949155,0.872616082743096,0.8725416603445411,0.8694953856628533,0.8725302708674864,0.8725532712440878,0.8676107283759676,0.8722588654124293,0.8570486553913645,0.8720834153543393,0.8723736986591013,0.8719185258871984,0.8716926542359122,0.8719443251751249,0.8723803233417747,0.866340108297714,0.8712923533132531,0.8709989585223133,0.868025338977185,0.8719394048891187,0.8714367009837372,0.8724848699647739,0.8718558981293861,0.8720089718364349,0.8708419507467127,0.8685828343020641,0.8722115851106608,0.8691519627801729,0.8724038396873537,0.8715880876092967,0.872181837310677,0.8703180459135266,0.8665001755644189,0.8707260024387158,0.8694152705680036,0.8667610225551021,0.8719645414331639,0.8689239788071103,0.8703162986148421,0.8718860554192511,0.8554015904883062,0.8706717106869727,0.864919528925488,0.8723259301159462,0.8721079713828433,0.8717517401642783,0.8726130498142852,0.8721741712464621,0.8581695794035651,0.869985440771364,0.8682265499455502,0.8724742063535983,0.8703837667239405,0.8703974725505168,0.871316006990359,0.8725721226605029,0.8714745638809198,0.8713575708173847,0.8683244568534797,0.8725644334533093,0.8722512363684362,0.8715444313140956,0.8715309150366842,0.8709721888155229,0.872503870843648,0.8725753337105143,0.8705539777022849,0.8725553711679238,0.8726099564487837,0.8723131354549579,0.8722825982625472,0.8676300910274934,0.8724399529249417,0.8725257533952985,0.870086051730675,0.8674918308839517,0.8657945293130218,0.8669110700208521,0.8709136141787316,0.8725041726355213,0.8674101112618915,0.872624976376464,0.8692260832659341,0.8711962861318323,0.870571512581674,0.8694426640894697,0.865238896263684,0.8726246823755456,0.8725097142015061,0.8703246193822078,0.8654113328715755],[0.0003301067936832723,0.0001487698346101061,5.770416333612819e-07,0.0102327020829678,0.003609575035530484,0.001578516380090778,0.0004131769385901532,0.008538778906911296,0.0001899152869932252,0.0007915135253654518,0.008087955896145586,8.532895195570733e-05,0.0003037176897943208,0.001377820763954957,4.602491728871035e-05,0.0001270912911040419,0.001919880464797813,0.000384209083720739,8.135152106530836e-05,0.02332421719988428,0.01566173957095358,0.0005307004443790035,1.682016904260259e-06,5.960212841761813e-06,0.0001538646103766567,0.001730579779596905,0.006089614970332478,0.0006136504279389731,7.738648573670531e-05,0.01958704442267231,0.02131509036913095,0.04950383422696296,6.580107285386497e-07,0.0001487773427944015,0.0005115083110748319,0.0009072851348005462,0.0006296629318052085,0.0001383675534595431,0.02117000613936638,0.01904913553073471,0.001080240114928998,0.006007896330811652,0.009442125787100932,0.04578704162944006,6.409279538896447e-05,0.001273537911001445,2.096534316552508e-05,0.002617801027967187,2.100160035196942e-06,0.003551263797957359,0.0003513351237155465,0.003363126941835687,0.01009777813647076,0.001584864701895394,0.0006970492020282984,1.606299267023954e-05,1.083090978979138e-06,0.000281862981537381,0.0004714312596242712,0.02849262455392828,7.793537646198598e-06,0.0007429236096848733,0.01288449513900324,0.0003231334209427271,1.733526443580426e-05,0.04603615325241023,0.0005614160428516034,0.0001514119729770949,0.0007533193392515299,1.556194234814736e-05,0.0002866089110695959,9.045164669963546e-05,0.006936287927743208,0.00170117202634776,0.0008003011944320865,0.002463384469272956,0.000281180998946968,0.0008957311532389169,0.03039398229051781,0.0002986491904675603,0.001797090506091501,0.00162188057440662,0.001570208965182133,0.001896551037564435,0.0007534872858237569,0.0003107429975075187,6.354714637445794e-05,0.01125078473063714,0.02360048205713337,0.0002053416508834385,1.721803151282501e-05,0.003542913390068776,4.401629258157712e-05,0.01060838256289028,4.812090256732949e-05,0.0002885149602888518,0.0002602556812033265,0.000117509558941275,0.0007940669799246594,0.001798877043849187,1.686610085562902e-06,2.437509026772048e-05,0.003956213822764112,2.882511840784756e-05,2.208981096956309e-05,0.0111898745262026,0.0001919868917114534,0.04343340646334636,0.0007107761059471729,0.0001220290806595698,0.001172824282989943,0.001358390471478869,0.0003641884420525198,0.0001026140711777493,0.01351022829593877,0.001748459433786745,0.0008653975913528256,0.008305040607013994,0.0008762155380896523,0.001566899335347851,5.658037972237091e-05,0.0008583171842964936,0.0002725847657886406,0.00332749530459242,0.00609228693578286,0.0002685432056804118,0.005776151798643443,8.606974125583387e-05,0.0005244788565899485,0.0002513376283399195,0.003796756601961502,0.01275702322446122,0.002338359896405336,0.008607896963383533,0.007972711285799463,0.0003090047153743095,0.007292725991516922,0.003307459364833143,0.00033713180515444,0.04100187019068965,0.001179181393119505,0.03422009198355236,0.0001589349132327343,0.0005807230857636384,0.001059549384913273,2.788627284415223e-06,0.0002733869427332583,0.02299566024804613,0.004152527017944474,0.008463735657575315,6.994551129561387e-05,0.00304981169111146,0.005528686611042323,0.00168624173301021,1.818909875217009e-05,0.001289270268531595,0.001440947950763319,0.007242407514978437,1.727498266668808e-05,0.0002122913811844628,0.00144158012981641,0.0008670066199912999,0.00244818723043436,4.757088543429728e-05,1.30342975862627e-05,0.00449857656850197,1.930347406617602e-05,3.321381435141016e-06,0.0001696817619204553,0.0003534273880908297,0.01215113589977157,0.0001102086948994072,3.694817769834115e-05,0.002470967852479555,0.008813813214990668,0.02021651701336019,0.008650117397242058,0.002327057517400219,6.443209463952995e-05,0.01263917447789941,4.037085456905941e-07,0.008265700161239568,0.002764526905165388,0.001847274706722282,0.004056460312639133,0.01108949004354156,4.506973994145212e-07,5.264072063393072e-05,0.003328470168332711,0.0151193285474133],[-0.2903237000625102,-0.2151751012418351,-0.03728225946081384,-1.148901187587324,-0.7562730068559311,-0.6234424035606564,-0.243884040731938,0.8132298357610329,-0.2336567109602079,-0.4050875334955767,-1.007396404827617,-0.1618300400600077,-0.3030353544857129,-0.3830243009537509,-0.133352009354991,-0.2076036353524199,-0.6988551370027358,0.250103239792057,-0.1827213595705748,1.610681758765846,1.759103983494298,-0.2773798008377772,-0.04964242020504189,-0.07560970948189161,0.1903448745676914,-0.5491614237639036,0.6956068186040767,0.2986581588854682,-0.1517080023891252,1.040125713839332,-1.706129653614135,3.05533425133259,-0.03902889328782112,-0.2414167812953502,-0.3736361272351481,-0.3806873400371003,-0.3710752676605151,-0.2152708864246396,1.835169837261951,1.861331968422808,-0.4947935860366173,0.6106367191857942,-0.9913843890279905,3.496299041231599,-0.1548492042921063,0.4237027195555786,-0.1131598668908129,-0.7629032934013945,-0.05077094603383114,0.5048172628961465,-0.2824529378099271,0.6990906499649664,-0.9166521852065478,-0.5699535566768259,-0.384173435553506,-0.09376676628119149,-0.0452220111361726,-0.3113972874744433,-0.3137073688180855,3.316011097519554,-0.08279989448241702,-0.40130646418482,1.712055803172457,0.2439862711767255,-0.08790198114175515,2.165094694154464,-0.2703341938001971,-0.2452918658367865,-0.445542630060805,-0.1010061425401127,-0.2470633219785489,-0.1974941138158033,0.830538909310676,-0.4145321262711199,-0.3911773367763284,-0.4808889909037017,-0.2989117611909085,-0.4593654587096201,3.388411933904793,-0.2823585100609446,-0.4225767183145752,0.3744775923423205,-0.5496677199172461,-0.4460429160375912,-0.5177410740735641,-0.2805682344513009,-0.1486752685944845,1.544866175379671,1.60440692152765,-0.2282862229845644,-0.1037992723955385,0.7114534117924831,-0.1494326244973361,1.50465065862104,-0.1395531352568971,-0.27779502119254,-0.2597434417661377,-0.1744432707822975,-0.3040106732505578,-0.4064464515591252,-0.05073501015423115,-0.1209323716999365,-0.8049838871989821,-0.1283796312339445,-0.1128503730417951,-1.099900354121307,-0.248428970004379,3.251202786366622,-0.3031700485462685,-0.2057734930916608,-0.347873311452279,-0.4027560076739751,-0.3414819826720056,-0.203069335162926,-1.303046783749412,0.4887319900160153,-0.5467305156737483,-1.036600144200918,-0.3425687417147019,-0.459006432792574,-0.1546451102396484,-0.3638697554845732,-0.3242213800689657,-0.5746474194944099,-0.9499175962168663,-0.2641738723003249,-0.8591260491312344,-0.193174745593987,-0.42679955670468,-0.2736918767492273,-0.6675884910288605,-1.277561370910995,-0.5964687933717159,0.8143636722182589,1.239982176562859,-0.3361717572557986,0.894431728640061,-0.6682254906737135,-0.356507364975198,3.752535683052057,-0.6070384035093332,-1.520153242372223,-0.2244077195055231,-0.2960581102242265,0.3890745794892114,-0.05533871646877328,-0.2760901410669919,2.970675708220504,0.7238722226969139,1.004461072686712,-0.1602135418243429,0.6567169449563376,-0.6526906415404145,-0.483958535179023,-0.09836122108397231,-0.4511140855284548,-0.4755673605504451,-0.9900089118153442,-0.1045090141736574,-0.2510261686533729,-0.4359623762237474,-0.4391870791013338,-0.5508590908096849,-0.144213091511731,-0.09568003714736514,-0.6259199614377976,-0.1113280329989096,-0.0596714545426941,-0.2291635968111846,-0.2401258493198005,1.095894535996036,-0.1769741601551739,-0.1312189609785903,-0.7081565379732249,-1.12120838651426,1.386447219283376,1.214894685979046,-0.5619363328832551,0.1440386035780692,-1.130547893955909,-0.03381443152044835,0.8451752495736382,-0.5074131772013222,-0.6245319981351891,-0.8134940515645901,1.490866230790608,-0.034506178338398,-0.1408549648295841,0.6667744050001305,-1.456782698745829]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>depression<\/th>\n      <th>years_working<\/th>\n      <th>phys_activity<\/th>\n      <th>obesity<\/th>\n      <th>.fitted<\/th>\n      <th>.resid<\/th>\n      <th>.hat<\/th>\n      <th>.sigma<\/th>\n      <th>.cooksd<\/th>\n      <th>.std.resid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"depression","targets":1},{"name":"years_working","targets":2},{"name":"phys_activity","targets":3},{"name":"obesity","targets":4},{"name":".fitted","targets":5},{"name":".resid","targets":6},{"name":".hat","targets":7},{"name":".sigma","targets":8},{"name":".cooksd","targets":9},{"name":".std.resid","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="predicted-probabilities-for-new-patients" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="predicted-probabilities-for-new-patients"><span class="header-section-number">6.4.2</span> Predicted probabilities for new patients</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new data for prediction</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>new_depression <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>),        <span class="co"># range of years working</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="fl">7.5</span>, <span class="dv">10</span>),       <span class="co"># range of physical activity</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>)            <span class="co"># obesity categories</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add log-odds and predicted probabilities</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>new_depression<span class="sc">$</span>predicted_odds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_clean,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">newdata =</span> new_depression,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>new_depression<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_clean,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newdata =</span> new_depression,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>new_depression <span class="sc">%&gt;%</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 17: Predicted Odds and Probabilities for New Patients"</span>,</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">vars</span>(predicted_odds, predicted_prob),</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="idsrqcpclr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#idsrqcpclr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#idsrqcpclr thead, #idsrqcpclr tbody, #idsrqcpclr tfoot, #idsrqcpclr tr, #idsrqcpclr td, #idsrqcpclr th {
  border-style: none;
}

#idsrqcpclr p {
  margin: 0;
  padding: 0;
}

#idsrqcpclr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#idsrqcpclr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#idsrqcpclr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#idsrqcpclr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#idsrqcpclr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#idsrqcpclr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idsrqcpclr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#idsrqcpclr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#idsrqcpclr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#idsrqcpclr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#idsrqcpclr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#idsrqcpclr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#idsrqcpclr .gt_spanner_row {
  border-bottom-style: hidden;
}

#idsrqcpclr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#idsrqcpclr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#idsrqcpclr .gt_from_md > :first-child {
  margin-top: 0;
}

#idsrqcpclr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#idsrqcpclr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#idsrqcpclr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#idsrqcpclr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#idsrqcpclr .gt_row_group_first td {
  border-top-width: 2px;
}

#idsrqcpclr .gt_row_group_first th {
  border-top-width: 2px;
}

#idsrqcpclr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#idsrqcpclr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#idsrqcpclr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#idsrqcpclr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idsrqcpclr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#idsrqcpclr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#idsrqcpclr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#idsrqcpclr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#idsrqcpclr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idsrqcpclr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#idsrqcpclr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#idsrqcpclr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#idsrqcpclr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#idsrqcpclr .gt_left {
  text-align: left;
}

#idsrqcpclr .gt_center {
  text-align: center;
}

#idsrqcpclr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#idsrqcpclr .gt_font_normal {
  font-weight: normal;
}

#idsrqcpclr .gt_font_bold {
  font-weight: bold;
}

#idsrqcpclr .gt_font_italic {
  font-style: italic;
}

#idsrqcpclr .gt_super {
  font-size: 65%;
}

#idsrqcpclr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#idsrqcpclr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#idsrqcpclr .gt_indent_1 {
  text-indent: 5px;
}

#idsrqcpclr .gt_indent_2 {
  text-indent: 10px;
}

#idsrqcpclr .gt_indent_3 {
  text-indent: 15px;
}

#idsrqcpclr .gt_indent_4 {
  text-indent: 20px;
}

#idsrqcpclr .gt_indent_5 {
  text-indent: 25px;
}

#idsrqcpclr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#idsrqcpclr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 17: Predicted Odds and Probabilities for New Patients</th>
</tr>
<tr class="gt_col_headings even">
<th id="years_working" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">years_working</th>
<th id="phys_activity" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">phys_activity</th>
<th id="obesity" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">obesity</th>
<th id="predicted_odds" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">predicted_odds</th>
<th id="predicted_prob" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">predicted_prob</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.953</td>
<td class="gt_row gt_right" headers="predicted_prob">0.124</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.189</td>
<td class="gt_row gt_right" headers="predicted_prob">0.233</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−0.425</td>
<td class="gt_row gt_right" headers="predicted_prob">0.395</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">0.339</td>
<td class="gt_row gt_right" headers="predicted_prob">0.584</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">1.103</td>
<td class="gt_row gt_right" headers="predicted_prob">0.751</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.793</td>
<td class="gt_row gt_right" headers="predicted_prob">0.058</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.029</td>
<td class="gt_row gt_right" headers="predicted_prob">0.116</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.265</td>
<td class="gt_row gt_right" headers="predicted_prob">0.220</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−0.501</td>
<td class="gt_row gt_right" headers="predicted_prob">0.377</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">0.263</td>
<td class="gt_row gt_right" headers="predicted_prob">0.565</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−3.633</td>
<td class="gt_row gt_right" headers="predicted_prob">0.026</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.869</td>
<td class="gt_row gt_right" headers="predicted_prob">0.054</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.105</td>
<td class="gt_row gt_right" headers="predicted_prob">0.109</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.341</td>
<td class="gt_row gt_right" headers="predicted_prob">0.207</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−0.577</td>
<td class="gt_row gt_right" headers="predicted_prob">0.360</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−4.473</td>
<td class="gt_row gt_right" headers="predicted_prob">0.011</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−3.709</td>
<td class="gt_row gt_right" headers="predicted_prob">0.024</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.945</td>
<td class="gt_row gt_right" headers="predicted_prob">0.050</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.181</td>
<td class="gt_row gt_right" headers="predicted_prob">0.101</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.417</td>
<td class="gt_row gt_right" headers="predicted_prob">0.195</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−5.313</td>
<td class="gt_row gt_right" headers="predicted_prob">0.005</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−4.549</td>
<td class="gt_row gt_right" headers="predicted_prob">0.010</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−3.785</td>
<td class="gt_row gt_right" headers="predicted_prob">0.022</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−3.021</td>
<td class="gt_row gt_right" headers="predicted_prob">0.046</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">not obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.257</td>
<td class="gt_row gt_right" headers="predicted_prob">0.095</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">0.993</td>
<td class="gt_row gt_right" headers="predicted_prob">0.730</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">1.757</td>
<td class="gt_row gt_right" headers="predicted_prob">0.853</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">2.521</td>
<td class="gt_row gt_right" headers="predicted_prob">0.926</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">3.285</td>
<td class="gt_row gt_right" headers="predicted_prob">0.964</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">0.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">4.049</td>
<td class="gt_row gt_right" headers="predicted_prob">0.983</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.250</td>
<td class="gt_row gt_right" headers="predicted_prob">0.223</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−0.486</td>
<td class="gt_row gt_right" headers="predicted_prob">0.381</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">0.278</td>
<td class="gt_row gt_right" headers="predicted_prob">0.569</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">1.042</td>
<td class="gt_row gt_right" headers="predicted_prob">0.739</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">2.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">1.806</td>
<td class="gt_row gt_right" headers="predicted_prob">0.859</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−3.494</td>
<td class="gt_row gt_right" headers="predicted_prob">0.029</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.730</td>
<td class="gt_row gt_right" headers="predicted_prob">0.061</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.965</td>
<td class="gt_row gt_right" headers="predicted_prob">0.123</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−1.201</td>
<td class="gt_row gt_right" headers="predicted_prob">0.231</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">5.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−0.437</td>
<td class="gt_row gt_right" headers="predicted_prob">0.392</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−5.737</td>
<td class="gt_row gt_right" headers="predicted_prob">0.003</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−4.973</td>
<td class="gt_row gt_right" headers="predicted_prob">0.007</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−4.209</td>
<td class="gt_row gt_right" headers="predicted_prob">0.015</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−3.445</td>
<td class="gt_row gt_right" headers="predicted_prob">0.031</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">7.5</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−2.681</td>
<td class="gt_row gt_right" headers="predicted_prob">0.064</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">0</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−7.980</td>
<td class="gt_row gt_right" headers="predicted_prob">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">10</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−7.216</td>
<td class="gt_row gt_right" headers="predicted_prob">0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">20</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−6.452</td>
<td class="gt_row gt_right" headers="predicted_prob">0.002</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="years_working">30</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−5.688</td>
<td class="gt_row gt_right" headers="predicted_prob">0.003</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="years_working">40</td>
<td class="gt_row gt_right" headers="phys_activity">10.0</td>
<td class="gt_row gt_center" headers="obesity">obese</td>
<td class="gt_row gt_right" headers="predicted_odds">−4.924</td>
<td class="gt_row gt_right" headers="predicted_prob">0.007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="prediction-plot-with-confidence-intervals-interaction-plot" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="prediction-plot-with-confidence-intervals-interaction-plot"><span class="header-section-number">6.4.3</span> Prediction plot with confidence intervals (Interaction plot)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions with standard errors</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_clean, <span class="at">newdata =</span> new_depression, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build dataframe with CI on probability scale</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> new_depression <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_link =</span> pred<span class="sc">$</span>fit,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_link  =</span> pred<span class="sc">$</span>se.fit,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_link =</span> fit_link <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_link,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_link =</span> fit_link <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se_link,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fitted =</span> <span class="fu">plogis</span>(fit_link),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.lower  =</span> <span class="fu">plogis</span>(lower_link),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.upper  =</span> <span class="fu">plogis</span>(upper_link)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with ribbons</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> .fitted, <span class="at">color =</span> obesity, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Probability of Depression by Physical Activity and Obesity Status"</span>,</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model Predictions with 95% Confidence Intervals"</span>,</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Probability of Depression"</span>,</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical Activity Score (0–10)"</span>,</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Obesity Status"</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/prediction-plot-with-ci-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Predicted Probability of Depression by Physical Activity and Obesity Status with 95% Confidence Intervals</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> :</p>
<ul>
<li>As physical activity increases, the chance of being depressed goes down for both obese and non-obese individuals. The drop is steeper for obese people, meaning physical activity helps them even more. At high activity levels, both groups have similarly low depression risk.</li>
<li>This suggests that encouraging physical activity is especially important for obese individuals to reduce depression risk.</li>
</ul>
</section>
<section id="heatmap-of-predicted-probabilities" class="level3" data-number="6.4.4">
<h3 data-number="6.4.4" class="anchored" data-anchor-id="heatmap-of-predicted-probabilities"><span class="header-section-number">6.4.4</span> Heatmap of predicted probabilities</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a discrete prediction grid for representative values</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>),</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="fl">7.5</span>, <span class="dv">10</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>) </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Generate predictions from your fitted model</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>predicted_heatmap <span class="ot">&lt;-</span> <span class="fu">augment</span>(</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  final_model_clean,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> heatmap_data,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.predict =</span> <span class="st">"response"</span>,   <span class="co"># predicted probabilities</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">se_fit =</span> <span class="cn">TRUE</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot as a heatmap (probability blocks)</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_heatmap, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> years_working, <span class="at">fill =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(.fitted, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> obesity) <span class="sc">+</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"skyblue"</span>, <span class="at">high =</span> <span class="st">"firebrick"</span>, <span class="at">name =</span> <span class="st">"Predicted Probability"</span>) <span class="sc">+</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Probability of Depression"</span>,</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Across Physical Activity, Years Working, and Obesity Status"</span>,</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical Activity Score (0–10)"</span>,</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Years Working"</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Depression_files/figure-html/heatmap-predicted-probabilities-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Heatmap of Predicted Probability of Depression by Physical Activity and Years Working</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Interpretation</em> : People who are obese and have worked longer tend to have a higher chance of depression, especially if they are not physically active. More physical activity lowers the risk of depression for everyone, but the benefit is even greater for obese individuals.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
<p>The final model offers a statistically sound and practically meaningful framework for understanding depression risk. By addressing influential observations and incorporating interaction effects, it achieves better fit, clearer interpretation, and stronger predictive performance. These results support targeted mental health strategies that consider both behavioral and physiological risk factors.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Logistic Regression Analysis of Depression Data"</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Munir (23202537), Farihah (23202679), Sanggary (23202894), Khairunnisa (23202532) "</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Logistic Regression, Medical Statistics]</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> [R, Logistic Regression, Medical Statistics]</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cerulean</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: 1</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true     </span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show code" </span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 3 </span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="co">  comment: NA</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research Question / Objective</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>To study the association between physical activity, obesity, years of working, and the presence of depression among adults. </span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>Specifically, we aim to:</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="ss">1.   </span>Assess the individual effects of physical activity, obesity, and years of working on depression risk.</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="ss">2.   </span>Investigate potential interaction effects between physical activity and obesity on depression.</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="ss">3.   </span>Control for confounding factors and evaluate model fit and assumptions.</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part A: Dataset and variable creation</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-data</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.helpers)</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3030</span>)</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>years_working <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">40</span>), <span class="dv">1</span>)</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>phys_activity <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">1</span>)</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>phys_c <span class="ot">&lt;-</span> phys_activity <span class="sc">-</span> <span class="fu">mean</span>(phys_activity)</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a><span class="co"># More balanced obesity prevalence</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>obesity <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.45</span>)</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients tuned for moderate ORs</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">0.06</span></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.30</span></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># obesity OR ≈ 1.65</span></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.20</span>  <span class="co"># weaker interaction</span></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Calibrate intercept for ~25% prevalence</span></span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>mean_prev <span class="ot">&lt;-</span> <span class="cf">function</span>(b0){</span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>  lp <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity</span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">plogis</span>(lp))</span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(x) <span class="fu">mean_prev</span>(x) <span class="sc">-</span> <span class="fl">0.25</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>linpred <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(linpred)</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, <span class="fl">0.05</span>), <span class="fl">0.95</span>)   <span class="co"># clamp to avoid separation</span></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>depression_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>  years_working, phys_activity, obesity, <span class="at">depression =</span> y</span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depression_data)</span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>Generate a dataset with 200 observations containing the following variables:</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outcome variables: depression (binary, 0 = no depression, 1 = depression)</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Covariates:</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>years_working (continious, ranging 0-40 years)</span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>phys_activity (Physical activity score, continious, range 0-10)</span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>obesity (binary, 0 = not obese, 1 = obese)</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Include an interaction effect between phys_activity and obesity on depression.</span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preperation</span></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load libraries</span></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-libraries</span></span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data cleaning and coding</span></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data-prep</span></span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a>depression_data<span class="sc">$</span>obesity <span class="ot">&lt;-</span> <span class="fu">factor</span>(depression_data<span class="sc">$</span>obesity,</span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>))</span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a>depression_data<span class="sc">$</span>depression <span class="ot">&lt;-</span> <span class="fu">factor</span>(depression_data<span class="sc">$</span>depression,</span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))</span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(depression_data)</span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a>*Interpretation* : The structure of the data shows that 'years_working' and 'phys_activity' are numeric variables, while 'obesity' and 'depression' are factors with two levels each.</span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a><span class="fu">## Label variables</span></span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: label-variables</span></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>years_working) <span class="ot">&lt;-</span> <span class="st">"Years of Working"</span></span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>phys_activity) <span class="ot">&lt;-</span> <span class="st">"Physical Activity Score"</span></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>obesity) <span class="ot">&lt;-</span> <span class="st">"Obesity Status"</span></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(depression_data<span class="sc">$</span>depression) <span class="ot">&lt;-</span> <span class="st">"Depression Status"</span></span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part B: Exploratory Data Analysis</span></span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive statistics</span></span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: descriptive-stats-summarytools</span></span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(depression_data,  </span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a>                <span class="at">style        =</span> <span class="st">"grid"</span>,  </span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a>                <span class="at">varnumbers   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a>                <span class="at">valid.col    =</span> <span class="cn">FALSE</span></span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"render"</span>)</span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a>*Interpretation* : The mean duration of working experience was 21.2 years (SD = 11.8). The average physical activity score was 4.9 (SD = 2.8), indicating moderate variability across individuals. Nearly half of the participants (47.0%) were classified as obese, while 27.0% reported experiencing depression.</span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Histogram for numerical variables</span></span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: histograms-continuous-vars</span></span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Histograms of Continuous Variables"</span></span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Select continuous variables from depression_data</span></span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> depression_data <span class="sc">%&gt;%</span> </span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span> <span class="fu">select</span>(years_working, phys_activity)</span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histograms for each continuous variable</span></span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="sc">%&gt;%</span></span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"phys_activity"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, </span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"years_working"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Continuous Variables"</span>,</span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The distribution of physical activity scores appears relatively uniform, with modest peaks around values 5 and 7, suggesting a balanced spread of activity levels across the sample.</span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In contrast, the distribution of years working is more variable and right-skewed, with noticeable peaks around 10, 20, and 35 years. This indicates substantial heterogeneity in work experience, with a considerable portion of participants reporting extended career durations.</span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplots for numerical variables by obesity status</span></span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: boxplots-continuous-vars</span></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplots of Continuous Variables by Obesity Status"</span></span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plots by obesity status</span></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a>depression_data <span class="sc">%&gt;%</span></span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(obesity) <span class="sc">%&gt;%</span></span>
<span id="cb68-215"><a href="#cb68-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(continuous_vars) <span class="sc">%&gt;%</span></span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>obesity, <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> value, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"not obese"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, </span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"obese"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plots of Continuous Variables by Obesity Status"</span>,</span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical activity scores remain similar across obesity groups, with both showing median values near 5 and interquartile ranges between approximately 2.5 and 7.5. This indicates comparable activity levels regardless of obesity classification.</span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interestingly, the median years of working is slightly higher among individuals classified as obese. Both groups exhibit a wide range of work experience (0 to 40 years), suggesting occupational diversity that may intersect with obesity status.</span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bar plots for categorical variables</span></span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: barplots-categorical-vars</span></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Bar Plots of Categorical Variables"</span></span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(depression_data, <span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Obesity Status"</span>,</span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"not obese"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>,</span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"obese"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a>*Interpretation* : Among the 200 participants, 53.0% were classified as not obese, while 47.0% were classified as obese. This near-equal distribution provides a balanced representation of obesity status within the sample, allowing for meaningful comparisons across health and behavioral variables.</span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bar plots for depression by obesity status</span></span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: barplots-depression-by-obesity</span></span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Bar Plots of Depression Status by Obesity Status"</span></span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(depression_data, <span class="fu">aes</span>(<span class="at">x =</span> depression, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Obesity Status by Depression Status"</span>,</span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression Status"</span>,</span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"not obese"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>,</span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"obese"</span> <span class="ot">=</span> <span class="st">"dodgerblue4"</span>)) <span class="sc">+</span></span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Among participants without depression, the majority were classified as not obese, with a smaller proportion falling into the obese category.</span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In contrast, among those reporting depression, the distribution shifts slightly—fewer individuals were not obese, while the number of obese individuals was marginally higher.</span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This pattern suggests a potential association between depression and obesity, warranting further investigation into their interrelated behavioral or physiological pathways.</span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part C: Regression Analysis</span></span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Univariate analysis</span></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### Years of working</span></span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: univariate-years-working</span></span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Univariate Model - Years of Working"</span></span>
<span id="cb68-298"><a href="#cb68-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a>mlog_yw <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working, </span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_yw, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 2: Univariate Model - Years of Working"</span></span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a><span class="fu">### Physical activity</span></span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: univariate-phys-activity</span></span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Univariate Model - Physical Activity"</span></span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a>mlog_pa <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> phys_activity, </span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_pa, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 3: Univariate Model - Physical Activity"</span></span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-330"><a href="#cb68-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-331"><a href="#cb68-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a><span class="fu">### Obesity</span></span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: univariate-obesity</span></span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Univariate Model - Obesity"</span></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a>mlog_ob <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> obesity, </span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_ob, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 4: Univariate Model - Obesity"</span></span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a>*Interpretation* : Based on the univariable analysis, years of working and physical activity are significantly associated with depression status (95% CI not include 1). However, obesity status shows a non-significant association (95% CI include 1).</span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multivariable analysis</span></span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Full: Physical activity, Obesity and Years of working,</span></span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: multivariable-model:full</span></span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Multivariable Full Model Results"</span></span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a>mlog_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity, </span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mlog_full, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 8: Multivariable Full Model Results"</span></span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Interaction: Physical activity and obesity interaction</span></span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: interaction-model- phys-activity-obesity</span></span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Interaction Model - Physical Activity and Obesity"</span></span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a>mloginter_pa.ob <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity,</span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> depression_data, </span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb68-390"><a href="#cb68-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-391"><a href="#cb68-391" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(mloginter_pa.ob, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 10: Interaction Model - Physical Activity and Obesity"</span></span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a>*Interpretation* : Physical activity and obesity interaction term is significant (p <span class="sc">\&lt;</span> 0.05), indicating that the effect of physical activity on depression varies by obesity status.</span>
<span id="cb68-401"><a href="#cb68-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-402"><a href="#cb68-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison and selection</span></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a>Model fit:</span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model 1: depression \~ years_working + phys_activity + obesity</span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model 2: depression \~ years_working + phys_activity + obesity + phys_activity:obesity</span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> mlog_full</span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> mloginter_pa.ob</span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA to compare nested models</span></span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod2)</span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The likelihood ratio test comparing nested models showed that adding the interaction between physical activity and obesity significantly improved model fit (p = 0.013). </span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This suggests that the association between physical activity and depression differs by obesity status, supporting inclusion of the interaction term in the final model.</span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part D: Model Checking</span></span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check assumptions</span></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linearity of the logit for continuous variables</span></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: linearity-logit</span></span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mfp)</span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a>lin_pa.yw <span class="ot">&lt;-</span>  <span class="fu">mfp</span>(depression <span class="sc">~</span> <span class="fu">fp</span>(years_working) <span class="sc">+</span> <span class="fu">fp</span>(phys_activity) <span class="sc">+</span> obesity,</span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> depression_data,</span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> binomial, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The fractional polynomial analysis indicated that both years working and physical activity did not require higher‑order transformations, as the linear specification provided the best fit.</span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Thus, modeling these variables as linear predictors in the logistic regression is appropriate.</span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independence</span></span>
<span id="cb68-454"><a href="#cb68-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a>Based on study design, we assume independence of observations.</span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a>*Each participant in this study contributed only one record, and data were collected at a single time point. There were no repeated measures or clustering, so the observations can be considered independent.*</span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Absence of multicollinearity</span></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Correlation matrix</span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimate standard errors</span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variance Inflation Factor (VIF)</span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Check correlation between variables</span></span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Correlation matrix (years working and physical activity)</span></span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> depression_data <span class="sc">%&gt;%</span></span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(years_working, phys_activity) <span class="sc">%&gt;%</span></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a>cor_matrix</span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correlation between years of working and physical activity score is very weak and negative (r = –0.014), indicating virtually no linear relationship between the two variables. </span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This suggests that multicollinearity is unlikely to be a concern when including both predictors in the same regression model.</span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visualize correlation matrix</span></span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb68-495"><a href="#cb68-495" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"white"</span>, <span class="st">"darkblue"</span>))(<span class="dv">200</span>),</span>
<span id="cb68-496"><a href="#cb68-496" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>, <span class="at">number.cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a>*Interpretation* : </span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correlation matrix and plot confirm that there is no significant correlation between years working and physical activity (r = −0.014). </span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This suggests that these variables do not correlate each other in the analysis of depression.</span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimate standard errors</span></span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-509"><a href="#cb68-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-510"><a href="#cb68-510" aria-hidden="true" tabindex="-1"></a><span class="do">##| label: standard-errors</span></span>
<span id="cb68-511"><a href="#cb68-511" aria-hidden="true" tabindex="-1"></a><span class="do">##| include: true</span></span>
<span id="cb68-512"><a href="#cb68-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a><span class="co"># Show only estimates and standard errors for Model 2</span></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod2, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span> <span class="fu">select</span>(term, estimate, std.error)</span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-518"><a href="#cb68-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-519"><a href="#cb68-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a>*Interpretation* : All predictors were statistically significant, with reasonably small standard errors, indicating precise estimates. There were no signs of inflated standard errors that would suggest multicollinearity issues.</span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variance Inflation Factor (VIF)</span></span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vif-calculation</span></span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb68-531"><a href="#cb68-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-532"><a href="#cb68-532" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(mod2)</span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame for better display</span></span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a>vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(vif_values),</span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a>  <span class="at">VIF =</span> <span class="fu">round</span>(vif_values, <span class="dv">2</span>)</span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a>vif_df</span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variance Inflation Factor (VIF) diagnostics indicated no collinearity concerns for years of working (VIF = 1.03) and physical activity (VIF = 1.53), both well below the conventional threshold of 2.</span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In contrast, obesity (VIF ≈ 3.96) and the physical activity × obesity interaction (VIF ≈ 4.44) showed elevated values.</span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This reflects the inherent correlation between interaction terms and their main effects. While such inflation is expected in models including interactions, it suggests caution in interpreting individual coefficients.</span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nonetheless, the overall model remains valid and interpretable.</span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assess Goodness-of-fit</span></span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-552"><a href="#cb68-552" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hosmer-Lemeshow test</span></span>
<span id="cb68-553"><a href="#cb68-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hosmer-lemeshow-test</span></span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-560"><a href="#cb68-560" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb68-561"><a href="#cb68-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-562"><a href="#cb68-562" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode outcome as 0/1 numeric</span></span>
<span id="cb68-563"><a href="#cb68-563" aria-hidden="true" tabindex="-1"></a>depression_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(depression_data<span class="sc">$</span>depression <span class="sc">==</span> <span class="st">"depressed"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb68-564"><a href="#cb68-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-565"><a href="#cb68-565" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Hosmer–Lemeshow test</span></span>
<span id="cb68-566"><a href="#cb68-566" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(depression_num, <span class="fu">fitted</span>(mod2), <span class="at">g =</span> <span class="dv">10</span>)</span>
<span id="cb68-567"><a href="#cb68-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-568"><a href="#cb68-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-569"><a href="#cb68-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-570"><a href="#cb68-570" aria-hidden="true" tabindex="-1"></a>*Interpretation* : The Hosmer–Lemeshow test was highly significant (p <span class="sc">\&lt;</span> 0.001), indicating evidence of poor fit. This suggests that the logistic regression model’s predicted probabilities do not align well with the observed outcomes.</span>
<span id="cb68-571"><a href="#cb68-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-572"><a href="#cb68-572" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classification table</span></span>
<span id="cb68-573"><a href="#cb68-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-574"><a href="#cb68-574" aria-hidden="true" tabindex="-1"></a>Predict classes based on a 0.5 threshold and create confusion matrix to calculate:</span>
<span id="cb68-575"><a href="#cb68-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-576"><a href="#cb68-576" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Accuracy</span>
<span id="cb68-577"><a href="#cb68-577" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sensitivity</span>
<span id="cb68-578"><a href="#cb68-578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specificity</span>
<span id="cb68-579"><a href="#cb68-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-582"><a href="#cb68-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-583"><a href="#cb68-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: classification-table</span></span>
<span id="cb68-584"><a href="#cb68-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-585"><a href="#cb68-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-586"><a href="#cb68-586" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb68-587"><a href="#cb68-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-588"><a href="#cb68-588" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted probabilities</span></span>
<span id="cb68-589"><a href="#cb68-589" aria-hidden="true" tabindex="-1"></a>final.m.prob <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod2, <span class="at">type.predict =</span> <span class="st">"response"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-590"><a href="#cb68-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred.class =</span> <span class="fu">ifelse</span>(.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb68-591"><a href="#cb68-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-592"><a href="#cb68-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb68-593"><a href="#cb68-593" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(final.m.prob<span class="sc">$</span>pred.class),</span>
<span id="cb68-594"><a href="#cb68-594" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.factor</span>(depression_data<span class="sc">$</span>depression),</span>
<span id="cb68-595"><a href="#cb68-595" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb68-596"><a href="#cb68-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-597"><a href="#cb68-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-598"><a href="#cb68-598" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-599"><a href="#cb68-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-600"><a href="#cb68-600" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The logistic regression model achieved an overall accuracy of 80.5% (95% CI: 74, 86).</span>
<span id="cb68-601"><a href="#cb68-601" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specificity was high (94.5%), but sensitivity was modest (42.6%), indicating the model was better at correctly identifying non-depressed individuals than depressed ones.</span>
<span id="cb68-602"><a href="#cb68-602" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Positive and negative predictive values were 74% and 82%, respectively.</span>
<span id="cb68-603"><a href="#cb68-603" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Kappa statistic (0.43) indicated moderate agreement beyond chance. However, McNemar’s test was significant (p <span class="sc">\&lt;</span> 0.001), suggesting some systematic misclassification, mainly due to under-detection of depressed cases.</span>
<span id="cb68-604"><a href="#cb68-604" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Overall, the model performs well in distinguishing non-depressed individuals, but sensitivity limitations highlight caution in clinical application.</span>
<span id="cb68-605"><a href="#cb68-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-606"><a href="#cb68-606" aria-hidden="true" tabindex="-1"></a><span class="fu">### ROC Curve</span></span>
<span id="cb68-607"><a href="#cb68-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-610"><a href="#cb68-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-611"><a href="#cb68-611" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb68-612"><a href="#cb68-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-613"><a href="#cb68-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Build ROC object</span></span>
<span id="cb68-614"><a href="#cb68-614" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(depression_data<span class="sc">$</span>depression, final.m.prob<span class="sc">$</span>.fitted)</span>
<span id="cb68-615"><a href="#cb68-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-616"><a href="#cb68-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curve</span></span>
<span id="cb68-617"><a href="#cb68-617" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-618"><a href="#cb68-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-619"><a href="#cb68-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Add AUC text to the plot</span></span>
<span id="cb68-620"><a href="#cb68-620" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj)</span>
<span id="cb68-621"><a href="#cb68-621" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_value, <span class="dv">3</span>)), <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb68-622"><a href="#cb68-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-623"><a href="#cb68-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-624"><a href="#cb68-624" aria-hidden="true" tabindex="-1"></a>*Interpretation*: The model can distinguish between patients with and without diabetes complications approximately 77.4% of the time (AUC = 0.774).</span>
<span id="cb68-625"><a href="#cb68-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-626"><a href="#cb68-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check for confounding</span></span>
<span id="cb68-627"><a href="#cb68-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-628"><a href="#cb68-628" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assess confounding by examining percent change in OR</span></span>
<span id="cb68-629"><a href="#cb68-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-632"><a href="#cb68-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-633"><a href="#cb68-633" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb68-634"><a href="#cb68-634" aria-hidden="true" tabindex="-1"></a>  <span class="at">pa =</span> mlog_pa,</span>
<span id="cb68-635"><a href="#cb68-635" aria-hidden="true" tabindex="-1"></a>  <span class="at">pa_ob =</span> <span class="fu">glm</span>(depression <span class="sc">~</span> phys_activity <span class="sc">+</span> obesity, </span>
<span id="cb68-636"><a href="#cb68-636" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> depression_data, </span>
<span id="cb68-637"><a href="#cb68-637" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> binomial),</span>
<span id="cb68-638"><a href="#cb68-638" aria-hidden="true" tabindex="-1"></a>  <span class="at">pa_ob_yw =</span> mlog_full</span>
<span id="cb68-639"><a href="#cb68-639" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-640"><a href="#cb68-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-641"><a href="#cb68-641" aria-hidden="true" tabindex="-1"></a>confounding <span class="ot">&lt;-</span> <span class="fu">map_df</span>(models, <span class="sc">~</span> <span class="fu">tidy</span>(.x, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>), <span class="at">.id =</span> <span class="st">"model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-642"><a href="#cb68-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-643"><a href="#cb68-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"phys_activity"</span>)   <span class="co"># fix typo here</span></span>
<span id="cb68-644"><a href="#cb68-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-645"><a href="#cb68-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unadjusted OR for phys_activity</span></span>
<span id="cb68-646"><a href="#cb68-646" aria-hidden="true" tabindex="-1"></a>or_unadj <span class="ot">&lt;-</span> confounding <span class="sc">%&gt;%</span></span>
<span id="cb68-647"><a href="#cb68-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"pa"</span>) <span class="sc">%&gt;%</span>         <span class="co"># use "pa", not "phys_activity"</span></span>
<span id="cb68-648"><a href="#cb68-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span>
<span id="cb68-649"><a href="#cb68-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-650"><a href="#cb68-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Add percent change column</span></span>
<span id="cb68-651"><a href="#cb68-651" aria-hidden="true" tabindex="-1"></a>confounding <span class="ot">&lt;-</span> confounding <span class="sc">%&gt;%</span></span>
<span id="cb68-652"><a href="#cb68-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_change =</span> <span class="fu">round</span>((estimate <span class="sc">-</span> or_unadj) <span class="sc">/</span> or_unadj <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb68-653"><a href="#cb68-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-654"><a href="#cb68-654" aria-hidden="true" tabindex="-1"></a>confounding</span>
<span id="cb68-655"><a href="#cb68-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-656"><a href="#cb68-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-657"><a href="#cb68-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-658"><a href="#cb68-658" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-659"><a href="#cb68-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-660"><a href="#cb68-660" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The adjusted odds ratios for physical activity changed by less than 10% after sequentially adjusting for obesity and years of working.</span>
<span id="cb68-661"><a href="#cb68-661" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This minimal change suggests that neither variable acts as a significant confounder in the relationship between physical activity and depression.</span>
<span id="cb68-662"><a href="#cb68-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-663"><a href="#cb68-663" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check the association of each variable with the outcome (depression)</span></span>
<span id="cb68-664"><a href="#cb68-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-667"><a href="#cb68-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-668"><a href="#cb68-668" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb68-669"><a href="#cb68-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-670"><a href="#cb68-670" aria-hidden="true" tabindex="-1"></a>slr.pa.ob.yw <span class="ot">&lt;-</span> depression_data <span class="sc">%&gt;%</span></span>
<span id="cb68-671"><a href="#cb68-671" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phys_activity, obesity, years_working) <span class="sc">%&gt;%</span></span>
<span id="cb68-672"><a href="#cb68-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imap</span>(<span class="sc">~</span> <span class="fu">glm</span>(depression <span class="sc">~</span> .x, <span class="at">data =</span> depression_data, <span class="at">family =</span> binomial) <span class="sc">%&gt;%</span></span>
<span id="cb68-673"><a href="#cb68-673" aria-hidden="true" tabindex="-1"></a>         <span class="fu">tidy</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-674"><a href="#cb68-674" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">model =</span> .y)) <span class="sc">%&gt;%</span>   <span class="co"># .y is the column name</span></span>
<span id="cb68-675"><a href="#cb68-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb68-676"><a href="#cb68-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-677"><a href="#cb68-677" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results without intercepts</span></span>
<span id="cb68-678"><a href="#cb68-678" aria-hidden="true" tabindex="-1"></a>slr.pa.ob.yw <span class="sc">%&gt;%</span></span>
<span id="cb68-679"><a href="#cb68-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-680"><a href="#cb68-680" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(model, <span class="fu">everything</span>())</span>
<span id="cb68-681"><a href="#cb68-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-682"><a href="#cb68-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-683"><a href="#cb68-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-684"><a href="#cb68-684" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-685"><a href="#cb68-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-686"><a href="#cb68-686" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical activity and years of working were statistically significant and clinically relevant predictors of depression, each contributing independently to risk.</span>
<span id="cb68-687"><a href="#cb68-687" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Obesity showed a positive association but was not statistically significant in the univariable model.</span>
<span id="cb68-688"><a href="#cb68-688" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These results support including physical activity and years of working in the final model, while obesity may warrant further evaluation in multivariable or interaction models.</span>
<span id="cb68-689"><a href="#cb68-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-690"><a href="#cb68-690" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostic plot</span></span>
<span id="cb68-691"><a href="#cb68-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-694"><a href="#cb68-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-695"><a href="#cb68-695" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb68-696"><a href="#cb68-696" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-697"><a href="#cb68-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-698"><a href="#cb68-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-699"><a href="#cb68-699" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-700"><a href="#cb68-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-701"><a href="#cb68-701" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The diagnostic plots for Model 2 (interaction) show no major violations of regression assumptions.</span>
<span id="cb68-702"><a href="#cb68-702" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Residuals are generally well-behaved, variance appears roughly constant, and only a few observations (e.g., points 140, 18, 200) show moderate influence.</span>
<span id="cb68-703"><a href="#cb68-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Overall, the model appears statistically sound and well-fitted to the data.</span>
<span id="cb68-704"><a href="#cb68-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-705"><a href="#cb68-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform influential analysis</span></span>
<span id="cb68-706"><a href="#cb68-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-707"><a href="#cb68-707" aria-hidden="true" tabindex="-1"></a><span class="fu">### List of influential observations</span></span>
<span id="cb68-708"><a href="#cb68-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-711"><a href="#cb68-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-712"><a href="#cb68-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: list-influential-observations</span></span>
<span id="cb68-713"><a href="#cb68-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-714"><a href="#cb68-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-715"><a href="#cb68-715" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(mod2)</span>
<span id="cb68-716"><a href="#cb68-716" aria-hidden="true" tabindex="-1"></a>infl.val <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(infl<span class="sc">$</span>infmat)</span>
<span id="cb68-717"><a href="#cb68-717" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(infl.val)</span>
<span id="cb68-718"><a href="#cb68-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-719"><a href="#cb68-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-720"><a href="#cb68-720" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cook's distance</span></span>
<span id="cb68-721"><a href="#cb68-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-722"><a href="#cb68-722" aria-hidden="true" tabindex="-1"></a>Cut off for Cook's distance: 4/n</span>
<span id="cb68-723"><a href="#cb68-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-724"><a href="#cb68-724" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cook's distance influential observations</span></span>
<span id="cb68-725"><a href="#cb68-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-728"><a href="#cb68-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-729"><a href="#cb68-729" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cooks-distance-influential-observations</span></span>
<span id="cb68-730"><a href="#cb68-730" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-731"><a href="#cb68-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-732"><a href="#cb68-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-733"><a href="#cb68-733" aria-hidden="true" tabindex="-1"></a>cutoff.cook.d <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(depression_data)</span>
<span id="cb68-734"><a href="#cb68-734" aria-hidden="true" tabindex="-1"></a>infl.val <span class="sc">|&gt;</span></span>
<span id="cb68-735"><a href="#cb68-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cook.d <span class="sc">&gt;</span> cutoff.cook.d)</span>
<span id="cb68-736"><a href="#cb68-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-737"><a href="#cb68-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-738"><a href="#cb68-738" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cook's distance plot</span></span>
<span id="cb68-739"><a href="#cb68-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-740"><a href="#cb68-740" aria-hidden="true" tabindex="-1"></a>Cutpoint for Cook's distance: 4/n</span>
<span id="cb68-741"><a href="#cb68-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-744"><a href="#cb68-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-745"><a href="#cb68-745" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cooks-distance-plot</span></span>
<span id="cb68-746"><a href="#cb68-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-747"><a href="#cb68-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-748"><a href="#cb68-748" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(depression_data)</span>
<span id="cb68-749"><a href="#cb68-749" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels=</span>cutoff)</span>
<span id="cb68-750"><a href="#cb68-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-751"><a href="#cb68-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-752"><a href="#cb68-752" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-753"><a href="#cb68-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-754"><a href="#cb68-754" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Cook’s distance plot identified observations 18, 140, and 200 as potentially influential, with elevated Cook’s distances relative to the rest of the dataset.</span>
<span id="cb68-755"><a href="#cb68-755" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>While these points may affect model estimates, none exceed the conventional threshold for high influence, suggesting that the model is generally robust.</span>
<span id="cb68-756"><a href="#cb68-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-757"><a href="#cb68-757" aria-hidden="true" tabindex="-1"></a><span class="fu">### DFBETAS</span></span>
<span id="cb68-758"><a href="#cb68-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-759"><a href="#cb68-759" aria-hidden="true" tabindex="-1"></a>Cut off for DFBETAS: 2/sqrt(n)</span>
<span id="cb68-760"><a href="#cb68-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-763"><a href="#cb68-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-764"><a href="#cb68-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dfbetas-plot</span></span>
<span id="cb68-765"><a href="#cb68-765" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-766"><a href="#cb68-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "DFBETAS for Model Coefficients"</span></span>
<span id="cb68-767"><a href="#cb68-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb68-768"><a href="#cb68-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb68-769"><a href="#cb68-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-770"><a href="#cb68-770" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute DFBETAS</span></span>
<span id="cb68-771"><a href="#cb68-771" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(mod2)</span>
<span id="cb68-772"><a href="#cb68-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-773"><a href="#cb68-773" aria-hidden="true" tabindex="-1"></a><span class="co"># Color palette for coefficients</span></span>
<span id="cb68-774"><a href="#cb68-774" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dodgerblue4"</span>, <span class="st">"firebrick"</span>, <span class="st">"darkorchid"</span>, <span class="st">"seagreen"</span>, <span class="st">"goldenrod"</span>)</span>
<span id="cb68-775"><a href="#cb68-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-776"><a href="#cb68-776" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot DFBETAS</span></span>
<span id="cb68-777"><a href="#cb68-777" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(dfb, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> colors,</span>
<span id="cb68-778"><a href="#cb68-778" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"DFBETAS for Model Coefficients"</span>,</span>
<span id="cb68-779"><a href="#cb68-779" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"DFBETAS"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb68-780"><a href="#cb68-780" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-781"><a href="#cb68-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-782"><a href="#cb68-782" aria-hidden="true" tabindex="-1"></a><span class="co"># Threshold lines based on rule of thumb: 2/sqrt(n)</span></span>
<span id="cb68-783"><a href="#cb68-783" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(dfb))</span>
<span id="cb68-784"><a href="#cb68-784" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span>cutoff, cutoff), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-785"><a href="#cb68-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-786"><a href="#cb68-786" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend (placed neatly at top right, vertical layout)</span></span>
<span id="cb68-787"><a href="#cb68-787" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="dv">0</span>), <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-788"><a href="#cb68-788" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Years Working"</span>, <span class="st">"Physical Activity"</span>, </span>
<span id="cb68-789"><a href="#cb68-789" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Obesity: Obese"</span>, <span class="st">"Interaction: Phys x Obesity"</span>),</span>
<span id="cb68-790"><a href="#cb68-790" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> colors, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">horiz =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-791"><a href="#cb68-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-792"><a href="#cb68-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-793"><a href="#cb68-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-794"><a href="#cb68-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-795"><a href="#cb68-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-796"><a href="#cb68-796" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-797"><a href="#cb68-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-798"><a href="#cb68-798" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each colored line represents how much a single observation affects a specific regression coefficient.</span>
<span id="cb68-799"><a href="#cb68-799" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Most lines are short and stay within the red dashed lines (±0.1), indicating that most observations have minimal influence.</span>
<span id="cb68-800"><a href="#cb68-800" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A few spikes exceed ±0.1 — these are potentially influential observations that may meaningfully affect specific model coefficients.</span>
<span id="cb68-801"><a href="#cb68-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-802"><a href="#cb68-802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leverage points</span></span>
<span id="cb68-803"><a href="#cb68-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-804"><a href="#cb68-804" aria-hidden="true" tabindex="-1"></a>Cut off for leverage: (2p + 2)/n</span>
<span id="cb68-805"><a href="#cb68-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-808"><a href="#cb68-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-809"><a href="#cb68-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: leverage-plot</span></span>
<span id="cb68-810"><a href="#cb68-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-811"><a href="#cb68-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Leverage Values for Observations"</span></span>
<span id="cb68-812"><a href="#cb68-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-813"><a href="#cb68-813" aria-hidden="true" tabindex="-1"></a>leverage_values <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(mod2)</span>
<span id="cb68-814"><a href="#cb68-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-815"><a href="#cb68-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic leverage plot with enhancements</span></span>
<span id="cb68-816"><a href="#cb68-816" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leverage_values, </span>
<span id="cb68-817"><a href="#cb68-817" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Leverage Values"</span>,</span>
<span id="cb68-818"><a href="#cb68-818" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Leverage"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb68-819"><a href="#cb68-819" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb68-820"><a href="#cb68-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-821"><a href="#cb68-821" aria-hidden="true" tabindex="-1"></a><span class="co"># Add horizontal cutoff line</span></span>
<span id="cb68-822"><a href="#cb68-822" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(<span class="fu">coef</span>(mod2)) <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(depression_data)</span>
<span id="cb68-823"><a href="#cb68-823" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cutoff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-824"><a href="#cb68-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-825"><a href="#cb68-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate influential points</span></span>
<span id="cb68-826"><a href="#cb68-826" aria-hidden="true" tabindex="-1"></a>influential <span class="ot">&lt;-</span> <span class="fu">which</span>(leverage_values <span class="sc">&gt;</span> cutoff)</span>
<span id="cb68-827"><a href="#cb68-827" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(influential, leverage_values[influential], <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb68-828"><a href="#cb68-828" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(influential, leverage_values[influential], <span class="at">labels =</span> influential, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-829"><a href="#cb68-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-830"><a href="#cb68-830" aria-hidden="true" tabindex="-1"></a><span class="co"># Label with observation numbers</span></span>
<span id="cb68-831"><a href="#cb68-831" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(influential, leverage_values[influential],</span>
<span id="cb68-832"><a href="#cb68-832" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> influential, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span>
<span id="cb68-833"><a href="#cb68-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-834"><a href="#cb68-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-835"><a href="#cb68-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-836"><a href="#cb68-836" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-837"><a href="#cb68-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-838"><a href="#cb68-838" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Most observations fall below the cutoff line, indicating low leverage and minimal influence on the model.</span>
<span id="cb68-839"><a href="#cb68-839" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, one observation exceeds the threshold, suggesting it may disproportionately affect the regression estimates.</span>
<span id="cb68-840"><a href="#cb68-840" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This point should be reviewed further to assess its impact on model stability and validity.</span>
<span id="cb68-841"><a href="#cb68-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-842"><a href="#cb68-842" aria-hidden="true" tabindex="-1"></a><span class="fu">### Standardized residuals</span></span>
<span id="cb68-843"><a href="#cb68-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-844"><a href="#cb68-844" aria-hidden="true" tabindex="-1"></a>cut off for standardized residuals: <span class="sc">\|</span>2<span class="sc">\|</span></span>
<span id="cb68-845"><a href="#cb68-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-848"><a href="#cb68-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-849"><a href="#cb68-849" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: standardized-residuals-plot</span></span>
<span id="cb68-850"><a href="#cb68-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-851"><a href="#cb68-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Standardized Residuals for Final Model"</span></span>
<span id="cb68-852"><a href="#cb68-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-853"><a href="#cb68-853" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized residuals</span></span>
<span id="cb68-854"><a href="#cb68-854" aria-hidden="true" tabindex="-1"></a>std_resid <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(mod2)</span>
<span id="cb68-855"><a href="#cb68-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-856"><a href="#cb68-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals</span></span>
<span id="cb68-857"><a href="#cb68-857" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(std_resid,</span>
<span id="cb68-858"><a href="#cb68-858" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Standardized Residuals"</span>,</span>
<span id="cb68-859"><a href="#cb68-859" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Standardized Residuals"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb68-860"><a href="#cb68-860" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"dodgerblue4"</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb68-861"><a href="#cb68-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-862"><a href="#cb68-862" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cutoff lines</span></span>
<span id="cb68-863"><a href="#cb68-863" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-864"><a href="#cb68-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-865"><a href="#cb68-865" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify influential observations (outside ±2)</span></span>
<span id="cb68-866"><a href="#cb68-866" aria-hidden="true" tabindex="-1"></a>infl_obs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_resid) <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb68-867"><a href="#cb68-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-868"><a href="#cb68-868" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels for those points</span></span>
<span id="cb68-869"><a href="#cb68-869" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> infl_obs, <span class="at">y =</span> std_resid[infl_obs],</span>
<span id="cb68-870"><a href="#cb68-870" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> infl_obs, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span>
<span id="cb68-871"><a href="#cb68-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-872"><a href="#cb68-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-873"><a href="#cb68-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-874"><a href="#cb68-874" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-875"><a href="#cb68-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-876"><a href="#cb68-876" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The standardized residuals plot shows that most observations fall within ±2, indicating a good model fit.</span>
<span id="cb68-877"><a href="#cb68-877" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, a few points exceed this range, suggesting potential outliers that may warrant further investigation to assess their influence on the model.</span>
<span id="cb68-878"><a href="#cb68-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-879"><a href="#cb68-879" aria-hidden="true" tabindex="-1"></a><span class="fu">## Identify the influential observations</span></span>
<span id="cb68-880"><a href="#cb68-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-881"><a href="#cb68-881" aria-hidden="true" tabindex="-1"></a>Cutoffs:</span>
<span id="cb68-882"><a href="#cb68-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-883"><a href="#cb68-883" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cook's distance: 4/n</span>
<span id="cb68-884"><a href="#cb68-884" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Standardized residuals: <span class="sc">\|</span>2<span class="sc">\|</span></span>
<span id="cb68-885"><a href="#cb68-885" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Leverage: (2p + 2)/n</span>
<span id="cb68-886"><a href="#cb68-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-889"><a href="#cb68-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-890"><a href="#cb68-890" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: influential-observations-summary</span></span>
<span id="cb68-891"><a href="#cb68-891" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-892"><a href="#cb68-892" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Influential Observations Summary"</span></span>
<span id="cb68-893"><a href="#cb68-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-894"><a href="#cb68-894" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (DT)</span>
<span id="cb68-895"><a href="#cb68-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-896"><a href="#cb68-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Create diagnostic datashet (predictions and residuals)</span></span>
<span id="cb68-897"><a href="#cb68-897" aria-hidden="true" tabindex="-1"></a>depression_pred.res <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod2, depression_data)</span>
<span id="cb68-898"><a href="#cb68-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-899"><a href="#cb68-899" aria-hidden="true" tabindex="-1"></a><span class="co"># Define thresholds</span></span>
<span id="cb68-900"><a href="#cb68-900" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(depression_data)</span>
<span id="cb68-901"><a href="#cb68-901" aria-hidden="true" tabindex="-1"></a>p_preds <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mod2))</span>
<span id="cb68-902"><a href="#cb68-902" aria-hidden="true" tabindex="-1"></a>cooks_cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> n_obs</span>
<span id="cb68-903"><a href="#cb68-903" aria-hidden="true" tabindex="-1"></a>leverage_cutoff <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> p_preds <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> n_obs</span>
<span id="cb68-904"><a href="#cb68-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-905"><a href="#cb68-905" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify influential observations</span></span>
<span id="cb68-906"><a href="#cb68-906" aria-hidden="true" tabindex="-1"></a>influential_obs <span class="ot">&lt;-</span> depression_pred.res <span class="sc">%&gt;%</span></span>
<span id="cb68-907"><a href="#cb68-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&gt;</span> cooks_cutoff <span class="sc">|</span> <span class="fu">abs</span>(.std.resid) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">|</span> .hat <span class="sc">&gt;</span> leverage_cutoff)</span>
<span id="cb68-908"><a href="#cb68-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-909"><a href="#cb68-909" aria-hidden="true" tabindex="-1"></a><span class="co"># Print count</span></span>
<span id="cb68-910"><a href="#cb68-910" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(influential_obs)</span>
<span id="cb68-911"><a href="#cb68-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-912"><a href="#cb68-912" aria-hidden="true" tabindex="-1"></a><span class="co"># Display influential observations summary</span></span>
<span id="cb68-913"><a href="#cb68-913" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(influential_obs, </span>
<span id="cb68-914"><a href="#cb68-914" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Table 14: Influential Observations Summary"</span>)</span>
<span id="cb68-915"><a href="#cb68-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-916"><a href="#cb68-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-917"><a href="#cb68-917" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remove influential observations and refit the model</span></span>
<span id="cb68-918"><a href="#cb68-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-921"><a href="#cb68-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-922"><a href="#cb68-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: refit-model-without-influential</span></span>
<span id="cb68-923"><a href="#cb68-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-924"><a href="#cb68-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-925"><a href="#cb68-925" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove influential observations based on Cook's distance, residuals, and leverage</span></span>
<span id="cb68-926"><a href="#cb68-926" aria-hidden="true" tabindex="-1"></a>clean_data <span class="ot">&lt;-</span> depression_pred.res <span class="sc">%&gt;%</span></span>
<span id="cb68-927"><a href="#cb68-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&lt;=</span> cooks_cutoff <span class="sc">&amp;</span> <span class="fu">abs</span>(.std.resid) <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">&amp;</span> .hat <span class="sc">&lt;=</span> leverage_cutoff)</span>
<span id="cb68-928"><a href="#cb68-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-929"><a href="#cb68-929" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit the logistic regression model on cleaned data</span></span>
<span id="cb68-930"><a href="#cb68-930" aria-hidden="true" tabindex="-1"></a>final_model_clean <span class="ot">&lt;-</span> <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity<span class="sc">:</span>obesity,</span>
<span id="cb68-931"><a href="#cb68-931" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> clean_data, <span class="at">family =</span> binomial)</span>
<span id="cb68-932"><a href="#cb68-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-933"><a href="#cb68-933" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression summary table with correct labels</span></span>
<span id="cb68-934"><a href="#cb68-934" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb68-935"><a href="#cb68-935" aria-hidden="true" tabindex="-1"></a>  final_model_clean,</span>
<span id="cb68-936"><a href="#cb68-936" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-937"><a href="#cb68-937" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-938"><a href="#cb68-938" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb68-939"><a href="#cb68-939" aria-hidden="true" tabindex="-1"></a>    years_working <span class="sc">~</span> <span class="st">"Years Working"</span>,</span>
<span id="cb68-940"><a href="#cb68-940" aria-hidden="true" tabindex="-1"></a>    phys_activity <span class="sc">~</span> <span class="st">"Physical Activity"</span>,</span>
<span id="cb68-941"><a href="#cb68-941" aria-hidden="true" tabindex="-1"></a>    obesity <span class="sc">~</span> <span class="st">"Obesity"</span>,</span>
<span id="cb68-942"><a href="#cb68-942" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">phys_activity:obesity</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Interaction: Physical Activity × Obesity"</span></span>
<span id="cb68-943"><a href="#cb68-943" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-944"><a href="#cb68-944" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb68-945"><a href="#cb68-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-946"><a href="#cb68-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-947"><a href="#cb68-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_source_note</span>(<span class="at">include =</span> <span class="fu">c</span>(AIC, BIC, logLik)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-948"><a href="#cb68-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(estimate <span class="sc">~</span> <span class="st">"**Adjusted OR**"</span>)</span>
<span id="cb68-949"><a href="#cb68-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-950"><a href="#cb68-950" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to gt and style</span></span>
<span id="cb68-951"><a href="#cb68-951" aria-hidden="true" tabindex="-1"></a>tbl <span class="sc">%&gt;%</span></span>
<span id="cb68-952"><a href="#cb68-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-953"><a href="#cb68-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-954"><a href="#cb68-954" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 15: Final Model Results after Removing Influential Observations"</span></span>
<span id="cb68-955"><a href="#cb68-955" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-956"><a href="#cb68-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-957"><a href="#cb68-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-958"><a href="#cb68-958" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare results before and after removing influential observations</span></span>
<span id="cb68-959"><a href="#cb68-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-960"><a href="#cb68-960" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model performance comparison</span></span>
<span id="cb68-961"><a href="#cb68-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-962"><a href="#cb68-962" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model A (before removing influential observations)</span>
<span id="cb68-963"><a href="#cb68-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-966"><a href="#cb68-966" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-967"><a href="#cb68-967" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare-model-performance</span></span>
<span id="cb68-968"><a href="#cb68-968" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-969"><a href="#cb68-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-970"><a href="#cb68-970" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb68-971"><a href="#cb68-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-972"><a href="#cb68-972" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(mod2)</span>
<span id="cb68-973"><a href="#cb68-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-974"><a href="#cb68-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-975"><a href="#cb68-975" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model B (after removing influential observations)</span>
<span id="cb68-976"><a href="#cb68-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-979"><a href="#cb68-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-980"><a href="#cb68-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare-model-performance-clean</span></span>
<span id="cb68-981"><a href="#cb68-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-982"><a href="#cb68-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-983"><a href="#cb68-983" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(final_model_clean)</span>
<span id="cb68-984"><a href="#cb68-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-985"><a href="#cb68-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-986"><a href="#cb68-986" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model coefficients comparison</span></span>
<span id="cb68-987"><a href="#cb68-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-990"><a href="#cb68-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-991"><a href="#cb68-991" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare-model-coefficients</span></span>
<span id="cb68-992"><a href="#cb68-992" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-993"><a href="#cb68-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-994"><a href="#cb68-994" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(mod2, final_model_clean)</span>
<span id="cb68-995"><a href="#cb68-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-996"><a href="#cb68-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-997"><a href="#cb68-997" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-998"><a href="#cb68-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-999"><a href="#cb68-999" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The cleaned model outperformed the original model across multiple evaluation metrics.</span>
<span id="cb68-1000"><a href="#cb68-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>It had lower AIC, BIC, and log-loss values, indicating improved model fit.</span>
<span id="cb68-1001"><a href="#cb68-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>It also showed higher Tjur’s R² (0.352 vs. 0.229) and prediction accuracy (PCP = 0.766 vs. 0.696), reflecting stronger explanatory power and better classification performance.</span>
<span id="cb68-1002"><a href="#cb68-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These improvements suggest that removing influential observations enhanced the model’s overall robustness and predictive accuracy.</span>
<span id="cb68-1003"><a href="#cb68-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1004"><a href="#cb68-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compare coefficients before and after removing influential observations</span></span>
<span id="cb68-1005"><a href="#cb68-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1008"><a href="#cb68-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1009"><a href="#cb68-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare-coefficients-before-after</span></span>
<span id="cb68-1010"><a href="#cb68-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1011"><a href="#cb68-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1012"><a href="#cb68-1012" aria-hidden="true" tabindex="-1"></a>coef_comparison <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod2) <span class="sc">%&gt;%</span></span>
<span id="cb68-1013"><a href="#cb68-1013" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span> <span class="fu">select</span>(term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb68-1014"><a href="#cb68-1014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">estimate_prelim =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb68-1015"><a href="#cb68-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb68-1016"><a href="#cb68-1016" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(final_model_clean) <span class="sc">%&gt;%</span></span>
<span id="cb68-1017"><a href="#cb68-1017" aria-hidden="true" tabindex="-1"></a>      dplyr <span class="sc">::</span> <span class="fu">select</span>(term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb68-1018"><a href="#cb68-1018" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">estimate_refit =</span> estimate),</span>
<span id="cb68-1019"><a href="#cb68-1019" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"term"</span></span>
<span id="cb68-1020"><a href="#cb68-1020" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1021"><a href="#cb68-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1022"><a href="#cb68-1022" aria-hidden="true" tabindex="-1"></a>    <span class="at">change_in_estimate =</span> estimate_refit <span class="sc">-</span> estimate_prelim,</span>
<span id="cb68-1023"><a href="#cb68-1023" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_change =</span> (change_in_estimate <span class="sc">/</span> estimate_prelim) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb68-1024"><a href="#cb68-1024" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1025"><a href="#cb68-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1026"><a href="#cb68-1026" aria-hidden="true" tabindex="-1"></a>coef_comparison</span>
<span id="cb68-1027"><a href="#cb68-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1028"><a href="#cb68-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1029"><a href="#cb68-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1030"><a href="#cb68-1030" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-1031"><a href="#cb68-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1032"><a href="#cb68-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>After removing influential observations, most model estimates changed substantially.</span>
<span id="cb68-1033"><a href="#cb68-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The effect of years working became stronger, and the impact of physical activity and obesity increased.</span>
<span id="cb68-1034"><a href="#cb68-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The interaction between physical activity and obesity also showed a larger effect.</span>
<span id="cb68-1035"><a href="#cb68-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These shifts suggest that the original model was sensitive to specific data points, and the cleaned model yields more stable and interpretable estimates.</span>
<span id="cb68-1036"><a href="#cb68-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1037"><a href="#cb68-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compare model diagnostics before and after removing influential observations</span></span>
<span id="cb68-1038"><a href="#cb68-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1041"><a href="#cb68-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1042"><a href="#cb68-1042" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare-model-diagnostics</span></span>
<span id="cb68-1043"><a href="#cb68-1043" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1044"><a href="#cb68-1044" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Diagnostic Plots Before and After Removing Influential Observations"</span></span>
<span id="cb68-1045"><a href="#cb68-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1046"><a href="#cb68-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up 2 columns × 4 rows layout</span></span>
<span id="cb68-1047"><a href="#cb68-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-1048"><a href="#cb68-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1049"><a href="#cb68-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted</span></span>
<span id="cb68-1050"><a href="#cb68-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Prelim Model"</span>)</span>
<span id="cb68-1051"><a href="#cb68-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb68-1052"><a href="#cb68-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1053"><a href="#cb68-1053" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q Plot</span></span>
<span id="cb68-1054"><a href="#cb68-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"Prelim Mode"</span>)</span>
<span id="cb68-1055"><a href="#cb68-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb68-1056"><a href="#cb68-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1057"><a href="#cb68-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale-Location</span></span>
<span id="cb68-1058"><a href="#cb68-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">main =</span> <span class="st">"Prelim Mode"</span>)</span>
<span id="cb68-1059"><a href="#cb68-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb68-1060"><a href="#cb68-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1061"><a href="#cb68-1061" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's Distance</span></span>
<span id="cb68-1062"><a href="#cb68-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Prelim Mode"</span>)</span>
<span id="cb68-1063"><a href="#cb68-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Refit Model"</span>)</span>
<span id="cb68-1064"><a href="#cb68-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1065"><a href="#cb68-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Leverage</span></span>
<span id="cb68-1066"><a href="#cb68-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb68-1067"><a href="#cb68-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb68-1068"><a href="#cb68-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1069"><a href="#cb68-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's distance vs Leverage</span></span>
<span id="cb68-1070"><a href="#cb68-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb68-1071"><a href="#cb68-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final_model_clean, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb68-1072"><a href="#cb68-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1073"><a href="#cb68-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1074"><a href="#cb68-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1075"><a href="#cb68-1075" aria-hidden="true" tabindex="-1"></a>*Interpretation* : The "Refit Model" is a significant improvement over the "Prelim Model."</span>
<span id="cb68-1076"><a href="#cb68-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1077"><a href="#cb68-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Linearity (Residuals vs Fitted)**: The original model displayed widely scattered residuals (–6 to +4) with distinct striations, though the smoothing line was relatively stable. In the refit model, the striation pattern remains (typical for discrete outcomes), but residuals are more contained (–3 to +3) and the smoothing line remains centered at zero, suggesting tighter model fit.</span>
<span id="cb68-1078"><a href="#cb68-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1079"><a href="#cb68-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normality (Q-Q Residuals)**: The initial Q-Q plot showed a generally good fit but flagged extreme outliers (e.g., Obs 21, 188, 140). Post-refit, residuals align more closely with the theoretical line, and tail deviations are mitigated, supporting the error distribution assumption.</span>
<span id="cb68-1080"><a href="#cb68-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1081"><a href="#cb68-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Homoscedasticity (Scale-Location)**: The original plot showed a V-shaped pattern with residuals reaching 2.5, indicating non-constant variance. In the refit model, the V-shape persists but residual spread is reduced (max ≈ 1.5), suggesting improved error stability.</span>
<span id="cb68-1082"><a href="#cb68-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1083"><a href="#cb68-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Influential Observations (Cook’s Distance)**: The prelim model flagged Obs 143 and 228 with Cook’s distances near 0.12. In the refit model, the maximum Cook’s distance drops to ≈ 0.06, indicating more stable coefficients and reduced undue influence from outliers.</span>
<span id="cb68-1084"><a href="#cb68-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1085"><a href="#cb68-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Residuals vs Leverage**: The plot shows that most observations have low leverage and standardized residuals close to zero, indicating minimal influence on the model. A few points (e.g., Obs 233, 243) stand out with higher leverage and moderate residuals, suggesting they may exert disproportionate influence on the fitted values. However, the overall pattern remains stable, and the smoothing line does not show concerning curvature, supporting model robustness.</span>
<span id="cb68-1086"><a href="#cb68-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1087"><a href="#cb68-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cook’s Distance vs Leverage**: This plot confirms that influential observations tend to have both high leverage and large residuals. Points such as 233 and 243 approach the conventional Cook’s distance thresholds (e.g., 0.5–1), but none exceed critical influence levels. The distribution is well-contained, and the model appears resilient to individual data points.</span>
<span id="cb68-1088"><a href="#cb68-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1089"><a href="#cb68-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Residuals analysis (pearson residuals) after removing influential observations</span></span>
<span id="cb68-1090"><a href="#cb68-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1093"><a href="#cb68-1093" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1094"><a href="#cb68-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: residuals-plot</span></span>
<span id="cb68-1095"><a href="#cb68-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1096"><a href="#cb68-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1097"><a href="#cb68-1097" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Pearson residuals</span></span>
<span id="cb68-1098"><a href="#cb68-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(final_model_clean, <span class="at">type =</span> <span class="st">"pearson"</span>))</span>
<span id="cb68-1099"><a href="#cb68-1099" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb68-1100"><a href="#cb68-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1101"><a href="#cb68-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1102"><a href="#cb68-1102" aria-hidden="true" tabindex="-1"></a>*Interpretation* : The plot showed a random scatter around zero, suggesting no major issues with model fit or specification.</span>
<span id="cb68-1103"><a href="#cb68-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1104"><a href="#cb68-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calibration plot after removing influential observations</span></span>
<span id="cb68-1105"><a href="#cb68-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1108"><a href="#cb68-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1109"><a href="#cb68-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: calibration-plot</span></span>
<span id="cb68-1110"><a href="#cb68-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1111"><a href="#cb68-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Calibration Plot for Final Model"</span></span>
<span id="cb68-1112"><a href="#cb68-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1113"><a href="#cb68-1113" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted probabilities</span></span>
<span id="cb68-1114"><a href="#cb68-1114" aria-hidden="true" tabindex="-1"></a>car.m.prob <span class="ot">&lt;-</span> <span class="fu">augment</span>(final_model_clean, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span>
<span id="cb68-1115"><a href="#cb68-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1116"><a href="#cb68-1116" aria-hidden="true" tabindex="-1"></a><span class="co"># Create calibration plot</span></span>
<span id="cb68-1117"><a href="#cb68-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(car.m.prob, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid <span class="sc">+</span> .fitted)) <span class="sc">+</span></span>
<span id="cb68-1118"><a href="#cb68-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"dodgerblue4"</span>) <span class="sc">+</span></span>
<span id="cb68-1119"><a href="#cb68-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb68-1120"><a href="#cb68-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb68-1121"><a href="#cb68-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Calibration Plot for Final Model"</span>,</span>
<span id="cb68-1122"><a href="#cb68-1122" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Probability"</span>,</span>
<span id="cb68-1123"><a href="#cb68-1123" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed Proportion"</span>) <span class="sc">+</span></span>
<span id="cb68-1124"><a href="#cb68-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb68-1125"><a href="#cb68-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1126"><a href="#cb68-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1127"><a href="#cb68-1127" aria-hidden="true" tabindex="-1"></a>*Interpretation* : This plot checks how well the model’s predictions match real outcomes. The dashed line shows perfect prediction. The red line shows what actually happened. Since the red line is close to the dashed line, the model’s predictions are mostly accurate. But at higher risk levels, the model slightly overestimates the chance of depression.</span>
<span id="cb68-1128"><a href="#cb68-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1129"><a href="#cb68-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1130"><a href="#cb68-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1131"><a href="#cb68-1131" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part E: Results Presentation and Interpretation</span></span>
<span id="cb68-1132"><a href="#cb68-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1133"><a href="#cb68-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final regression table</span></span>
<span id="cb68-1134"><a href="#cb68-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1137"><a href="#cb68-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1138"><a href="#cb68-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: final-regression-table</span></span>
<span id="cb68-1139"><a href="#cb68-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1140"><a href="#cb68-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#| tab-cap: "Final Regression Model Results after Removing Influential Observations"</span></span>
<span id="cb68-1141"><a href="#cb68-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1142"><a href="#cb68-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Tjur's R²</span></span>
<span id="cb68-1143"><a href="#cb68-1143" aria-hidden="true" tabindex="-1"></a>r2_tjur <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">r2_tjur</span>(final_model_clean)</span>
<span id="cb68-1144"><a href="#cb68-1144" aria-hidden="true" tabindex="-1"></a>r2_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Tjur's R² = "</span>, <span class="fu">round</span>(r2_tjur, <span class="dv">3</span>))</span>
<span id="cb68-1145"><a href="#cb68-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1146"><a href="#cb68-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1147"><a href="#cb68-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the table</span></span>
<span id="cb68-1148"><a href="#cb68-1148" aria-hidden="true" tabindex="-1"></a>tbl_final <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(</span>
<span id="cb68-1149"><a href="#cb68-1149" aria-hidden="true" tabindex="-1"></a>  final_model_clean,</span>
<span id="cb68-1150"><a href="#cb68-1150" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-1151"><a href="#cb68-1151" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-1152"><a href="#cb68-1152" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb68-1153"><a href="#cb68-1153" aria-hidden="true" tabindex="-1"></a>    years_working <span class="sc">~</span> <span class="st">"Years Working (years)"</span>,</span>
<span id="cb68-1154"><a href="#cb68-1154" aria-hidden="true" tabindex="-1"></a>    phys_activity <span class="sc">~</span> <span class="st">"Physical Activity (score)"</span>,</span>
<span id="cb68-1155"><a href="#cb68-1155" aria-hidden="true" tabindex="-1"></a>    obesity <span class="sc">~</span> <span class="st">"Obesity"</span>,</span>
<span id="cb68-1156"><a href="#cb68-1156" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">phys_activity:obesity</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Interaction: Physical Activity × Obesity"</span></span>
<span id="cb68-1157"><a href="#cb68-1157" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1158"><a href="#cb68-1158" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb68-1159"><a href="#cb68-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_p</span>(<span class="at">t =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-1160"><a href="#cb68-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-1161"><a href="#cb68-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_glance_source_note</span>(<span class="at">include =</span> <span class="fu">c</span>(AIC, BIC, logLik)) <span class="sc">%&gt;%</span></span>
<span id="cb68-1162"><a href="#cb68-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(estimate <span class="sc">~</span> <span class="st">"**Adjusted OR**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-1163"><a href="#cb68-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_source_note</span>(</span>
<span id="cb68-1164"><a href="#cb68-1164" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="fu">paste0</span>(<span class="st">"Model fit statistics: AIC, BIC, log-likelihood. "</span>, r2_text)</span>
<span id="cb68-1165"><a href="#cb68-1165" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1166"><a href="#cb68-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1167"><a href="#cb68-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># Render as gt table</span></span>
<span id="cb68-1168"><a href="#cb68-1168" aria-hidden="true" tabindex="-1"></a>tbl_final <span class="sc">%&gt;%</span></span>
<span id="cb68-1169"><a href="#cb68-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-1170"><a href="#cb68-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-1171"><a href="#cb68-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 16: Final Regression Model Results after Removing Influential Observations"</span></span>
<span id="cb68-1172"><a href="#cb68-1172" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1173"><a href="#cb68-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1174"><a href="#cb68-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1175"><a href="#cb68-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final model equation</span></span>
<span id="cb68-1176"><a href="#cb68-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1177"><a href="#cb68-1177" aria-hidden="true" tabindex="-1"></a>The final logistic regression model predicting depression status is given by the equation:</span>
<span id="cb68-1178"><a href="#cb68-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1179"><a href="#cb68-1179" aria-hidden="true" tabindex="-1"></a>$$\text{Odds of Depression} = 0.14 \times 1.08^{(\text{Years})} \times 0.71^{(\text{Activity})} \times 19^{(\text{Obese})} \times 0.57^{(\text{Interaction})}$$</span>
<span id="cb68-1180"><a href="#cb68-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1181"><a href="#cb68-1181" aria-hidden="true" tabindex="-1"></a>Where: </span>
<span id="cb68-1182"><a href="#cb68-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1183"><a href="#cb68-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Years = Number of years working </span>
<span id="cb68-1184"><a href="#cb68-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Activity = Physical activity score </span>
<span id="cb68-1185"><a href="#cb68-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Obese = 1 if obese, 0 if not obese </span>
<span id="cb68-1186"><a href="#cb68-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interaction = Physical activity × Obesity interaction term</span>
<span id="cb68-1187"><a href="#cb68-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1188"><a href="#cb68-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation of Final Model Results</span></span>
<span id="cb68-1189"><a href="#cb68-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1190"><a href="#cb68-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">### Main Effects and Interaction Terms</span></span>
<span id="cb68-1191"><a href="#cb68-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1192"><a href="#cb68-1192" aria-hidden="true" tabindex="-1"></a>The final model identifies several statistically significant predictors of depression status:</span>
<span id="cb68-1193"><a href="#cb68-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1194"><a href="#cb68-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Years Working: Each additional year of employment was associated with an 8% increase in the odds of depression (Adjusted OR = 1.08, 95% CI: <span class="co">[</span><span class="ot">1.04, 1.13</span><span class="co">]</span>, p &lt; .001), suggesting that longer work duration may be linked to cumulative stress or burnout.</span>
<span id="cb68-1195"><a href="#cb68-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1196"><a href="#cb68-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Physical Activity: Higher physical activity was protective, reducing the odds of depression by 29% among non‑obese individuals (Adjusted OR = 0.71, 95% CI: <span class="co">[</span><span class="ot">0.56, 0.89</span><span class="co">]</span>, p = .004).</span>
<span id="cb68-1197"><a href="#cb68-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1198"><a href="#cb68-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Obesity: Obese individuals had dramatically higher odds of depression compared to non‑obese peers (Adjusted OR = 19.0, 95% CI: <span class="co">[</span><span class="ot">3.48, 131</span><span class="co">]</span>, p = .001), indicating a strong association between obesity and mental health burden.</span>
<span id="cb68-1199"><a href="#cb68-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1200"><a href="#cb68-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interaction (Physical Activity × Obesity): The interaction term (OR = 0.57, 95% CI: <span class="co">[</span><span class="ot">0.35, 0.87</span><span class="co">]</span>, p = .013) indicates that physical activity is even more protective among obese individuals. The combined effect yields an OR of approximately 0.40, corresponding to a 60% reduction in odds of depression per unit increase in physical activity among obese individuals. This suggests that physical activity may buffer the elevated risk of depression associated with obesity.</span>
<span id="cb68-1201"><a href="#cb68-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1202"><a href="#cb68-1202" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Comparison</span></span>
<span id="cb68-1203"><a href="#cb68-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1204"><a href="#cb68-1204" aria-hidden="true" tabindex="-1"></a>Compared to the preliminary model without interaction terms, the final model shows substantial improvement:</span>
<span id="cb68-1205"><a href="#cb68-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1206"><a href="#cb68-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Fit Statistics**: AIC dropped from 198.4 to 150.1, and BIC from 214.9 to 166.3, indicating better model parsimony and explanatory power.</span>
<span id="cb68-1207"><a href="#cb68-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Predictive Accuracy**: PCP increased from 0.696 to 0.766, and Tjur’s R² rose from 0.229 to 0.352, reflecting stronger discrimination between depressed and non-depressed cases.</span>
<span id="cb68-1208"><a href="#cb68-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Conclusion**: Including the interaction term significantly improved model fit and interpretability, capturing nuanced relationships between physical activity and obesity.</span>
<span id="cb68-1209"><a href="#cb68-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1210"><a href="#cb68-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Significance</span></span>
<span id="cb68-1211"><a href="#cb68-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1212"><a href="#cb68-1212" aria-hidden="true" tabindex="-1"></a>The findings have clear implications:</span>
<span id="cb68-1213"><a href="#cb68-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1214"><a href="#cb68-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Workplace Mental Health**: The positive association between years working and depression highlights the need for mental health support in long-term employment settings.</span>
<span id="cb68-1215"><a href="#cb68-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Targeted Interventions**: Physical activity emerges as a modifiable protective factor, especially for obese individuals. Tailored exercise programs could be a strategic intervention to reduce depression risk in this subgroup.</span>
<span id="cb68-1216"><a href="#cb68-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Clinical Screening**: The strong effect of obesity on depression odds suggests that clinicians should routinely screen for depressive symptoms in obese patients.</span>
<span id="cb68-1217"><a href="#cb68-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1218"><a href="#cb68-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Assumptions and Diagnostics</span></span>
<span id="cb68-1219"><a href="#cb68-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1220"><a href="#cb68-1220" aria-hidden="true" tabindex="-1"></a>Model checking revealed:</span>
<span id="cb68-1221"><a href="#cb68-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1222"><a href="#cb68-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Linearity**: Residuals vs Fitted plots showed improved containment and centering in the refit model, suggesting a better-specified relationship between predictors and log-odds.</span>
<span id="cb68-1223"><a href="#cb68-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normality**: Q-Q plots indicated that extreme residuals were mitigated post-refit, improving alignment with theoretical quantiles.</span>
<span id="cb68-1224"><a href="#cb68-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Homoscedasticity**: Scale-Location plots showed reduced residual spread (from 2.5 to 1.5), indicating more stable variance across fitted values.</span>
<span id="cb68-1225"><a href="#cb68-1225" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Influential Observations**: Cook’s distance dropped from \~0.12 to \~0.06 after removing influential points, confirming that the final model is more robust and less sensitive to outliers.</span>
<span id="cb68-1226"><a href="#cb68-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1227"><a href="#cb68-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1228"><a href="#cb68-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction</span></span>
<span id="cb68-1229"><a href="#cb68-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1230"><a href="#cb68-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitted probabilities for existing patients</span></span>
<span id="cb68-1231"><a href="#cb68-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1234"><a href="#cb68-1234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1235"><a href="#cb68-1235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fitted-probabilities-existing-patients</span></span>
<span id="cb68-1236"><a href="#cb68-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1237"><a href="#cb68-1237" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted value</span></span>
<span id="cb68-1238"><a href="#cb68-1238" aria-hidden="true" tabindex="-1"></a>prob_depression <span class="ot">&lt;-</span> <span class="fu">augment</span>(final_model_clean,</span>
<span id="cb68-1239"><a href="#cb68-1239" aria-hidden="true" tabindex="-1"></a>        <span class="at">type.predict =</span> <span class="st">'response'</span>,</span>
<span id="cb68-1240"><a href="#cb68-1240" aria-hidden="true" tabindex="-1"></a>        <span class="at">type.residuals =</span> <span class="st">'pearson'</span>)</span>
<span id="cb68-1241"><a href="#cb68-1241" aria-hidden="true" tabindex="-1"></a>prob_depression <span class="sc">%&gt;%</span></span>
<span id="cb68-1242"><a href="#cb68-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span>
<span id="cb68-1243"><a href="#cb68-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1244"><a href="#cb68-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1245"><a href="#cb68-1245" aria-hidden="true" tabindex="-1"></a><span class="fu">### Predicted probabilities for new patients</span></span>
<span id="cb68-1246"><a href="#cb68-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1249"><a href="#cb68-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1250"><a href="#cb68-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: predicted-probabilities-new-patients</span></span>
<span id="cb68-1251"><a href="#cb68-1251" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1252"><a href="#cb68-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1253"><a href="#cb68-1253" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new data for prediction</span></span>
<span id="cb68-1254"><a href="#cb68-1254" aria-hidden="true" tabindex="-1"></a>new_depression <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb68-1255"><a href="#cb68-1255" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>),        <span class="co"># range of years working</span></span>
<span id="cb68-1256"><a href="#cb68-1256" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="fl">7.5</span>, <span class="dv">10</span>),       <span class="co"># range of physical activity</span></span>
<span id="cb68-1257"><a href="#cb68-1257" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>)            <span class="co"># obesity categories</span></span>
<span id="cb68-1258"><a href="#cb68-1258" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-1259"><a href="#cb68-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1260"><a href="#cb68-1260" aria-hidden="true" tabindex="-1"></a><span class="co"># Add log-odds and predicted probabilities</span></span>
<span id="cb68-1261"><a href="#cb68-1261" aria-hidden="true" tabindex="-1"></a>new_depression<span class="sc">$</span>predicted_odds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_clean,</span>
<span id="cb68-1262"><a href="#cb68-1262" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">newdata =</span> new_depression,</span>
<span id="cb68-1263"><a href="#cb68-1263" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb68-1264"><a href="#cb68-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1265"><a href="#cb68-1265" aria-hidden="true" tabindex="-1"></a>new_depression<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_clean,</span>
<span id="cb68-1266"><a href="#cb68-1266" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newdata =</span> new_depression,</span>
<span id="cb68-1267"><a href="#cb68-1267" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb68-1268"><a href="#cb68-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1269"><a href="#cb68-1269" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb68-1270"><a href="#cb68-1270" aria-hidden="true" tabindex="-1"></a>new_depression <span class="sc">%&gt;%</span></span>
<span id="cb68-1271"><a href="#cb68-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-1272"><a href="#cb68-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-1273"><a href="#cb68-1273" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 17: Predicted Odds and Probabilities for New Patients"</span>,</span>
<span id="cb68-1274"><a href="#cb68-1274" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1275"><a href="#cb68-1275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb68-1276"><a href="#cb68-1276" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">vars</span>(predicted_odds, predicted_prob),</span>
<span id="cb68-1277"><a href="#cb68-1277" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb68-1278"><a href="#cb68-1278" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1279"><a href="#cb68-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1280"><a href="#cb68-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prediction plot with confidence intervals (Interaction plot)</span></span>
<span id="cb68-1281"><a href="#cb68-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1284"><a href="#cb68-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1285"><a href="#cb68-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: prediction-plot-with-ci</span></span>
<span id="cb68-1286"><a href="#cb68-1286" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1287"><a href="#cb68-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Predicted Probability of Depression by Physical Activity and Obesity Status with 95% Confidence Intervals"</span></span>
<span id="cb68-1288"><a href="#cb68-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1289"><a href="#cb68-1289" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions with standard errors</span></span>
<span id="cb68-1290"><a href="#cb68-1290" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_clean, <span class="at">newdata =</span> new_depression, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-1291"><a href="#cb68-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1292"><a href="#cb68-1292" aria-hidden="true" tabindex="-1"></a><span class="co"># Build dataframe with CI on probability scale</span></span>
<span id="cb68-1293"><a href="#cb68-1293" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> new_depression <span class="sc">%&gt;%</span></span>
<span id="cb68-1294"><a href="#cb68-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1295"><a href="#cb68-1295" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_link =</span> pred<span class="sc">$</span>fit,</span>
<span id="cb68-1296"><a href="#cb68-1296" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_link  =</span> pred<span class="sc">$</span>se.fit,</span>
<span id="cb68-1297"><a href="#cb68-1297" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_link =</span> fit_link <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_link,</span>
<span id="cb68-1298"><a href="#cb68-1298" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_link =</span> fit_link <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se_link,</span>
<span id="cb68-1299"><a href="#cb68-1299" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fitted =</span> <span class="fu">plogis</span>(fit_link),</span>
<span id="cb68-1300"><a href="#cb68-1300" aria-hidden="true" tabindex="-1"></a>    <span class="at">.lower  =</span> <span class="fu">plogis</span>(lower_link),</span>
<span id="cb68-1301"><a href="#cb68-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">.upper  =</span> <span class="fu">plogis</span>(upper_link)</span>
<span id="cb68-1302"><a href="#cb68-1302" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1303"><a href="#cb68-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1304"><a href="#cb68-1304" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with ribbons</span></span>
<span id="cb68-1305"><a href="#cb68-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> .fitted, <span class="at">color =</span> obesity, <span class="at">fill =</span> obesity)) <span class="sc">+</span></span>
<span id="cb68-1306"><a href="#cb68-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb68-1307"><a href="#cb68-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-1308"><a href="#cb68-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb68-1309"><a href="#cb68-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb68-1310"><a href="#cb68-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb68-1311"><a href="#cb68-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb68-1312"><a href="#cb68-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Probability of Depression by Physical Activity and Obesity Status"</span>,</span>
<span id="cb68-1313"><a href="#cb68-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model Predictions with 95% Confidence Intervals"</span>,</span>
<span id="cb68-1314"><a href="#cb68-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Probability of Depression"</span>,</span>
<span id="cb68-1315"><a href="#cb68-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical Activity Score (0–10)"</span>,</span>
<span id="cb68-1316"><a href="#cb68-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb68-1317"><a href="#cb68-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Obesity Status"</span></span>
<span id="cb68-1318"><a href="#cb68-1318" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-1319"><a href="#cb68-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-1320"><a href="#cb68-1320" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb68-1321"><a href="#cb68-1321" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-1322"><a href="#cb68-1322" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb68-1323"><a href="#cb68-1323" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1324"><a href="#cb68-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1325"><a href="#cb68-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1326"><a href="#cb68-1326" aria-hidden="true" tabindex="-1"></a>*Interpretation* :</span>
<span id="cb68-1327"><a href="#cb68-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1328"><a href="#cb68-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As physical activity increases, the chance of being depressed goes down for both obese and non-obese individuals. The drop is steeper for obese people, meaning physical activity helps them even more. At high activity levels, both groups have similarly low depression risk.</span>
<span id="cb68-1329"><a href="#cb68-1329" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This suggests that encouraging physical activity is especially important for obese individuals to reduce depression risk.</span>
<span id="cb68-1330"><a href="#cb68-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1331"><a href="#cb68-1331" aria-hidden="true" tabindex="-1"></a><span class="fu">### Heatmap of predicted probabilities</span></span>
<span id="cb68-1332"><a href="#cb68-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1335"><a href="#cb68-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1336"><a href="#cb68-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: heatmap-predicted-probabilities</span></span>
<span id="cb68-1337"><a href="#cb68-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb68-1338"><a href="#cb68-1338" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Heatmap of Predicted Probability of Depression by Physical Activity and Years Working"</span></span>
<span id="cb68-1339"><a href="#cb68-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1340"><a href="#cb68-1340" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a discrete prediction grid for representative values</span></span>
<span id="cb68-1341"><a href="#cb68-1341" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb68-1342"><a href="#cb68-1342" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>),</span>
<span id="cb68-1343"><a href="#cb68-1343" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="fl">7.5</span>, <span class="dv">10</span>),</span>
<span id="cb68-1344"><a href="#cb68-1344" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>) </span>
<span id="cb68-1345"><a href="#cb68-1345" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-1346"><a href="#cb68-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1347"><a href="#cb68-1347" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Generate predictions from your fitted model</span></span>
<span id="cb68-1348"><a href="#cb68-1348" aria-hidden="true" tabindex="-1"></a>predicted_heatmap <span class="ot">&lt;-</span> <span class="fu">augment</span>(</span>
<span id="cb68-1349"><a href="#cb68-1349" aria-hidden="true" tabindex="-1"></a>  final_model_clean,</span>
<span id="cb68-1350"><a href="#cb68-1350" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> heatmap_data,</span>
<span id="cb68-1351"><a href="#cb68-1351" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.predict =</span> <span class="st">"response"</span>,   <span class="co"># predicted probabilities</span></span>
<span id="cb68-1352"><a href="#cb68-1352" aria-hidden="true" tabindex="-1"></a>  <span class="at">se_fit =</span> <span class="cn">TRUE</span></span>
<span id="cb68-1353"><a href="#cb68-1353" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-1354"><a href="#cb68-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1355"><a href="#cb68-1355" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot as a heatmap (probability blocks)</span></span>
<span id="cb68-1356"><a href="#cb68-1356" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_heatmap, <span class="fu">aes</span>(<span class="at">x =</span> phys_activity, <span class="at">y =</span> years_working, <span class="at">fill =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb68-1357"><a href="#cb68-1357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb68-1358"><a href="#cb68-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(.fitted, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb68-1359"><a href="#cb68-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> obesity) <span class="sc">+</span></span>
<span id="cb68-1360"><a href="#cb68-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"skyblue"</span>, <span class="at">high =</span> <span class="st">"firebrick"</span>, <span class="at">name =</span> <span class="st">"Predicted Probability"</span>) <span class="sc">+</span></span>
<span id="cb68-1361"><a href="#cb68-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb68-1362"><a href="#cb68-1362" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Probability of Depression"</span>,</span>
<span id="cb68-1363"><a href="#cb68-1363" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Across Physical Activity, Years Working, and Obesity Status"</span>,</span>
<span id="cb68-1364"><a href="#cb68-1364" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical Activity Score (0–10)"</span>,</span>
<span id="cb68-1365"><a href="#cb68-1365" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Years Working"</span></span>
<span id="cb68-1366"><a href="#cb68-1366" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-1367"><a href="#cb68-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb68-1368"><a href="#cb68-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-1369"><a href="#cb68-1369" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-1370"><a href="#cb68-1370" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb68-1371"><a href="#cb68-1371" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb68-1372"><a href="#cb68-1372" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1373"><a href="#cb68-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1374"><a href="#cb68-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1375"><a href="#cb68-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1376"><a href="#cb68-1376" aria-hidden="true" tabindex="-1"></a>*Interpretation* : People who are obese and have worked longer tend to have a higher chance of depression, especially if they are not physically active. More physical activity lowers the risk of depression for everyone, but the benefit is even greater for obese individuals.</span>
<span id="cb68-1377"><a href="#cb68-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1378"><a href="#cb68-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1379"><a href="#cb68-1379" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb68-1380"><a href="#cb68-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1381"><a href="#cb68-1381" aria-hidden="true" tabindex="-1"></a>The final model offers a statistically sound and practically meaningful framework for understanding depression risk. By addressing influential observations and incorporating interaction effects, it achieves better fit, clearer interpretation, and stronger predictive performance. These results support targeted mental health strategies that consider both behavioral and physiological risk factors.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>